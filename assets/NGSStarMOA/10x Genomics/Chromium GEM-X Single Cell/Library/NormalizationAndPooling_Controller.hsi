// {{{ 2 "IncludeGuard" "PragmaOnce"
#pragma once
// }} ""
#include "ASWStandard\\TraceLevel\\TraceLevel.hsl"
#include "HSLSeqLib.hsl"
#include "HSLTimLib.hsl"
#include "HSLStrLib.hsl"
#include "HSLExtensions\\File.hsl"
#include "HSLMthLib.hsl"
#include "VectorCustomDialogs\\VectorCustomDialogs.hsl"
#include "ArrayTools\\ArrayTools.hs_"
#include "StringTokenizer\\StrTokenize.hs_"
#include "HSLUtilLib2.hsl"
#include "HSLTrcLib.hsl"
#include "HSLLabwrAccess\\HSLLabwrAccess.hsl"
#include "ASWStandard\\ASWGlobal\\ASWGlobal.hsl"
/* {{ 2 "LibraryInsertLine" "" */ // }} ""
// {{ 2 "TemplateIncludeBlock" ""
#include "HSLMETEDLib.hs_"
#include "HSLMECCLib.hs_"
#include "HSLPTLLib.hsl"
// }} ""
// {{{ 2 "LibraryNamespace" "Begin"
namespace NORMALIZATIONANDPOOLING_CONTROLLER {
// }} ""
variable t_hdlFile_Worklist_OriginalSampleVolume;
variable t_hdlFile_Worklist_SampleStatus;
variable t_hdlFile_Worklist_VolumeToAspirate;
variable t_hdlFile_Worklist_Mass_per_sample;
variable t_hdlFile_Worklist_Sample_Concentration;
variable t_hdlFile_Worklist_Sample_Position;
variable t_hdlFile_Worklist_Target_Well;
variable t_hdlFile_Worklist_Sample_ID;
variable t_str_Time;
variable t_str_Date;
file t_hdlFile_Worklist;
variable t_hdlFile_Worklist_VolumePerPool;
variable t_hdlFile_Worklist_MassPerPool;
variable t_str_OutputFilePath;
variable t_str_TemplateFilePath;
variable t_str_ExcludedSamplesFilePath;
file t_hdlFile_Template;
file t_hdlFile_Output;
file t_hdlFile_Excluded;
variable t_intTraceLevel;
variable t_strControllerVersion;
variable t_strLibraryNameWithoutExtension;
variable t_strLibraryName;
variable t_strKitTitle;
variable t_strLogFilesDirectory;
variable t_blnActivateIntegratedAbortHandler;
/* {{ 2 "VariableInsertLine" "" */ // }} ""
// {{{ 2 "SubmethodForwardDeclaration" ""
function FilterSequenceAndArrayForTipType( sequence i_seq_Tips, sequence i_seq_Source, sequence i_seq_Target, variable & i_arr_flt_Volumes[], sequence & o_seq_Aspirate, sequence & o_seq_Dispense, variable & o_arr_flt_Volumes[], device & ML_STAR ) void ;
function Init( device & ML_STAR, variable i_strKitTitle, variable i_blnActivateIntegratedAbortHandler, variable & o_strControllerNameAndVersion ) variable ;
function Normalization_ByConcentration( variable i_str_WorklistFilePath, sequence i_seq_SourceSamplePlate, sequence i_seq_NormalizationPlate, variable i_flt_MaximumVolumePerContainer, variable i_bln_AllowCostumerIntervention, variable & o_int_NumberOfSamples, sequence & o_seq_Asp_Samples, sequence & o_seq_Disp_Samples, variable & o_arr_flt_Volumes_Sample[], sequence & o_seq_Disp_Diluent, variable & o_arr_flt_Volumes_Diluent[], variable & o_str_FilePath_OutputFile, variable & o_flt_Diluent_TotalVolume, device & ML_STAR ) variable ;
function Pooling_ByMass( variable i_str_WorklistFilePath, sequence i_seq_SourceSamplePlate, sequence i_seq_Pooling, variable i_flt_MaximumVolumePerContainer, variable i_bln_AllowCostumerIntervention, sequence & o_seq_Asp_Samples, sequence & o_seq_Disp_Samples, variable & o_arr_flt_Volumes_Sample[], sequence & o_seq_Disp_Diluent, variable & o_arr_flt_Volumes_Diluent[], variable & o_flt_Diluent_TotalVolume, variable & o_str_FilePath_OutputFile, variable & o_int_NumberOfPools, variable & o_arr_flt_Volumes_Pools[], variable & o_arr_str_PostionIDsPools[], device & ML_STAR ) variable ;
function Pooling_ByVolume( variable i_str_WorklistFilePath, sequence i_seq_SourceSamplePlate, sequence i_seq_Pooling, variable i_flt_MaximumVolumePerContainer, variable i_bln_AllowCostumerIntervention, sequence & o_seq_Asp_Samples, sequence & o_seq_Disp_Samples, variable & o_arr_flt_Volumes_Sample[], variable & o_int_NumberOfPools, variable & o_arr_str_PostionIDsPools[], variable & o_arr_flt_Volumes_Pools[], variable & o_str_FilePath_OutputFile, device & ML_STAR ) variable ;
private function _CheckBindReturnValueVectorCustomDialogs( variable i_intBindReturnValue ) void ;
private function _DATA_IntegratedAbortHandler( variable i_strFunctionName, variable i_strAbortMessage ) void ;
private function _Display_InputWorklist_Dialog( variable & o_str_FileWorklistFullPath ) void ;
private function _GetPoolInfo( variable i_str_FilePath, variable i_str_SQL, variable i_bln_TraceArrayInfo, file & i_hdlFile, variable i_int_PoolingMode, variable & o_arr_str_Pools[], variable & o_arr_int_NumberOfSamplesPerPool[], variable & o_arr_flt_MassPerSampleInPool[], variable & o_arr_flt_MassPerPool[], variable & o_arr_flt_VolumePerPool[] ) variable ;
private function _PoolingFileOpen( variable i_str_FilePath, variable i_str_SQLSentence, variable i_int_Mode, variable i_int_PoolingMode, file & io_hdlFile ) void ;
private function _UpdateRecord( variable i_str_FilePath, variable i_str_SheetName, variable i_str_ColumnName, variable i_keyNewValue, variable i_str_ColumnReference, variable i_keyValueReference ) void ;
private function _Version_history(  ) void ;
// }} ""
function _InitLibrary() {
// {{ 2 "AutoInitBlock" ""
PTL::SetWashingStateDefault("RinseTime1", 5);
PTL::SetWashingStateDefault("SoakTime1", 5);
PTL::SetWashingStateDefault("FlowRate1", 11);
PTL::SetWashingStateDefault("RinseTime2", 0);
PTL::SetWashingStateDefault("SoakTime2", 0);
PTL::SetWashingStateDefault("FlowRate2", 11);
PTL::SetWashingStateDefault("DrainingTime", 10);
PTL::SetWashingStateDefault("StartWashLiquid", 0);
PTL::SetLoadingStateDefault("RecoveryOptionContinue", hslTrue);
PTL::SetLoadingStateDefault("RecoveryOptionExclude", hslTrue);
PTL::SetLoadingStateDefault("RecoveryOptionDefault", 0);
PTL::SetLoadingStateDefault("KitLotCheckEnabled", hslFalse);
ARRAYTOOLS::_InitLibrary();
STRTOKENIZE::_InitLibrary();
// }} ""
}
function _ExitLibrary() {
// {{ 2 "AutoExitBlock" ""
ARRAYTOOLS::_ExitLibrary();
STRTOKENIZE::_ExitLibrary();
// }} ""
}
// {{{ 5 "Normalization_ByConcentration" "Begin"
function Normalization_ByConcentration( variable i_str_WorklistFilePath, sequence i_seq_SourceSamplePlate, sequence i_seq_NormalizationPlate, variable i_flt_MaximumVolumePerContainer, variable i_bln_AllowCostumerIntervention, variable & o_int_NumberOfSamples, sequence & o_seq_Asp_Samples, sequence & o_seq_Disp_Samples, variable & o_arr_flt_Volumes_Sample[], sequence & o_seq_Disp_Diluent, variable & o_arr_flt_Volumes_Diluent[], variable & o_str_FilePath_OutputFile, variable & o_flt_Diluent_TotalVolume, device & ML_STAR ) variable {
// }} ""
private variable loopCounter1;
private variable l_flt_Volume_MinimumToPipette;
private variable l_flt_Volume_SampleAspirate;
private variable l_flt_Volume_DiluentAspirate;
private variable l_str_LabwareID_NormalizationPlate;
private variable l_str_LabwareID_SamplePlate;
private variable l_str_Worklist_Extension;
private variable l_str_Worklist_FileName;
private variable l_bln_SampleExcluded;
private variable l_flt_Volume_Total;
private variable l_int_NumberOfSamples_Source;
private variable loopCounter2;
private variable l_int_NumberOfSamples_Excluded;
private variable l_str_Message;
private variable CounterWorklistReloading;
private variable l_flt_Volume_MinimumToPipetteDiluent;
private variable l_int_ReturnValue;
private variable l_arr_strTokens[];
private variable t_hdlFile_Worklist_FinalSampleConcentration;
private variable l_bln_NormalizeInOriginalSamplePlate;
private variable t_hdlFile_Worklist_FinalSampleVolume;
private variable l_str_MultipleUsedSampleTargetPositions;
private variable l_int_NumberOfSamplesUsedMultipleTimes;
private variable l_int_NumberOfUseThisSample;
private variable l_str_MultipleUsedSampleSourcePositions;
private variable l_int_NumberOfSampleSourceWells_distinct;
private variable loopCounter4;
private variable loopCounter5;
private variable l_int_NumberOfSampleTargetWells_distinct;
private variable l_arr_str_SampleTargetPosition_distinct[];
private variable l_arr_str_Temp[];
private variable l_arr_str_SampleSourcePosition_distinct[];
private variable l_arr_str_SampleSourcePosition[];
private variable l_arr_str_MultipleUsedSampleTargetPositions[];
private variable l_arr_str_SampleTargetPosition_copy[];
private variable l_arr_int_NumberOfUseSample[];
private variable l_arr_str_SampleTargetPosition[];
private variable l_arr_str_MultipleUsedSampleSourcePositions[];
private variable l_arr_str_SampleSourcePosition_copy[];
private variable l_strFunctionName;
// {{ 5 "Normalization_ByConcentration" "InitLocals"
o_int_NumberOfSamples = 0;
{ sequence __temp; o_seq_Asp_Samples = __temp; }
{ sequence __temp; o_seq_Disp_Samples = __temp; }
o_arr_flt_Volumes_Sample.SetSize( 0);
{ sequence __temp; o_seq_Disp_Diluent = __temp; }
o_arr_flt_Volumes_Diluent.SetSize( 0);
o_str_FilePath_OutputFile = 0;
o_flt_Diluent_TotalVolume = 0;
// }} ""
// {{ 111 1 0 "7a90b3b6_eb80_427f_b8191c794ff66d1d" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 112 1 0 "65e92841_659f_4222_88efb5b67e2ae2e1" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_strFunctionName = Translate("");
// }} ""
l_strFunctionName = GetFunctionName();
// {{{ 114 1 0 "ff793ddf_4850_458c_a04fdbbf798378d8" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::START, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{ 115 1 0 "7a90b3b6_eb80_427f_b8191c794ff66d1d" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 116 1 0 "033256b5_4fdf_426e_9fef88e9c2e78856" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
CounterWorklistReloading = 0;
while (1 == 1)
{
CounterWorklistReloading = CounterWorklistReloading + 1;
// }} ""
// {{ 117 1 0 "84a9ebf3_82f8_4b4b_9ce36af5a2c0c648" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 118 1 0 "33c6b943_6cff_4fb3_8392dcad57e1a3b6" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_RELEASE, Translate("i_str_WorklistFilePath: "), i_str_WorklistFilePath);
// }} ""
// {{ 119 1 0 "84a9ebf3_82f8_4b4b_9ce36af5a2c0c648" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 120 1 0 "9533fa0c_9366_4f2f_a97694a61713709f" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 121 1 0 "9682a11c_6d92_49c7_8ec6d65f7fbc631c" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_Volume_MinimumToPipette = 2;
// }} ""
// {{ 122 1 0 "de701e46_48f0_4200_9abf3dde673f67f8" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_Volume_MinimumToPipetteDiluent = 0.5;
// }} ""
// {{ 123 1 0 "b2bd4f10_3dab_43d5_9e1ace18a99b3d11" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
o_int_NumberOfSamples = 0;
// }} ""
// {{ 124 1 0 "00708986_59ea_448a_91023a259bc7a1d4" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
o_arr_flt_Volumes_Sample.SetSize(0);
// }} ""
// {{ 125 1 0 "bd631976_9007_4d7e_ad5f5525f0fc3d5a" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
o_arr_flt_Volumes_Diluent.SetSize(0);
// }} ""
// {{ 126 1 0 "8bdf3cb6_b964_47ed_a185da6e80575777" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_int_NumberOfUseSample.SetSize(0);
// }} ""
// {{{ 127 1 0 "6c46d16b_c8a6_40e6_8a11857deb4d928e" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Worklist_FileName = HSLExtensions::File::GetFileNameWithoutExtension(i_str_WorklistFilePath);
// }} ""
// {{{ 128 1 0 "bcf67495_1c1e_4dce_9b9c4794b599220d" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Worklist_Extension = HSLExtensions::File::GetFileExtension(i_str_WorklistFilePath);
// }} ""
// {{{ 129 1 0 "b8194be9_3436_474c_a116891222800916" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
t_str_OutputFilePath = StrConcat12(t_strLogFilesDirectory, Translate("\\"), t_strKitTitle, Translate("_"), Translate("NormalizationOutput"), Translate("_"), t_str_Date, Translate("_"), t_str_Time, Translate("."), Translate("xls"), Translate(""));
// }} ""
// {{{ 130 1 0 "78a04bae_3a8b_4e51_a861cc0cf3234954" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_LabwareID_NormalizationPlate = SeqGetLabwareId(i_seq_NormalizationPlate);
// }} ""
// {{{ 131 1 0 "4d446ac5_38ee_4418_ae90479625740ba7" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_LabwareID_SamplePlate = SeqGetLabwareId(i_seq_SourceSamplePlate);
// }} ""
// {{ 132 1 0 "d3a27ecd_3746_4c8b_9778b48129ec66ac" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
o_flt_Diluent_TotalVolume = 0.0;
// }} ""
// {{ 133 1 0 "4a8a29ce_5cfd_401a_b620f4ff0c8b45fb" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_int_NumberOfSamples_Excluded = 0;
// }} ""
// {{{ 134 1 0 "6aa625af_1759_4ca1_988317a94f61263c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqRemoveAll(o_seq_Disp_Diluent);
// }} ""
// {{{ 135 1 0 "1439c9ba_8609_422b_a62b97c3595dd178" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqRemoveAll(o_seq_Disp_Samples);
// }} ""
// {{{ 136 1 0 "8c3705d1_1934_4e43_a7012a6289e8d551" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqRemoveAll(o_seq_Asp_Samples);
// }} ""
// {{ 137 1 0 "9533fa0c_9366_4f2f_a97694a61713709f" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 138 1 0 "caf1c0e1_c861_463c_b34671813b0dbc05" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 139 1 0 "f76be0a2_b53e_48ca_bd0ed3055f015bb3" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_LabwareID_NormalizationPlate == l_str_LabwareID_SamplePlate)
{
// }} ""
// {{ 140 1 0 "6d575136_6727_46a2_94c202d766cafabd" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_NormalizeInOriginalSamplePlate = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 141 1 0 "f76be0a2_b53e_48ca_bd0ed3055f015bb3" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 142 1 0 "55d2164e_abdc_4b72_85816fe282d61e9c" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_NormalizeInOriginalSamplePlate = ASWGLOBAL::BOOL::FALSE;
// }} ""
// {{ 143 1 0 "f76be0a2_b53e_48ca_bd0ed3055f015bb3" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 144 1 0 "caf1c0e1_c861_463c_b34671813b0dbc05" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 145 1 0 "ee0d8ce8_c3c1_4d26_855afce5e76b9a68" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 146 1 0 "92f288b5_4665_4a83_ba1d25bc8e048413" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_int_NumberOfSamples_Source = 0;
// }} ""
// {{ 147 1 0 "64ae3a3c_bf30_45d4_b1fbcea6c94a3ded" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_str_SampleSourcePosition.SetSize(0);
// }} ""
// {{ 148 1 0 "149b40f9_08a2_4c84_96eb93063697239c" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_str_SampleTargetPosition.SetSize(0);
// }} ""
// {{ 149 1 0 "a71387cb_b426_4934_a96b79afa33958da" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_NormalizeInOriginalSamplePlate == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{ 150 1 0 "eeea7b50_c878_4abb_9d6be13c723ef303" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension == "csv")
{
// }} ""
// {{ 151 1 0 "8b432d1a_ca09_4457_bd348689e5ed5384" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_AE467D1A1DE145159018C06582D42399 ;
err.Clear();
// }} ""
// {{ 152 1 0 "fad6fff7_b082_4199_99f7f40f1eede734" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Concentration", t_hdlFile_Worklist_Sample_Concentration, hslFloat);
t_hdlFile_Worklist.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
t_hdlFile_Worklist.AddField("Final_SampleConcentration", t_hdlFile_Worklist_FinalSampleConcentration, hslFloat);
t_hdlFile_Worklist.SetDelimiter(";");
if( 0 == t_hdlFile_Worklist.Open(i_str_WorklistFilePath, hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_WorklistFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 153 1 0 "8b432d1a_ca09_4457_bd348689e5ed5384" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_AE467D1A1DE145159018C06582D42399 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{{ 154 1 0 "7471cf0a_198e_4798_8afa5ca0b25f7409" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_DATA_IntegratedAbortHandler(l_strFunctionName, Translate("Normalization and Pooling Controller cannot open input worklist. Please review file structure and content, possibly required columns or entries are missing. System will abort"));
// }} ""
// {{{ 155 1 0 "0188207d_09e8_45d0_81061c3065b28f05" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::FALSE);
// }} ""
// {{ 156 1 0 "8b432d1a_ca09_4457_bd348689e5ed5384" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 157 1 0 "eeea7b50_c878_4abb_9d6be13c723ef303" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 158 1 0 "554f2695_ff87_4487_9a5f9371fda4ce5d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension == "xls")
{
// }} ""
// {{ 159 1 0 "6c244084_d432_4012_b3b2b7aa880b8b07" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_0C49F25111334c56B4FB5C6E37BBC2EA ;
err.Clear();
// }} ""
// {{ 160 1 0 "b298801d_cb1e_449a_bbb596f40574b096" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Concentration", t_hdlFile_Worklist_Sample_Concentration, hslFloat);
t_hdlFile_Worklist.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
t_hdlFile_Worklist.AddField("Final_SampleConcentration", t_hdlFile_Worklist_FinalSampleConcentration, hslFloat);
if( 0 == t_hdlFile_Worklist.Open(i_str_WorklistFilePath + " " + "Sheet1$", hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_WorklistFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 161 1 0 "6c244084_d432_4012_b3b2b7aa880b8b07" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_0C49F25111334c56B4FB5C6E37BBC2EA : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{{ 162 1 0 "f51b1549_1215_4f36_83c2d14fc265ddc0" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_DATA_IntegratedAbortHandler(l_strFunctionName, Translate("Normalization and Pooling Controller cannot open input worklist. Please review file structure and content, possibly required columns or entries are missing. System will abort"));
// }} ""
// {{{ 163 1 0 "88a46a04_a4a2_4ebd_86fe766e6f343cbd" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::FALSE);
// }} ""
// {{ 164 1 0 "6c244084_d432_4012_b3b2b7aa880b8b07" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 165 1 0 "554f2695_ff87_4487_9a5f9371fda4ce5d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 166 1 0 "80cc1cd7_2583_40a4_bb43d856546adb35" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension != "csv")
{
// }} ""
// {{ 167 1 0 "3a7d479b_230a_419d_963dcbece53c6765" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension != "xls")
{
// }} ""
// {{{ 168 1 0 "fac846f9_eb85_4282_92decdb1eb853d9c" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_DATA_IntegratedAbortHandler(l_strFunctionName, Translate("Normalization and Pooling Controller cannot open input worklist (only .xls and .csv file formats are accepted). System will abort"));
// }} ""
// {{{ 169 1 0 "464a515b_5f22_4b47_bd918c69904b6911" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::FALSE);
// }} ""
// {{ 170 1 0 "3a7d479b_230a_419d_963dcbece53c6765" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 171 1 0 "80cc1cd7_2583_40a4_bb43d856546adb35" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 172 1 0 "a71387cb_b426_4934_a96b79afa33958da" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 173 1 0 "fd09fa23_abd5_4792_a76b90217f03f446" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension == "csv")
{
// }} ""
// {{ 174 1 0 "b4a5f737_a86e_461e_a417f7ad153b8705" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_CAFA4651238146e6A00F87D4F038C368 ;
err.Clear();
// }} ""
// {{ 175 1 0 "154bc170_2300_48d8_9e7feff68b9aff34" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Worklist.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Concentration", t_hdlFile_Worklist_Sample_Concentration, hslFloat);
t_hdlFile_Worklist.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
t_hdlFile_Worklist.AddField("Final_SampleConcentration", t_hdlFile_Worklist_FinalSampleConcentration, hslFloat);
t_hdlFile_Worklist.AddField("Final_SampleVolume", t_hdlFile_Worklist_FinalSampleVolume, hslFloat);
t_hdlFile_Worklist.SetDelimiter(";");
if( 0 == t_hdlFile_Worklist.Open(i_str_WorklistFilePath, hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_WorklistFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 176 1 0 "b4a5f737_a86e_461e_a417f7ad153b8705" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_CAFA4651238146e6A00F87D4F038C368 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{{ 177 1 0 "78331c7e_b3f9_48a5_9a4c982bed917010" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_DATA_IntegratedAbortHandler(l_strFunctionName, Translate("Normalization and Pooling Controller cannot open input worklist. Please review file structure and content, possibly required columns or entries are missing. System will abort"));
// }} ""
// {{{ 178 1 0 "764ba764_0e55_4bf1_846c1622ff07b7c6" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::FALSE);
// }} ""
// {{ 179 1 0 "b4a5f737_a86e_461e_a417f7ad153b8705" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 180 1 0 "fd09fa23_abd5_4792_a76b90217f03f446" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 181 1 0 "f0bf407f_5ed7_4e22_bcc998c9c22ad7bb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension == "xls")
{
// }} ""
// {{ 182 1 0 "272a9d20_ae3d_4f21_b9780a8fb6d8a2f1" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_A44A913D76EA4de0ADF1478519C50052 ;
err.Clear();
// }} ""
// {{ 183 1 0 "4fad58c6_b599_4389_9a77998ba944eb89" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Worklist.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Concentration", t_hdlFile_Worklist_Sample_Concentration, hslFloat);
t_hdlFile_Worklist.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
t_hdlFile_Worklist.AddField("Final_SampleConcentration", t_hdlFile_Worklist_FinalSampleConcentration, hslFloat);
t_hdlFile_Worklist.AddField("Final_SampleVolume", t_hdlFile_Worklist_FinalSampleVolume, hslFloat);
if( 0 == t_hdlFile_Worklist.Open(i_str_WorklistFilePath + " " + "Sheet1$", hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_WorklistFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 184 1 0 "272a9d20_ae3d_4f21_b9780a8fb6d8a2f1" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_A44A913D76EA4de0ADF1478519C50052 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{{ 185 1 0 "b7fc0e57_0c89_4ed7_a7971899f9e56100" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_DATA_IntegratedAbortHandler(l_strFunctionName, Translate("Normalization and Pooling Controller cannot open input worklist. Please review file structure and content, possibly required columns or entries are missing. System will abort"));
// }} ""
// {{{ 186 1 0 "7883c874_e2fa_4367_98f9fa202a781cad" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::FALSE);
// }} ""
// {{ 187 1 0 "272a9d20_ae3d_4f21_b9780a8fb6d8a2f1" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 188 1 0 "f0bf407f_5ed7_4e22_bcc998c9c22ad7bb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 189 1 0 "cd7dc8c5_2b4c_4cf6_9dd9dcfdbacafd24" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension != "csv")
{
// }} ""
// {{ 190 1 0 "19f18b7e_6fb9_4c5f_9f56204e548c036a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension != "xls")
{
// }} ""
// {{{ 191 1 0 "184ec56b_e3ef_47dc_8a9cf638a40dc216" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_DATA_IntegratedAbortHandler(l_strFunctionName, Translate("Normalization and Pooling Controller cannot open input worklist (only .xls and .csv file formats are accepted). System will abort"));
// }} ""
// {{{ 192 1 0 "4483f834_b4d7_4f8b_a866cc7faabd6ca9" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::FALSE);
// }} ""
// {{ 193 1 0 "19f18b7e_6fb9_4c5f_9f56204e548c036a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 194 1 0 "cd7dc8c5_2b4c_4cf6_9dd9dcfdbacafd24" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 195 1 0 "a71387cb_b426_4934_a96b79afa33958da" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 196 1 0 "01244164_a614_4561_833b1abd58cbd0b1" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter2 = 0;
while (
   (t_hdlFile_Worklist.Eof() == 0)
)
{
loopCounter2 = loopCounter2 + 1;
// }} ""
// {{ 197 1 0 "bf8f2b1e_eaaf_48a0_931557077bf57ef5" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Worklist.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 198 1 0 "0fc77137_39ce_4a54_b92594c153731c1c" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
l_int_NumberOfSamples_Source = l_int_NumberOfSamples_Source + 1;
// }} ""
// {{ 199 1 0 "aac44d77_753a_488c_a714ca593ee7687f" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_str_SampleSourcePosition.AddAsLast(t_hdlFile_Worklist_Sample_Position);
// }} ""
// {{ 200 1 0 "8849daf2_3ecf_4bdf_89e9d4d0b1fde7d0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_NormalizeInOriginalSamplePlate == ASWGLOBAL::BOOL::FALSE)
{
// }} ""
// {{ 201 1 0 "63ddd7bd_eb9f_45a4_883b27d68da6966e" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_str_SampleTargetPosition.AddAsLast(t_hdlFile_Worklist_Target_Well);
// }} ""
// {{ 202 1 0 "8849daf2_3ecf_4bdf_89e9d4d0b1fde7d0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 203 1 0 "01244164_a614_4561_833b1abd58cbd0b1" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 204 1 0 "a5b36a3b_0a63_4ca8_b79b589c92a4f18c" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Worklist.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Worklist.RemoveFields();
// }} ""
// {{{ 205 1 0 "a098a8bb_6237_43b1_aa2d4d792c00fbaf" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_DEBUG, Translate("l_int_NumberOfSamples_Source: "), l_int_NumberOfSamples_Source);
// }} ""
// {{ 206 1 0 "ee0d8ce8_c3c1_4d26_855afce5e76b9a68" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 207 1 0 "fd53dc1b_477d_492f_b622d24e8dbdccd0" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 208 1 0 "474733db_d62e_46eb_89cac17a6765b068" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_NormalizeInOriginalSamplePlate == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{ 209 1 0 "1d6b1f99_bc02_4790_8ece5da54f3620c7" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 210 1 0 "8a0515ce_97a7_4b26_861b4590f2face0f" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_str_MultipleUsedSampleSourcePositions = Translate("");
// }} ""
// {{ 211 1 0 "b31b58f4_79dc_4e0b_a89ad9521ad65e53" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_str_MultipleUsedSampleSourcePositions.SetSize(0);
// }} ""
// {{{ 212 1 0 "9fb14853_e9b4_42d6_acdab78a94736a72" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ARRAYTOOLS::get_distinct_from_array(l_arr_str_SampleSourcePosition, l_arr_str_SampleSourcePosition_distinct);
// }} ""
// {{ 213 1 0 "8e9e5e7d_1220_4747_99d2a9c55be40923" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
l_int_NumberOfSampleSourceWells_distinct=l_arr_str_SampleSourcePosition_distinct.GetSize();
// }} ""
// {{{ 214 1 0 "a43f26e1_c455_40d4_b1febdc87aed1334" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_DEBUG, Translate("l_int_NumberOfSampleSourceWells_distinct: "), l_int_NumberOfSampleSourceWells_distinct);
// }} ""
// {{ 215 1 0 "47e0e0c1_5888_44c0_a1bb1854754f5852" "{DB5A2B39-67F2-4a78-A78F-DAF3FB056366}"
l_arr_str_SampleSourcePosition_copy=l_arr_str_SampleSourcePosition;
// }} ""
// {{ 216 1 0 "b556cf8a_699c_49ce_b06960c6222e2171" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(loopCounter4 = 0; loopCounter4 < l_int_NumberOfSampleSourceWells_distinct;)
{
loopCounter4 = loopCounter4 + 1;
// }} ""
// {{{ 217 1 0 "78ec9efd_b386_4cfb_bd8f883df0ecac91" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ARRAYTOOLS::ArrayVLookUp(l_arr_str_SampleSourcePosition, l_arr_str_SampleSourcePosition_copy, l_arr_str_SampleSourcePosition_distinct.ElementAt( loopCounter4 -1), l_arr_str_Temp);
// }} ""
// {{ 218 1 0 "a943a39c_7b10_493c_8c599627dc61a554" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
l_int_NumberOfUseThisSample=l_arr_str_Temp.GetSize();
// }} ""
// {{ 219 1 0 "5f9eb929_3beb_463f_a82cb47ab550d942" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfUseThisSample > 1)
{
// }} ""
// {{ 220 1 0 "d0547ae3_8adf_4f4d_b5633b45f3fe1525" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_str_MultipleUsedSampleSourcePositions.AddAsLast(l_arr_str_SampleSourcePosition_distinct.ElementAt( loopCounter4 -1));
// }} ""
// {{ 221 1 0 "9f4ffd05_9227_4241_8716318609d37674" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_MultipleUsedSampleSourcePositions == "")
{
// }} ""
// {{ 222 1 0 "dd42470b_a2c8_443a_909d10f834664df8" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_str_MultipleUsedSampleSourcePositions = l_arr_str_SampleSourcePosition_distinct.ElementAt( loopCounter4 -1);
// }} ""
// {{ 223 1 0 "9f4ffd05_9227_4241_8716318609d37674" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 224 1 0 "dc426f24_cd29_4add_97af786700657954" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_MultipleUsedSampleSourcePositions = StrConcat4(l_str_MultipleUsedSampleSourcePositions, Translate(", "), l_arr_str_SampleSourcePosition_distinct.ElementAt( loopCounter4 -1), Translate(""));
// }} ""
// {{ 225 1 0 "9f4ffd05_9227_4241_8716318609d37674" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 226 1 0 "5f9eb929_3beb_463f_a82cb47ab550d942" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 227 1 0 "b556cf8a_699c_49ce_b06960c6222e2171" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 228 1 0 "31e5f41f_d90e_40f7_ac2390270c7ac7b7" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
l_int_NumberOfSamplesUsedMultipleTimes=l_arr_str_MultipleUsedSampleSourcePositions.GetSize();
// }} ""
// {{ 229 1 0 "8f3531bd_5f76_41aa_a71700945b8da894" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfSamplesUsedMultipleTimes > 0)
{
// }} ""
// {{{ 230 1 0 "7fa3c1ed_b9f8_4c06_84cab0dc99ee4abf" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceArray(TRACE_LEVEL_RELEASE, Translate("l_arr_str_MultipleUsedSampleSourcePositions: "), l_arr_str_MultipleUsedSampleSourcePositions);
// }} ""
// {{ 231 1 0 "8f3531bd_5f76_41aa_a71700945b8da894" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 232 1 0 "474733db_d62e_46eb_89cac17a6765b068" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 233 1 0 "fe4642b6_3e1c_432d_81592ec394d6b1c5" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 234 1 0 "52950a26_49f7_43e2_a705f0d62c2ce493" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_str_MultipleUsedSampleTargetPositions = Translate("");
// }} ""
// {{ 235 1 0 "6ab8f88a_410b_467d_85795892f74c0b94" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_str_MultipleUsedSampleTargetPositions.SetSize(0);
// }} ""
// {{{ 236 1 0 "f16ad734_db26_47ff_82ae5096a52f0776" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ARRAYTOOLS::get_distinct_from_array(l_arr_str_SampleTargetPosition, l_arr_str_SampleTargetPosition_distinct);
// }} ""
// {{ 237 1 0 "aa256689_7bf7_40c1_b62caed7c9c57b89" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
l_int_NumberOfSampleTargetWells_distinct=l_arr_str_SampleTargetPosition_distinct.GetSize();
// }} ""
// {{{ 238 1 0 "93437f3e_79da_4182_93faaebfe26f68d5" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_DEBUG, Translate("l_int_NumberOfSampleTargetWells_distinct: "), l_int_NumberOfSampleTargetWells_distinct);
// }} ""
// {{ 239 1 0 "631621e7_c48b_4754_9cc46fc001630b88" "{DB5A2B39-67F2-4a78-A78F-DAF3FB056366}"
l_arr_str_SampleTargetPosition_copy=l_arr_str_SampleTargetPosition;
// }} ""
// {{ 240 1 0 "839c4177_cf1f_46d1_928d1533a0e6aa7f" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(loopCounter4 = 0; loopCounter4 < l_int_NumberOfSampleTargetWells_distinct;)
{
loopCounter4 = loopCounter4 + 1;
// }} ""
// {{{ 241 1 0 "1e4a1c49_edce_4174_aea3b16c1b546ae9" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ARRAYTOOLS::ArrayVLookUp(l_arr_str_SampleTargetPosition, l_arr_str_SampleTargetPosition_copy, l_arr_str_SampleTargetPosition_distinct.ElementAt( loopCounter4 -1), l_arr_str_Temp);
// }} ""
// {{ 242 1 0 "ec0500da_6c33_4ef5_bd57077712b1b25c" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
l_int_NumberOfUseThisSample=l_arr_str_Temp.GetSize();
// }} ""
// {{ 243 1 0 "262e6d29_0843_46c4_bf54c09064b9f43f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfUseThisSample > 1)
{
// }} ""
// {{ 244 1 0 "dae11079_9d6f_497d_b481bc6de4e5d3c0" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_str_MultipleUsedSampleTargetPositions.AddAsLast(l_arr_str_SampleTargetPosition_distinct.ElementAt( loopCounter4 -1));
// }} ""
// {{ 245 1 0 "870252ab_6cfe_4c64_8a2802abc804ab8c" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_MultipleUsedSampleTargetPositions == "")
{
// }} ""
// {{ 246 1 0 "3b7b52d8_4355_4bca_857c9fe58d6d9a6b" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_str_MultipleUsedSampleTargetPositions = l_arr_str_SampleTargetPosition_distinct.ElementAt( loopCounter4 -1);
// }} ""
// {{ 247 1 0 "870252ab_6cfe_4c64_8a2802abc804ab8c" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 248 1 0 "04a10241_94ad_4b42_accfdd59215fb993" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_MultipleUsedSampleTargetPositions = StrConcat4(l_str_MultipleUsedSampleTargetPositions, Translate(", "), l_arr_str_SampleTargetPosition_distinct.ElementAt( loopCounter4 -1), Translate(""));
// }} ""
// {{ 249 1 0 "870252ab_6cfe_4c64_8a2802abc804ab8c" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 250 1 0 "262e6d29_0843_46c4_bf54c09064b9f43f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 251 1 0 "839c4177_cf1f_46d1_928d1533a0e6aa7f" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 252 1 0 "5d03aa1d_8165_4c94_a39364b18567aa14" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
l_int_NumberOfSamplesUsedMultipleTimes=l_arr_str_MultipleUsedSampleTargetPositions.GetSize();
// }} ""
// {{ 253 1 0 "35cd54f2_e508_4ee2_bbfa4a853cda283b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfSamplesUsedMultipleTimes > 0)
{
// }} ""
// {{{ 254 1 0 "b7c4ef85_dc86_4a01_830821ce7dc5ce0a" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceArray(TRACE_LEVEL_RELEASE, Translate("l_arr_str_MultipleUsedSampleTargetPositions: "), l_arr_str_MultipleUsedSampleTargetPositions);
// }} ""
// {{ 255 1 0 "35cd54f2_e508_4ee2_bbfa4a853cda283b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 256 1 0 "474733db_d62e_46eb_89cac17a6765b068" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 257 1 0 "fd53dc1b_477d_492f_b622d24e8dbdccd0" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 258 1 0 "36a99f4a_1bf5_4831_ac3dc46346a1334a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_NormalizeInOriginalSamplePlate == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{ 259 1 0 "356cb2fd_6020_43e5_84315cf68e53db96" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension == "csv")
{
// }} ""
// {{ 260 1 0 "b9af7bfb_83e2_4cf5_b19e1090f5e0d63d" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_791E7CA424734d82862EFA902864B097 ;
err.Clear();
// }} ""
// {{ 261 1 0 "cf44ee3d_24f0_4767_b4e178ebcb3aeb26" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Concentration", t_hdlFile_Worklist_Sample_Concentration, hslFloat);
t_hdlFile_Worklist.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
t_hdlFile_Worklist.AddField("Final_SampleConcentration", t_hdlFile_Worklist_FinalSampleConcentration, hslFloat);
t_hdlFile_Worklist.SetDelimiter(";");
if( 0 == t_hdlFile_Worklist.Open(i_str_WorklistFilePath, hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_WorklistFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 262 1 0 "b9af7bfb_83e2_4cf5_b19e1090f5e0d63d" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_791E7CA424734d82862EFA902864B097 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{{ 263 1 0 "f7bd45be_56bb_4e82_83694313216ef027" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_DATA_IntegratedAbortHandler(l_strFunctionName, Translate("Normalization and Pooling Controller cannot open input worklist. Please review file structure and content, possibly required columns or entries are missing. System will abort"));
// }} ""
// {{{ 264 1 0 "1fcac05c_e844_4841_b46e7e3fdccb825e" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::FALSE);
// }} ""
// {{ 265 1 0 "b9af7bfb_83e2_4cf5_b19e1090f5e0d63d" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 266 1 0 "356cb2fd_6020_43e5_84315cf68e53db96" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 267 1 0 "1089be4c_67d1_415b_bcc90cc71a480afc" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension == "xls")
{
// }} ""
// {{ 268 1 0 "029190a0_e54c_456d_8d918ec824c7d00f" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_CE29F33D9395462bBAC5F2192FFD56AA ;
err.Clear();
// }} ""
// {{ 269 1 0 "e8e85f0c_b31b_4123_8097d4ff8e5f1a84" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Concentration", t_hdlFile_Worklist_Sample_Concentration, hslFloat);
t_hdlFile_Worklist.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
t_hdlFile_Worklist.AddField("Final_SampleConcentration", t_hdlFile_Worklist_FinalSampleConcentration, hslFloat);
if( 0 == t_hdlFile_Worklist.Open(i_str_WorklistFilePath + " " + "Sheet1$", hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_WorklistFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 270 1 0 "029190a0_e54c_456d_8d918ec824c7d00f" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_CE29F33D9395462bBAC5F2192FFD56AA : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{{ 271 1 0 "34cc2e32_8c78_4fb1_8caeb04c23315ee3" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_DATA_IntegratedAbortHandler(l_strFunctionName, Translate("Normalization and Pooling Controller cannot open input worklist. Please review file structure and content, possibly required columns or entries are missing. System will abort"));
// }} ""
// {{{ 272 1 0 "bedaa63f_6802_471e_9442eb1b3f1bee0a" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::FALSE);
// }} ""
// {{ 273 1 0 "029190a0_e54c_456d_8d918ec824c7d00f" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 274 1 0 "1089be4c_67d1_415b_bcc90cc71a480afc" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 275 1 0 "a7e8a3ac_30f2_4c8b_94df0beebb8d4b7b" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Output.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Output.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Output.AddField("Sample_Concentration", t_hdlFile_Worklist_Sample_Concentration, hslFloat);
t_hdlFile_Output.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
t_hdlFile_Output.AddField("Final_SampleConcentration", t_hdlFile_Worklist_FinalSampleConcentration, hslFloat);
t_hdlFile_Output.AddField("Final_SampleVolume", t_hdlFile_Worklist_FinalSampleVolume, hslFloat);
t_hdlFile_Output.AddField("SampleStatus", t_hdlFile_Worklist_SampleStatus, hslString, 255);
if( 0 == t_hdlFile_Output.Open(t_str_OutputFilePath + " " + "Sheet1", hslWrite) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, t_str_OutputFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 276 1 0 "36a99f4a_1bf5_4831_ac3dc46346a1334a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 277 1 0 "3f11c93c_840e_4d84_b0c989bb36848468" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension == "csv")
{
// }} ""
// {{ 278 1 0 "2694798e_f612_42e7_bb978502651cd69a" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_31A0003EF12D448f88D97584D690B69D ;
err.Clear();
// }} ""
// {{ 279 1 0 "a5b0090b_0877_4a94_90a7918dfe43bb9c" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Worklist.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Concentration", t_hdlFile_Worklist_Sample_Concentration, hslFloat);
t_hdlFile_Worklist.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
t_hdlFile_Worklist.AddField("Final_SampleConcentration", t_hdlFile_Worklist_FinalSampleConcentration, hslFloat);
t_hdlFile_Worklist.AddField("Final_SampleVolume", t_hdlFile_Worklist_FinalSampleVolume, hslFloat);
t_hdlFile_Worklist.SetDelimiter(";");
if( 0 == t_hdlFile_Worklist.Open(i_str_WorklistFilePath, hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_WorklistFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 280 1 0 "2694798e_f612_42e7_bb978502651cd69a" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_31A0003EF12D448f88D97584D690B69D : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{{ 281 1 0 "0751dd4a_8d90_4d50_b8e238f4fcd03e76" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_DATA_IntegratedAbortHandler(l_strFunctionName, Translate("Normalization and Pooling Controller cannot open input worklist. Please review file structure and content, possibly required columns or entries are missing. System will abort"));
// }} ""
// {{{ 282 1 0 "7b8558e8_e2ff_499c_9cd74f2952b8bc93" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::FALSE);
// }} ""
// {{ 283 1 0 "2694798e_f612_42e7_bb978502651cd69a" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 284 1 0 "3f11c93c_840e_4d84_b0c989bb36848468" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 285 1 0 "71ccbe66_8226_4dae_9676b12f2f0960b0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension == "xls")
{
// }} ""
// {{ 286 1 0 "9f8a24c7_4c28_4939_880d636f85a98560" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_9BD903B738B0400d924578FC5206D667 ;
err.Clear();
// }} ""
// {{ 287 1 0 "ff6561e6_083e_481f_bf3db9c26358724f" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Worklist.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Concentration", t_hdlFile_Worklist_Sample_Concentration, hslFloat);
t_hdlFile_Worklist.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
t_hdlFile_Worklist.AddField("Final_SampleConcentration", t_hdlFile_Worklist_FinalSampleConcentration, hslFloat);
t_hdlFile_Worklist.AddField("Final_SampleVolume", t_hdlFile_Worklist_FinalSampleVolume, hslFloat);
if( 0 == t_hdlFile_Worklist.Open(i_str_WorklistFilePath + " " + "Sheet1$", hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_WorklistFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 288 1 0 "9f8a24c7_4c28_4939_880d636f85a98560" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_9BD903B738B0400d924578FC5206D667 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{{ 289 1 0 "3383c8e0_8499_4fe3_91a83a1929f0e54c" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_DATA_IntegratedAbortHandler(l_strFunctionName, Translate("Normalization and Pooling Controller cannot open input worklist. Please review file structure and content, possibly required columns or entries are missing. System will abort"));
// }} ""
// {{{ 290 1 0 "78daefbd_7844_4f80_88c0f1e70d23871d" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::FALSE);
// }} ""
// {{ 291 1 0 "9f8a24c7_4c28_4939_880d636f85a98560" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 292 1 0 "71ccbe66_8226_4dae_9676b12f2f0960b0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 293 1 0 "b8767ad1_e66a_47d6_aac815a55143a46c" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Output.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Output.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Output.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
t_hdlFile_Output.AddField("Sample_Concentration", t_hdlFile_Worklist_Sample_Concentration, hslFloat);
t_hdlFile_Output.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
t_hdlFile_Output.AddField("Final_SampleConcentration", t_hdlFile_Worklist_FinalSampleConcentration, hslFloat);
t_hdlFile_Output.AddField("Final_SampleVolume", t_hdlFile_Worklist_FinalSampleVolume, hslFloat);
t_hdlFile_Output.AddField("SampleStatus", t_hdlFile_Worklist_SampleStatus, hslString, 255);
if( 0 == t_hdlFile_Output.Open(t_str_OutputFilePath + " " + "Sheet1", hslWrite) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, t_str_OutputFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 294 1 0 "36a99f4a_1bf5_4831_ac3dc46346a1334a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 295 1 0 "972a8f7d_5e41_4269_90752e6b32d0f428" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter1 = 0;
while (
   (t_hdlFile_Worklist.Eof() == 0)
)
{
loopCounter1 = loopCounter1 + 1;
// }} ""
// {{ 296 1 0 "5515b1bb_9203_4a49_8107d78e83522b15" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Worklist.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 297 1 0 "02d9e3a5_8d82_474c_8dcc67a4cb8e4ef3" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_Volume_SampleAspirate = 0.0;
// }} ""
// {{ 298 1 0 "458c5efb_5290_468d_82ca8bc86932f12b" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_Volume_DiluentAspirate = 0.0;
// }} ""
// {{ 299 1 0 "4b841368_15bc_49db_8465e808c7cdcd4b" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_Volume_Total = 0.0;
// }} ""
// {{ 300 1 0 "13fc3a43_91a8_4a62_9bea4165ed667ace" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_NormalizeInOriginalSamplePlate == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{ 301 1 0 "2b0d6322_705a_4db3_91e31b482961cb85" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 302 1 0 "73c7cab1_2bc4_4cc0_9c44520e2d81c46f" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_int_NumberOfUseSample.SetSize(l_int_NumberOfSamplesUsedMultipleTimes);
// }} ""
// {{ 303 1 0 "f39bed10_4f20_4875_acf5e151383ced6a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (t_intTraceLevel == TRACE_LEVEL_DEBUG)
{
// }} ""
// {{{ 304 1 0 "347d247c_c65e_4ef9_80e7546bb3df0373" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_10(TRACE_LEVEL_DEBUG, Translate(" t_hdlFile_Worklist_Sample_ID: "), t_hdlFile_Worklist_Sample_ID, Translate("  t_hdlFile_Worklist_Sample_Position: "), t_hdlFile_Worklist_Sample_Position, Translate("  t_hdlFile_Worklist_Sample_Concentration: "), t_hdlFile_Worklist_Sample_Concentration, Translate(""), Translate(""), Translate("  t_hdlFile_Worklist_OriginalSampleVolume: "), t_hdlFile_Worklist_OriginalSampleVolume);
// }} ""
// {{ 305 1 0 "f39bed10_4f20_4875_acf5e151383ced6a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
l_flt_Volume_Total = (t_hdlFile_Worklist_OriginalSampleVolume * t_hdlFile_Worklist_Sample_Concentration)/ t_hdlFile_Worklist_FinalSampleConcentration;
l_flt_Volume_DiluentAspirate = (l_flt_Volume_Total - t_hdlFile_Worklist_OriginalSampleVolume);
// {{{ 307 1 0 "faacde2a_33e3_42b4_850dd604e84dc1cf" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_flt_Volume_DiluentAspirate = MthRound(l_flt_Volume_DiluentAspirate, 1);
// }} ""
// {{{ 308 1 0 "0a406150_63ce_4316_999dc001c143252c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_flt_Volume_Total = MthRound(l_flt_Volume_Total, 1);
// }} ""
// {{ 309 1 0 "d3452065_2b2a_43f3_b01935232b9824a4" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_FinalSampleVolume = l_flt_Volume_Total;
// }} ""
// {{ 310 1 0 "243c0903_cc85_4f0f_80177e67e3e2f7e5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_Volume_Total <= i_flt_MaximumVolumePerContainer)
{
// }} ""
// {{ 311 1 0 "66b692fc_6fb6_47c6_9006c4dbe814a85a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (t_hdlFile_Worklist_Sample_Concentration >= t_hdlFile_Worklist_FinalSampleConcentration)
{
// }} ""
// {{ 312 1 0 "eb8d82ed_14e4_4e5c_93c4b12208ea7e44" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_SampleExcluded = ASWGLOBAL::BOOL::FALSE;
// }} ""
// {{ 313 1 0 "707c94b9_3f1d_4199_8375b1285d8ed139" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 314 1 0 "45a4606c_f7e3_47a9_864eefa1c9ed74a0" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(loopCounter5 = 0; loopCounter5 < l_int_NumberOfSamplesUsedMultipleTimes;)
{
loopCounter5 = loopCounter5 + 1;
// }} ""
// {{ 315 1 0 "b1202880_f196_40a4_b16d67ed9555a09a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (t_hdlFile_Worklist_Sample_Position == l_arr_str_MultipleUsedSampleSourcePositions.ElementAt( loopCounter5 -1))
{
// }} ""
// {{ 316 1 0 "c80559b0_00ff_41c6_960148134a2022cc" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
l_int_NumberOfUseThisSample=l_arr_int_NumberOfUseSample.GetAt(loopCounter5-1);
// }} ""
// {{ 317 1 0 "a6d53c42_a43f_413e_8f9be423868ceece" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfUseThisSample == 0)
{
// }} ""
// {{ 318 1 0 "3fad8866_78c3_4a27_8fd1b815c80d6521" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_int_NumberOfUseThisSample = 1;
// }} ""
// {{ 319 1 0 "a6d53c42_a43f_413e_8f9be423868ceece" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 320 1 0 "6209ec0e_0af4_4508_ac8b22ff5df21311" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
l_int_NumberOfUseThisSample = l_int_NumberOfUseThisSample + 1;
// }} ""
// {{ 321 1 0 "e013169e_7a1d_4b6f_9b14c763680f68c5" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_SampleExcluded = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 322 1 0 "d0148507_a04c_4346_bcd5aa146ac3b5c8" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = Translate("Excluded - Sample used multiple times.");
// }} ""
// {{ 323 1 0 "a6d53c42_a43f_413e_8f9be423868ceece" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 324 1 0 "cbca8277_9953_4fde_8cc96ae67e2e12ae" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_int_NumberOfUseSample.SetAt(loopCounter5-1, l_int_NumberOfUseThisSample);
// }} ""
// {{ 325 1 0 "b1202880_f196_40a4_b16d67ed9555a09a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 326 1 0 "45a4606c_f7e3_47a9_864eefa1c9ed74a0" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 327 1 0 "707c94b9_3f1d_4199_8375b1285d8ed139" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 328 1 0 "8578ec38_6fad_4831_9c5419b1e8c7bcdb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_SampleExcluded == ASWGLOBAL::BOOL::FALSE)
{
// }} ""
// {{ 329 1 0 "4c605059_6037_4453_a97d0edbe8353d4b" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = Translate("Processed");
// }} ""
// {{ 330 1 0 "c98a1e05_4e90_42a7_bd1af8c805b1d7eb" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
o_int_NumberOfSamples = o_int_NumberOfSamples + 1;
// }} ""
// {{ 331 1 0 "7e2e2a1a_3bd3_4d63_81d7ac8710ea1fa1" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_Volume_DiluentAspirate >= l_flt_Volume_MinimumToPipetteDiluent)
{
// }} ""
// {{{ 332 1 0 "b0ff1a31_de84_4865_a691fbc1f2369692" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqAdd(o_seq_Disp_Diluent, l_str_LabwareID_SamplePlate, t_hdlFile_Worklist_Sample_Position);
// }} ""
// {{ 333 1 0 "09ef3d21_cdfb_4329_b9dfefcc4ac3ca91" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
o_arr_flt_Volumes_Diluent.AddAsLast(l_flt_Volume_DiluentAspirate);
// }} ""
// {{ 334 1 0 "4dca9432_c835_47fb_a396216f8bac0958" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
o_flt_Diluent_TotalVolume = o_flt_Diluent_TotalVolume + l_flt_Volume_DiluentAspirate;
// }} ""
// {{ 335 1 0 "7e2e2a1a_3bd3_4d63_81d7ac8710ea1fa1" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 336 1 0 "8578ec38_6fad_4831_9c5419b1e8c7bcdb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 337 1 0 "66b692fc_6fb6_47c6_9006c4dbe814a85a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 338 1 0 "c78d50b3_f426_4e24_b3a7a54d67990a72" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_SampleExcluded = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 339 1 0 "0eb61640_b120_462d_b56c50a72e12c95e" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = Translate("Excluded - Sample concentration too low");
// }} ""
// {{ 340 1 0 "66b692fc_6fb6_47c6_9006c4dbe814a85a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 341 1 0 "243c0903_cc85_4f0f_80177e67e3e2f7e5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 342 1 0 "569ffb9d_505e_434a_9da695cfab32f58e" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_SampleExcluded = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 343 1 0 "69623375_1500_4433_a3d65ed1070c2774" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = Translate("Excluded - Concentration too high (Maximum capacity of container exceeded)");
// }} ""
// {{ 344 1 0 "243c0903_cc85_4f0f_80177e67e3e2f7e5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 345 1 0 "1b451b6e_abf6_4903_b7cd3864f9b04bd0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_SampleExcluded == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{ 346 1 0 "18c05b1a_a737_49e2_a5b91bbd1309ceaf" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
l_int_NumberOfSamples_Excluded = l_int_NumberOfSamples_Excluded + 1;
// }} ""
// {{ 347 1 0 "1b451b6e_abf6_4903_b7cd3864f9b04bd0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 348 1 0 "3bf7c29e_19fe_4855_a615f29db0f72124" "{B31F3537-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Output.WriteRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1473380096, MECC::IDS::stepNameFileWrite, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 349 1 0 "13fc3a43_91a8_4a62_9bea4165ed667ace" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 350 1 0 "0ad40f2a_9108_4872_b126ecbcd88d43b2" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 351 1 0 "16a606d8_7078_475a_b2f5c0ebd9002c3f" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_int_NumberOfUseSample.SetSize(l_int_NumberOfSamplesUsedMultipleTimes);
// }} ""
// {{{ 352 1 0 "cb4ceba1_3946_43a9_8b8709a77fccf3c7" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_10(TRACE_LEVEL_DEBUG, Translate(" t_hdlFile_Worklist_Sample_ID: "), t_hdlFile_Worklist_Sample_ID, Translate("  t_hdlFile_Worklist_Sample_Position: "), t_hdlFile_Worklist_Sample_Position, Translate("  t_hdlFile_Worklist_Sample_Concentration: "), t_hdlFile_Worklist_Sample_Concentration, Translate("  t_hdlFile_Worklist_Target_Well: "), t_hdlFile_Worklist_Target_Well, Translate("  t_hdlFile_Worklist_OriginalSampleVolume: "), t_hdlFile_Worklist_OriginalSampleVolume);
// }} ""
l_flt_Volume_SampleAspirate = (t_hdlFile_Worklist_FinalSampleVolume * t_hdlFile_Worklist_FinalSampleConcentration)/t_hdlFile_Worklist_Sample_Concentration;
l_flt_Volume_DiluentAspirate = t_hdlFile_Worklist_FinalSampleVolume - l_flt_Volume_SampleAspirate;
// {{{ 354 1 0 "9fafb019_9244_4d78_a6c3687b5870d6aa" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_flt_Volume_DiluentAspirate = MthRound(l_flt_Volume_DiluentAspirate, 1);
// }} ""
// {{{ 355 1 0 "f283cb07_9469_46f7_8a1980150a871b73" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_flt_Volume_SampleAspirate = MthRound(l_flt_Volume_SampleAspirate, 1);
// }} ""
// {{ 356 1 0 "6958e885_ee49_4e8e_9cc49ad760e49a26" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (t_hdlFile_Worklist_FinalSampleVolume <= i_flt_MaximumVolumePerContainer)
{
// }} ""
// {{ 357 1 0 "ebc85026_f63b_4cbe_b747c434036e1c29" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_Volume_SampleAspirate >= l_flt_Volume_MinimumToPipette)
{
// }} ""
// {{ 358 1 0 "45f23bbd_44ba_47e7_8d1be5162140e83d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_Volume_SampleAspirate <= t_hdlFile_Worklist_FinalSampleVolume)
{
// }} ""
// {{ 359 1 0 "f358341a_fcb1_4e43_ac277133037ec03d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (t_hdlFile_Worklist_OriginalSampleVolume >= l_flt_Volume_SampleAspirate)
{
// }} ""
// {{ 360 1 0 "7a9bceaa_74a4_4b56_b7b6082936fb3cf3" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_SampleExcluded = ASWGLOBAL::BOOL::FALSE;
// }} ""
// {{ 361 1 0 "1c3b5712_65d2_465a_9be585c149a2878f" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 362 1 0 "874cad87_53c3_4703_a3f287733478b435" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(loopCounter5 = 0; loopCounter5 < l_int_NumberOfSamplesUsedMultipleTimes;)
{
loopCounter5 = loopCounter5 + 1;
// }} ""
// {{ 363 1 0 "0177e718_0355_49f5_9dfd8bd65bde0182" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (t_hdlFile_Worklist_Target_Well == l_arr_str_MultipleUsedSampleTargetPositions.ElementAt( loopCounter5 -1))
{
// }} ""
// {{ 364 1 0 "a77e8646_3c36_40ab_becede07d26d6eac" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
l_int_NumberOfUseThisSample=l_arr_int_NumberOfUseSample.GetAt(loopCounter5-1);
// }} ""
// {{ 365 1 0 "29a07295_8d93_4044_9bae783c2a1b9383" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfUseThisSample == 0)
{
// }} ""
// {{ 366 1 0 "0340596c_ce62_4b92_8fa82a506e81041f" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_int_NumberOfUseThisSample = 1;
// }} ""
// {{ 367 1 0 "29a07295_8d93_4044_9bae783c2a1b9383" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 368 1 0 "6dbfb99c_d47d_46c1_ac19e410a6ce9e60" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
l_int_NumberOfUseThisSample = l_int_NumberOfUseThisSample + 1;
// }} ""
// {{ 369 1 0 "5d74a289_607b_47ca_8b97d168a76ee8b7" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_SampleExcluded = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 370 1 0 "317c0800_1b7c_45d2_a7ae23f193c8ff0c" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = Translate("Excluded - Sample target position used multiple times");
// }} ""
// {{ 371 1 0 "29a07295_8d93_4044_9bae783c2a1b9383" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 372 1 0 "beca01b7_06e8_48b3_987758f515c9e55d" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_int_NumberOfUseSample.SetAt(loopCounter5-1, l_int_NumberOfUseThisSample);
// }} ""
// {{ 373 1 0 "0177e718_0355_49f5_9dfd8bd65bde0182" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 374 1 0 "874cad87_53c3_4703_a3f287733478b435" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 375 1 0 "1c3b5712_65d2_465a_9be585c149a2878f" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 376 1 0 "74d7dc14_e267_4b30_b8992fc76b00ba1a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_SampleExcluded == ASWGLOBAL::BOOL::FALSE)
{
// }} ""
// {{ 377 1 0 "a7bfc1b4_f864_4903_b7cc0dcbdfbe3fdd" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = Translate("Processed");
// }} ""
// {{ 378 1 0 "dfef6ec3_62e3_4d0d_913d5b917be57809" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
o_int_NumberOfSamples = o_int_NumberOfSamples + 1;
// }} ""
// {{{ 379 1 0 "e880d029_771d_46d4_bad6d0e134c1b048" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqAdd(o_seq_Asp_Samples, l_str_LabwareID_SamplePlate, t_hdlFile_Worklist_Sample_Position);
// }} ""
// {{{ 380 1 0 "dd1e9dbd_8f21_4b48_861841693d069216" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqAdd(o_seq_Disp_Samples, l_str_LabwareID_NormalizationPlate, t_hdlFile_Worklist_Target_Well);
// }} ""
// {{ 381 1 0 "06765c0e_e22b_46cb_b3b06df703d4438e" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
o_arr_flt_Volumes_Sample.AddAsLast(l_flt_Volume_SampleAspirate);
// }} ""
// {{ 382 1 0 "74d7dc14_e267_4b30_b8992fc76b00ba1a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 383 1 0 "f358341a_fcb1_4e43_ac277133037ec03d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 384 1 0 "9b68cf3d_ff39_4f9b_827fa9346919b6fd" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_SampleExcluded = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 385 1 0 "8ccff877_28f3_4f4f_a3b045a8d9047151" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = Translate("Excluded - Not enough volume to aspirate sample");
// }} ""
// {{ 386 1 0 "f358341a_fcb1_4e43_ac277133037ec03d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 387 1 0 "45f23bbd_44ba_47e7_8d1be5162140e83d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 388 1 0 "dc17b14a_1369_4f39_9e95eb9b83865f5f" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_SampleExcluded = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 389 1 0 "5d751e11_a613_48a0_aab874c6a7da08bc" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = Translate("Excluded - Sample concentration too low");
// }} ""
// {{ 390 1 0 "45f23bbd_44ba_47e7_8d1be5162140e83d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 391 1 0 "ebc85026_f63b_4cbe_b747c434036e1c29" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 392 1 0 "8eb9222d_e273_4164_92a0e2bf849c2eeb" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_SampleExcluded = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 393 1 0 "c9f5cd9c_e056_4748_aa7b14c07437123a" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = Translate("Excluded - Sample concentration too high (Sample volume to aspirate below minimum allowed)");
// }} ""
// {{ 394 1 0 "ebc85026_f63b_4cbe_b747c434036e1c29" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 395 1 0 "6958e885_ee49_4e8e_9cc49ad760e49a26" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 396 1 0 "32a217f4_8162_4633_a5e21c1f3493c203" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_SampleExcluded = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 397 1 0 "087b4617_f2d5_4d39_8e821ca4fb33e014" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = Translate("Excluded - Final sample volume exceeds maximum volume allowed per container");
// }} ""
// {{ 398 1 0 "6958e885_ee49_4e8e_9cc49ad760e49a26" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 399 1 0 "823bc026_7d4d_4c38_a7f7213e9a0e7c10" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_SampleExcluded == ASWGLOBAL::BOOL::FALSE)
{
// }} ""
// {{ 400 1 0 "34fd6abe_fdcb_4261_900b6905aef44872" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_Volume_DiluentAspirate >= l_flt_Volume_MinimumToPipetteDiluent)
{
// }} ""
// {{ 401 1 0 "bfa62b0b_245d_47e1_ac4da64f0ba6770b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_Volume_DiluentAspirate <= t_hdlFile_Worklist_FinalSampleVolume)
{
// }} ""
// {{{ 402 1 0 "e6eb1c5a_bdc2_404d_86d197978ea87b93" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqAdd(o_seq_Disp_Diluent, l_str_LabwareID_NormalizationPlate, t_hdlFile_Worklist_Target_Well);
// }} ""
// {{ 403 1 0 "e470e85e_ab7f_4399_b66d729e8b349f8a" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
o_arr_flt_Volumes_Diluent.AddAsLast(l_flt_Volume_DiluentAspirate);
// }} ""
// {{ 404 1 0 "8c58813d_1c36_4358_a4e2c13e141ab776" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
o_flt_Diluent_TotalVolume = o_flt_Diluent_TotalVolume + l_flt_Volume_DiluentAspirate;
// }} ""
// {{ 405 1 0 "bfa62b0b_245d_47e1_ac4da64f0ba6770b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 406 1 0 "34fd6abe_fdcb_4261_900b6905aef44872" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 407 1 0 "823bc026_7d4d_4c38_a7f7213e9a0e7c10" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 408 1 0 "9c7b29bb_6060_4ec8_b2c59b237ac4f7fe" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
l_int_NumberOfSamples_Excluded = l_int_NumberOfSamples_Excluded + 1;
// }} ""
// {{ 409 1 0 "823bc026_7d4d_4c38_a7f7213e9a0e7c10" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 410 1 0 "af54f6cc_a2a4_4f9b_a355bc129b226e1d" "{B31F3537-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Output.WriteRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1473380096, MECC::IDS::stepNameFileWrite, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 411 1 0 "13fc3a43_91a8_4a62_9bea4165ed667ace" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 412 1 0 "972a8f7d_5e41_4269_90752e6b32d0f428" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 413 1 0 "e12c53d9_ea9a_4d81_909983d1b0cbd262" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Worklist.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Worklist.RemoveFields();
// }} ""
// {{ 414 1 0 "3920bacd_f96e_4bfd_999208ecd45aa180" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Output.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Output.RemoveFields();
// }} ""
// {{ 415 1 0 "3cc0dca9_bb17_4bce_99e217cccd2eebf3" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
o_str_FilePath_OutputFile = t_str_OutputFilePath;
// }} ""
// {{ 416 1 0 "dc6e68b0_5e6b_45c9_87585b379bea32ae" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 417 1 0 "b7825350_8e6d_4d9a_91572cbd6fc376f2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfSamples_Excluded > 0)
{
// }} ""
// {{ 418 1 0 "cf265ce9_51e3_4e00_aa57368705c9db8f" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_strTokens.SetSize(0);
// }} ""
// {{ 419 1 0 "46c4a609_4a01_41b4_8c75372f2899985d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfSamples_Excluded == l_int_NumberOfSamples_Source)
{
// }} ""
// {{{ 420 1 0 "8bb203ac_fe0e_4151_b593ba77e5a93688" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Message = StrConcat12(Translate("Number of samples excluded for this run = "), l_int_NumberOfSamples_Excluded, Translate("\n\nALL SAMPLES ARE EXCLUDED. Please review worklist and input parameters "), Translate(""), Translate(""), Translate(""), Translate(""), Translate(""), Translate(""), Translate(""), Translate(""), Translate(""));
// }} ""
// {{{ 421 1 0 "2e16d240_750f_4386_84f3fb46a461c885" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
STRTOKENIZE::StrTokenize(l_strFunctionName, Translate("::"), l_arr_strTokens, ASWGLOBAL::BOOL::TRUE);
// }} ""
// {{{ 422 1 0 "888373c5_869c_4f84_bf45dc3ddbba57f1" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_int_ReturnValue = VectorCustomDialogs::MessageDialog(l_arr_strTokens.ElementAt( 3 -1), 3, 5, 0, 0, 0, l_str_Message);
// }} ""
// {{ 423 1 0 "2efd70ed_054e_4a7f_a504af4641087b26" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_ReturnValue == 4)
{
// }} ""
// {{{ 424 1 0 "c43d8202_e33b_40f9_944017cd47d3aeae" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_Display_InputWorklist_Dialog(i_str_WorklistFilePath);
// }} ""
// {{ 425 1 0 "2efd70ed_054e_4a7f_a504af4641087b26" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 426 1 0 "bbc8d419_8e42_4086_8409d0f841b5a206" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_ReturnValue == 2)
{
// }} ""
// {{{ 427 1 0 "f4c8d30a_694c_4c58_aa098846c0420a1d" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::DIALOG::ABORT);
// }} ""
// {{ 428 1 0 "bbc8d419_8e42_4086_8409d0f841b5a206" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 429 1 0 "2efd70ed_054e_4a7f_a504af4641087b26" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 430 1 0 "46c4a609_4a01_41b4_8c75372f2899985d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 431 1 0 "78e24a7e_1be2_49f8_9944ee2539d411f6" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_bln_AllowCostumerIntervention == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{ 432 1 0 "2993118e_df73_49f9_9a9a63bd200ca529" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_NormalizeInOriginalSamplePlate == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{ 433 1 0 "2d1150f6_07cc_49a2_b08e701f7a129a60" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfSamplesUsedMultipleTimes > 0)
{
// }} ""
// {{{ 434 1 0 "7c434a24_a036_46c5_a0628b3025220582" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Message = StrConcat12(Translate("Number of samples excluded for this run = "), l_int_NumberOfSamples_Excluded, Translate("\n\nData has been logged into the following file: "), Translate("\n"), o_str_FilePath_OutputFile, Translate("\n\nPlease note that "), l_int_NumberOfSamplesUsedMultipleTimes, Translate(" samples ("), l_str_MultipleUsedSampleSourcePositions, Translate(") are used multiple times."), Translate(""), Translate(""));
// }} ""
// {{ 435 1 0 "2d1150f6_07cc_49a2_b08e701f7a129a60" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 436 1 0 "b761a582_ff79_4525_9d790ce7ad71dd45" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Message = StrConcat12(Translate("Number of samples excluded for this run = "), l_int_NumberOfSamples_Excluded, Translate("\n\nData has been logged into the following file: "), Translate("\n"), o_str_FilePath_OutputFile, Translate(""), Translate(""), Translate(""), Translate(""), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 437 1 0 "2d1150f6_07cc_49a2_b08e701f7a129a60" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 438 1 0 "2993118e_df73_49f9_9a9a63bd200ca529" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 439 1 0 "192fc593_62f6_4218_98899d7713d28727" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfSamplesUsedMultipleTimes > 0)
{
// }} ""
// {{{ 440 1 0 "62377370_8e08_440a_b7b6e6d141bffd1c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Message = StrConcat12(Translate("Number of samples excluded for this run = "), l_int_NumberOfSamples_Excluded, Translate("\n\nData has been logged into the following file: "), Translate("\n"), o_str_FilePath_OutputFile, Translate("\n\nPlease note that "), l_int_NumberOfSamplesUsedMultipleTimes, Translate(" samples ("), l_str_MultipleUsedSampleTargetPositions, Translate(") are used multiple times."), Translate(""), Translate(""));
// }} ""
// {{ 441 1 0 "192fc593_62f6_4218_98899d7713d28727" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 442 1 0 "260fa3fc_460a_4aec_b2e7b4bc6991cb57" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Message = StrConcat12(Translate("Number of samples excluded for this run = "), l_int_NumberOfSamples_Excluded, Translate("\n\nData has been logged into the following file: "), Translate("\n"), o_str_FilePath_OutputFile, Translate(""), Translate(""), Translate(""), Translate(""), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 443 1 0 "192fc593_62f6_4218_98899d7713d28727" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 444 1 0 "2993118e_df73_49f9_9a9a63bd200ca529" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
Trace("l_str_Message:",l_str_Message);
// {{{ 446 1 0 "2631263a_d470_4c87_9567cdc90fd560e3" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Message = StrConcat12(l_str_Message, Translate(""), Translate(""), Translate(""), Translate(""), Translate(""), Translate(""), Translate(""), Translate("\n\nPress IGNORE to continue run without excluded samples."), Translate("\nPress RETRY to load a new worklist"), Translate("\nPress ABORT to abort the run"), Translate(""));
// }} ""
// {{{ 447 1 0 "2cde4137_1772_4aa3_8e79d5ccb248e44e" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
STRTOKENIZE::StrTokenize(l_strFunctionName, Translate("::"), l_arr_strTokens, ASWGLOBAL::BOOL::TRUE);
// }} ""
// {{{ 448 1 0 "90e4c4f5_5368_4b01_a3e5e08f576ee267" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_int_ReturnValue = VectorCustomDialogs::MessageDialog(l_arr_strTokens.ElementAt( 3 -1), 3, 7, 0, 0, 0, l_str_Message);
// }} ""
// {{ 449 1 0 "3743e818_7003_4c97_94ec1459a19dae65" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_ReturnValue == 4)
{
// }} ""
// {{{ 450 1 0 "40ce4f67_5232_414b_a53d949bcb76c059" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_Display_InputWorklist_Dialog(i_str_WorklistFilePath);
// }} ""
// {{ 451 1 0 "3743e818_7003_4c97_94ec1459a19dae65" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 452 1 0 "618782fa_53be_424e_af69f5f74d0a5fc0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_ReturnValue == 5)
{
// }} ""
// {{ 453 1 0 "87655c5e_b71a_4cab_8ce4188e100e468a" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 454 1 0 "618782fa_53be_424e_af69f5f74d0a5fc0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 455 1 0 "080e6cf0_b1c3_48eb_a0c06391d22e59a1" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::DIALOG::ABORT);
// }} ""
// {{ 456 1 0 "618782fa_53be_424e_af69f5f74d0a5fc0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 457 1 0 "3743e818_7003_4c97_94ec1459a19dae65" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 458 1 0 "78e24a7e_1be2_49f8_9944ee2539d411f6" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 459 1 0 "79b0e069_fde1_4907_b7107d4db8cf4e77" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 460 1 0 "78e24a7e_1be2_49f8_9944ee2539d411f6" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 461 1 0 "46c4a609_4a01_41b4_8c75372f2899985d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 462 1 0 "b7825350_8e6d_4d9a_91572cbd6fc376f2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 463 1 0 "5742176c_3c7b_4e52_90a1e899607817f9" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 464 1 0 "b7825350_8e6d_4d9a_91572cbd6fc376f2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 465 1 0 "dc6e68b0_5e6b_45c9_87585b379bea32ae" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 466 1 0 "033256b5_4fdf_426e_9fef88e9c2e78856" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 467 1 0 "9004261d_ab5a_4b39_a31e7fbc33287212" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 468 1 0 "bb23062a_1f4c_432f_aa4353f22281df1e" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_RELEASE, Translate("o_str_FilePath_OutputFile: "), o_str_FilePath_OutputFile);
// }} ""
// {{{ 469 1 0 "254e64a8_b759_4cf6_a61c83195aa37769" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_RELEASE, Translate("o_int_NumberOfSamples: "), o_int_NumberOfSamples);
// }} ""
// {{ 470 1 0 "33820f74_cc61_4915_9c64afcd8b6f1aa6" "{B31F353A-5D80-11d4-A5EB-0050DA737D89}"
o_seq_Asp_Samples.SetCurrentPosition(1);
// }} ""
// {{ 471 1 0 "aa1c2ecc_b46b_4023_b9d44b07c798ed23" "{B31F353A-5D80-11d4-A5EB-0050DA737D89}"
o_seq_Disp_Samples.SetCurrentPosition(1);
// }} ""
// {{ 472 1 0 "9344c630_33ba_41fc_b199433bf10097f6" "{B31F353A-5D80-11d4-A5EB-0050DA737D89}"
o_seq_Disp_Diluent.SetCurrentPosition(1);
// }} ""
// {{ 473 1 0 "d3401b7d_521e_4f4a_8b48fd9b9d9be692" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_NormalizeInOriginalSamplePlate == ASWGLOBAL::BOOL::FALSE)
{
// }} ""
// {{{ 474 1 0 "484ee612_a36b_44a4_8760f5ef718886ad" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceSequence(TRACE_LEVEL_RELEASE, o_seq_Asp_Samples);
// }} ""
// {{{ 475 1 0 "94df4c3c_8551_4796_81afc466834d385c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceSequence(TRACE_LEVEL_RELEASE, o_seq_Disp_Samples);
// }} ""
// {{{ 476 1 0 "c11f7fc9_660c_4480_8d3d93dfc7746f96" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceArray(TRACE_LEVEL_RELEASE, Translate("o_arr_flt_Volumes_Sample: "), o_arr_flt_Volumes_Sample);
// }} ""
// {{ 477 1 0 "d3401b7d_521e_4f4a_8b48fd9b9d9be692" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 478 1 0 "b1bd3884_6db1_4b63_94b2d38b9b0102b7" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceSequence(TRACE_LEVEL_RELEASE, o_seq_Disp_Diluent);
// }} ""
// {{{ 479 1 0 "08c2348d_43ea_40d8_b5f3027a59fd457a" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceArray(TRACE_LEVEL_RELEASE, Translate("o_arr_flt_Volumes_Diluent: "), o_arr_flt_Volumes_Diluent);
// }} ""
// {{{ 480 1 0 "1db7321e_36f3_4644_8e4574f6e1ac3b53" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_RELEASE, Translate("o_flt_Diluent_TotalVolume: "), o_flt_Diluent_TotalVolume);
// }} ""
// {{ 481 1 0 "9004261d_ab5a_4b39_a31e7fbc33287212" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 482 1 0 "4860683e_e514_4b1f_8994c24e83b7c36d" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 483 1 0 "def185b1_96f5_442f_a688b52096ac0c4e" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::COMPLETE, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{{ 484 1 0 "93c6cbea_aca0_475e_8a1b59df890eac9c" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::TRUE);
// }} ""
// {{ 485 1 0 "4860683e_e514_4b1f_8994c24e83b7c36d" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 5 "Normalization_ByConcentration" "End"
}
// }} ""
// {{{ 5 "_Version_history" "Begin"
private function _Version_history(  ) void {
// }} ""
// {{ 5 "_Version_history" "InitLocals"
// }} ""
// {{ 1615 1 0 "8aa68505_c6ab_4799_9dc2c3ad06e1c4db" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 1616 1 0 "0a9a2825_69f0_4f5f_96264ef69bff73eb" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 1617 1 0 "2522c072_9374_48dd_be736591aad105eb" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 1618 1 0 "84fafc21_5280_4780_8577257d77b6a323" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 1619 1 0 "5c5b413f_45d5_40c8_aad6a907cafcdc2d" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 1620 1 0 "4e77435d_566f_47fa_a1c55cad7f7435f7" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 5 "_Version_history" "End"
}
// }} ""
// {{{ 5 "Pooling_ByVolume" "Begin"
function Pooling_ByVolume( variable i_str_WorklistFilePath, sequence i_seq_SourceSamplePlate, sequence i_seq_Pooling, variable i_flt_MaximumVolumePerContainer, variable i_bln_AllowCostumerIntervention, sequence & o_seq_Asp_Samples, sequence & o_seq_Disp_Samples, variable & o_arr_flt_Volumes_Sample[], variable & o_int_NumberOfPools, variable & o_arr_str_PostionIDsPools[], variable & o_arr_flt_Volumes_Pools[], variable & o_str_FilePath_OutputFile, device & ML_STAR ) variable {
// }} ""
private variable l_bln_ReloadWorklist;
private variable l_int_ReturnValue;
private variable l_flt_Volume_SampleAspirate;
private variable l_str_Worklist_Extension;
private variable CounterWorklistReloading;
private variable loopCounter3;
private variable l_flt_VolumePerPool;
private variable l_str_Worklist_FileName;
private variable l_flt_Volume_MinimumToPipette;
private variable l_arr_strTokens[];
private variable l_int_NumberOfSamples_Source;
private variable l_bln_UseVolumePerPoolFromWorklist;
private variable l_int_NumberOfSamplesUsedMultipleTimes;
private variable l_int_NumberOfUseThisSample;
private variable l_int_NumberOfSamples;
private variable l_str_MultipleUsedSampleSourcePositions;
private variable l_arr_str_Temp[];
private variable l_arr_str_SampleSourcePosition[];
private variable l_arr_str_SampleSourcePosition_distinct[];
private variable l_arr_str_SampleSourcePosition_copy[];
private variable l_arr_str_MultipleUsedSampleSourcePositions[];
private variable l_int_NumberOfPools;
private variable l_arr_flt_VolumePerPool[];
private variable l_arr_str_Pool_Ids[];
private variable l_arr_int_NumberOfSamplesPerPool[];
private variable l_bln_PoolProcessed;
private variable l_str_CurrentPoolId;
private variable l_bln_FileExists;
private variable l_bln_ExcludePool;
private variable l_str_Message;
private variable l_str_LabwareID_Pooling;
private variable l_str_ExcludePool;
private variable l_strSQL_Sentence1;
private variable l_int_NumberOfSamples_Excluded;
private variable l_flt_TotalVolumeCurrentPool;
private variable l_bln_ExcludeSample;
private variable l_flt_TotalVolumePerSample;
private variable l_bln_Repeat_Analysis;
private variable l_int_Counter_RepeatAnalysis;
private variable loopCounter1;
private variable loopCounter2;
private variable l_flt_Volume_Total;
private variable l_int_TotalNumberOfSamples_Excluded;
private variable l_str_LabwareID_SamplePlate;
private variable l_int_Counter_Pool;
private variable l_arr_Dummy[];
private variable l_arr_flt_TotalVolumePerSample[];
private variable l_arr_int_TotalNumberOfUsePerSample[];
private variable l_arr_int_NumberOfSamplesPerPool_current[];
private variable l_arr_flt_TotalVolumePerPool[];
private variable l_arr_flt_Volumes_Sample[];
private variable l_arr_str_Pool_Ids_current[];
private variable l_arr_flt_VolumePerPool_current[];
private variable loopCounter5;
private variable l_strFunctionName;
// {{ 5 "Pooling_ByVolume" "InitLocals"
{ sequence __temp; o_seq_Asp_Samples = __temp; }
{ sequence __temp; o_seq_Disp_Samples = __temp; }
o_arr_flt_Volumes_Sample.SetSize( 0);
o_int_NumberOfPools = 0;
o_arr_str_PostionIDsPools.SetSize( 0);
o_arr_flt_Volumes_Pools.SetSize( 0);
o_str_FilePath_OutputFile = 0;
// }} ""
// {{ 895 1 0 "c134799f_999b_4d88_a7c94848352e0891" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 896 1 0 "73cf52d5_28ed_40e7_91a33c32b9eb5381" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_strFunctionName = Translate("");
// }} ""
l_strFunctionName = GetFunctionName();
// {{{ 898 1 0 "9e4a577b_b7ed_443f_81eb4e54f1575db1" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::START, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{ 899 1 0 "c134799f_999b_4d88_a7c94848352e0891" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 900 1 0 "f1aee5a5_1470_41a2_b613f5a472fd692d" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
CounterWorklistReloading = 0;
while (1 == 1)
{
CounterWorklistReloading = CounterWorklistReloading + 1;
// }} ""
// {{ 901 1 0 "2ec868dc_507e_410d_99bf0333db729631" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ReloadWorklist = ASWGLOBAL::BOOL::FALSE;
// }} ""
// {{ 902 1 0 "a5985fc2_1907_4f42_b34e6ed33c6d83cf" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 903 1 0 "d558abb1_4ec6_40da_b5beef327e7aefa4" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_RELEASE, Translate("i_str_WorklistFilePath: "), i_str_WorklistFilePath);
// }} ""
// {{ 904 1 0 "a5985fc2_1907_4f42_b34e6ed33c6d83cf" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 905 1 0 "af291a83_8cd4_41b5_885fe32ff3888200" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 906 1 0 "4383b779_df88_4873_8d985dfa568da58b" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_Volume_MinimumToPipette = 2;
// }} ""
// {{ 907 1 0 "a3386f0c_014a_4439_bd7f35b92d72101f" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
o_arr_flt_Volumes_Sample.SetSize(0);
// }} ""
// {{{ 908 1 0 "c1ed52c1_2cdb_4629_9e86ebf3fafdff5b" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Worklist_FileName = HSLExtensions::File::GetFileNameWithoutExtension(i_str_WorklistFilePath);
// }} ""
// {{{ 909 1 0 "f3310423_e8c7_4ea3_93fe564b37b611f1" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Worklist_Extension = HSLExtensions::File::GetFileExtension(i_str_WorklistFilePath);
// }} ""
// {{{ 910 1 0 "dfe8e7d2_3857_4651_b0d8fe62a0041c20" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
t_str_OutputFilePath = StrConcat12(t_strLogFilesDirectory, Translate("\\"), t_strKitTitle, Translate("_"), Translate("PoolingOutput"), Translate("_"), t_str_Date, Translate("_"), t_str_Time, Translate("."), Translate("xls"), Translate(""));
// }} ""
// {{{ 911 1 0 "9c743002_1563_48a2_bfbf734f577f0fb8" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
t_str_TemplateFilePath = StrConcat12(t_strLogFilesDirectory, Translate("\\"), t_strKitTitle, Translate("_"), Translate("PoolingTemplate"), Translate("_"), t_str_Date, Translate("_"), t_str_Time, Translate("."), Translate("xls"), Translate(""));
// }} ""
// {{{ 912 1 0 "fbc420fd_204b_4369_89d53d9572ce8c55" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
t_str_ExcludedSamplesFilePath = StrConcat12(t_strLogFilesDirectory, Translate("\\"), t_strKitTitle, Translate("_"), Translate("PoolingExcludedSamples"), Translate("_"), t_str_Date, Translate("_"), t_str_Time, Translate("."), Translate("xls"), Translate(""));
// }} ""
// {{ 913 1 0 "42177f60_f2c7_4e01_801a925d25fdb0ca" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_Volume_SampleAspirate = 0.0;
// }} ""
// {{ 914 1 0 "049c8450_a5f7_4bd7_884c014df72aabff" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_VolumePerPool = 0.0;
// }} ""
// {{ 915 1 0 "0c5057be_bd55_4b86_974ce08ed8f367e6" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_VolumePerPool = 0.0;
// }} ""
// {{ 916 1 0 "af291a83_8cd4_41b5_885fe32ff3888200" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 917 1 0 "86698d20_60e9_46a6_a62b91b78dbaa1c1" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 918 1 0 "ff40d554_cb79_49dd_a717214d4923ebdf" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 919 1 0 "9f1b6fa0_6646_401e_ba241b1e973a0efb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension == "csv")
{
// }} ""
// {{ 920 1 0 "9a151729_ca5e_4941_a04edf587b8f0424" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_1C3CC084053F4ade9F88BE6690C66C93 ;
err.Clear();
// }} ""
// {{ 921 1 0 "561469b6_0885_420b_ac48692e8d2ab2d3" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 922 1 0 "0c145792_9fda_45aa_8db8dd351f39c3ba" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Worklist.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
t_hdlFile_Worklist.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
t_hdlFile_Worklist.AddField("Volume_ToAspirate", t_hdlFile_Worklist_VolumeToAspirate, hslFloat);
t_hdlFile_Worklist.AddField("Volume_PerPool", t_hdlFile_Worklist_VolumePerPool, hslFloat);
t_hdlFile_Worklist.SetDelimiter(";");
if( 0 == t_hdlFile_Worklist.Open(i_str_WorklistFilePath, hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_WorklistFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 923 1 0 "ad414a90_6eec_4fd6_bf5aa8d50efdea2c" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Worklist.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 924 1 0 "9451c73c_655a_4116_8a7ff9f99c58ccef" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Worklist.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Worklist.RemoveFields();
// }} ""
// {{ 925 1 0 "e5b8374b_88d4_49a5_a26758db8841a417" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Worklist.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
t_hdlFile_Worklist.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
t_hdlFile_Worklist.AddField("Volume_ToAspirate", t_hdlFile_Worklist_VolumeToAspirate, hslFloat);
t_hdlFile_Worklist.AddField("Volume_PerPool", t_hdlFile_Worklist_VolumePerPool, hslFloat);
t_hdlFile_Worklist.SetDelimiter(";");
if( 0 == t_hdlFile_Worklist.Open(i_str_WorklistFilePath, hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_WorklistFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 926 1 0 "8b1d4480_0049_4240_ab5ddc3466afd633" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_UseVolumePerPoolFromWorklist = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 927 1 0 "9a151729_ca5e_4941_a04edf587b8f0424" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_1C3CC084053F4ade9F88BE6690C66C93 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 928 1 0 "9e3cb9d6_3046_49ca_89b81cefbfb9ba5d" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_B7532A3F88D84fb79FA9E5BFFC745EB8 ;
err.Clear();
// }} ""
// {{ 929 1 0 "7ce4ced0_1b07_40cb_8909535c67f6ece3" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Worklist.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Worklist.RemoveFields();
// }} ""
// {{ 930 1 0 "6b706886_7385_4b5f_8faa03a400cd4070" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Worklist.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
t_hdlFile_Worklist.AddField("Volume_ToAspirate", t_hdlFile_Worklist_VolumeToAspirate, hslFloat);
t_hdlFile_Worklist.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
t_hdlFile_Worklist.SetDelimiter(";");
if( 0 == t_hdlFile_Worklist.Open(i_str_WorklistFilePath, hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_WorklistFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 931 1 0 "9fd4ed8b_fdbf_4a15_8069ae134d8f9366" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Worklist.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 932 1 0 "5e426188_6568_414f_84ea68153d4bcc19" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Worklist.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Worklist.RemoveFields();
// }} ""
// {{ 933 1 0 "f694f113_05d5_47ae_b8e6b7ebc3220a72" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Worklist.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
t_hdlFile_Worklist.AddField("Volume_ToAspirate", t_hdlFile_Worklist_VolumeToAspirate, hslFloat);
t_hdlFile_Worklist.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
t_hdlFile_Worklist.SetDelimiter(";");
if( 0 == t_hdlFile_Worklist.Open(i_str_WorklistFilePath, hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_WorklistFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 934 1 0 "d8b3b95c_0d71_4d47_a4cc26f7008f8fc6" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_UseVolumePerPoolFromWorklist = ASWGLOBAL::BOOL::FALSE;
// }} ""
// {{ 935 1 0 "9e3cb9d6_3046_49ca_89b81cefbfb9ba5d" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_B7532A3F88D84fb79FA9E5BFFC745EB8 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{{ 936 1 0 "b342129a_ca06_4406_a76c8f11c4107bb9" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_DATA_IntegratedAbortHandler(l_strFunctionName, Translate("Normalization and Pooling Controller cannot open input worklist. Please review file structure and content, possibly required columns or entries are missing. System will abort"));
// }} ""
// {{{ 937 1 0 "2a7dd006_0a8f_41b5_9c2914dc10d4203d" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::FALSE);
// }} ""
// {{ 938 1 0 "9e3cb9d6_3046_49ca_89b81cefbfb9ba5d" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 939 1 0 "9a151729_ca5e_4941_a04edf587b8f0424" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 940 1 0 "9f1b6fa0_6646_401e_ba241b1e973a0efb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 941 1 0 "96cdc8bf_f497_4175_bfdd4207c3fe2cb1" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension == "xls")
{
// }} ""
// {{ 942 1 0 "4bf3420c_3043_4139_ae11ffc2c8ed2166" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_C4DC04374D2941acACD9EADFBE8C7A4E ;
err.Clear();
// }} ""
// {{ 943 1 0 "83118c9c_802f_4c71_b84bc6bd21658e09" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 944 1 0 "be21bc91_a9bb_4b76_9930f0178eae197c" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Worklist.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
t_hdlFile_Worklist.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
t_hdlFile_Worklist.AddField("Volume_ToAspirate", t_hdlFile_Worklist_VolumeToAspirate, hslFloat);
t_hdlFile_Worklist.AddField("Volume_PerPool", t_hdlFile_Worklist_VolumePerPool, hslFloat);
if( 0 == t_hdlFile_Worklist.Open(i_str_WorklistFilePath + " " + "Sheet1$", hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_WorklistFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 945 1 0 "2d591e4b_aeb3_486a_b74a6949eaba3464" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Worklist.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 946 1 0 "964cd82f_3b8b_45b6_8fa53b8bae55ad3e" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Worklist.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Worklist.RemoveFields();
// }} ""
// {{ 947 1 0 "7b938333_163b_4aa6_a75f862f994744a1" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Worklist.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
t_hdlFile_Worklist.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
t_hdlFile_Worklist.AddField("Volume_ToAspirate", t_hdlFile_Worklist_VolumeToAspirate, hslFloat);
t_hdlFile_Worklist.AddField("Volume_PerPool", t_hdlFile_Worklist_VolumePerPool, hslFloat);
if( 0 == t_hdlFile_Worklist.Open(i_str_WorklistFilePath + " " + "Sheet1$", hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_WorklistFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 948 1 0 "645317e0_0291_4d9a_a7cfcc3bde8c2120" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_UseVolumePerPoolFromWorklist = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 949 1 0 "4bf3420c_3043_4139_ae11ffc2c8ed2166" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_C4DC04374D2941acACD9EADFBE8C7A4E : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 950 1 0 "ce8b47c2_813c_4002_896ed238fcbb7078" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_F5305DC25C01444391B4A9F48D95D55D ;
err.Clear();
// }} ""
// {{ 951 1 0 "66eec410_cfdc_4e68_b2dc61605a026a5b" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Worklist.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Worklist.RemoveFields();
// }} ""
// {{ 952 1 0 "564f14c9_a8bf_4c25_9fffc3f60f83fcaf" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Worklist.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
t_hdlFile_Worklist.AddField("Volume_ToAspirate", t_hdlFile_Worklist_VolumeToAspirate, hslFloat);
t_hdlFile_Worklist.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
if( 0 == t_hdlFile_Worklist.Open(i_str_WorklistFilePath + " " + "Sheet1$", hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_WorklistFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 953 1 0 "0abff16e_38a7_4c1f_9b330a222dab3a65" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Worklist.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 954 1 0 "9ed90fdf_8cbf_425c_8c3b8f15d836cf88" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Worklist.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Worklist.RemoveFields();
// }} ""
// {{ 955 1 0 "f7d739c0_8b6a_4911_bbc040c24340bacd" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Worklist.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
t_hdlFile_Worklist.AddField("Volume_ToAspirate", t_hdlFile_Worklist_VolumeToAspirate, hslFloat);
t_hdlFile_Worklist.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
if( 0 == t_hdlFile_Worklist.Open(i_str_WorklistFilePath + " " + "Sheet1$", hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_WorklistFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 956 1 0 "243da40b_9cfd_455d_b2d4cceec347db02" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_UseVolumePerPoolFromWorklist = ASWGLOBAL::BOOL::FALSE;
// }} ""
// {{ 957 1 0 "ce8b47c2_813c_4002_896ed238fcbb7078" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_F5305DC25C01444391B4A9F48D95D55D : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{{ 958 1 0 "842b8110_cf78_4cea_a76c1de3e19d4621" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_DATA_IntegratedAbortHandler(l_strFunctionName, Translate("Normalization and Pooling Controller cannot open input worklist. Please review file structure and content, possibly required columns or entries are missing. System will abort"));
// }} ""
// {{{ 959 1 0 "89b7e612_ca3e_4656_99c486abe27a5bfb" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::FALSE);
// }} ""
// {{ 960 1 0 "ce8b47c2_813c_4002_896ed238fcbb7078" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 961 1 0 "4bf3420c_3043_4139_ae11ffc2c8ed2166" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 962 1 0 "96cdc8bf_f497_4175_bfdd4207c3fe2cb1" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 963 1 0 "3adaa0b1_30b7_48f7_a92845f8f47e2a58" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension != "csv")
{
// }} ""
// {{ 964 1 0 "f35e6f09_9483_4fb1_b24740d921ad5904" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension != "xls")
{
// }} ""
// {{{ 965 1 0 "44f49caa_cdc8_4d98_b52dcb87e388c0fd" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_DATA_IntegratedAbortHandler(l_strFunctionName, Translate("Normalization and Pooling Controller cannot open input worklist (only .xls and .csv file formats are accepted). System will abort"));
// }} ""
// {{{ 966 1 0 "b673b458_7848_4520_ba1fd746e25a7c12" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::FALSE);
// }} ""
// {{ 967 1 0 "f35e6f09_9483_4fb1_b24740d921ad5904" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 968 1 0 "3adaa0b1_30b7_48f7_a92845f8f47e2a58" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 969 1 0 "cb66797b_9fef_433a_8ccd305871172ca4" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace4(Translate(" l_bln_UseVolumePerPoolFromWorklist: "), l_bln_UseVolumePerPoolFromWorklist, Translate(""), Translate(""));
// }} ""
// {{{ 970 1 0 "bbbe05d2_3395_4571_9c42228d2790ffff" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_PoolingFileOpen(t_str_TemplateFilePath, Translate(""), 2, 2, t_hdlFile_Template);
// }} ""
// {{ 971 1 0 "5ed58231_af08_4320_9c9afc9c71871db3" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter3 = 0;
while (
   (t_hdlFile_Worklist.Eof() == 0)
)
{
loopCounter3 = loopCounter3 + 1;
// }} ""
// {{ 972 1 0 "37cb2d3a_d55f_498c_81b04a0fae86edb5" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Worklist.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 973 1 0 "15cbac08_7ef6_4371_a5187dba18c70568" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = Translate("Processed");
// }} ""
// {{ 974 1 0 "884aa789_8859_4c52_b732ba90760ac4af" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_UseVolumePerPoolFromWorklist == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{ 975 1 0 "6cf34a64_12fe_4068_bfc828797f73346b" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_VolumeToAspirate = 0.0;
// }} ""
// {{ 976 1 0 "884aa789_8859_4c52_b732ba90760ac4af" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 977 1 0 "1efd92ea_f647_49be_a55e2eb39f1b5a77" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_VolumePerPool = 0.0;
// }} ""
// {{ 978 1 0 "884aa789_8859_4c52_b732ba90760ac4af" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 979 1 0 "e4b89bb7_7675_4f3f_88bdd15ab71072bc" "{B31F3537-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Template.WriteRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1473380096, MECC::IDS::stepNameFileWrite, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 980 1 0 "85ee5073_b411_45e1_91149f30e45f5107" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_int_NumberOfSamples_Source = loopCounter3;
// }} ""
// {{ 981 1 0 "5ed58231_af08_4320_9c9afc9c71871db3" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 982 1 0 "fabd9eb3_6f5d_4806_958c3c004d478a3f" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Template.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Template.RemoveFields();
// }} ""
// {{ 983 1 0 "c43ac8d0_ca9e_4a34_9c59223ae2beeda8" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Worklist.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Worklist.RemoveFields();
// }} ""
// {{{ 984 1 0 "3eea2689_b46a_471d_94302eb55cff98e3" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_PoolingFileOpen(t_str_OutputFilePath, Translate(""), 2, 2, t_hdlFile_Output);
// }} ""
// {{ 985 1 0 "5d77de8b_f15c_49c2_9718a9c8c63f6251" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Output.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Output.RemoveFields();
// }} ""
// {{{ 986 1 0 "771e56d8_9c4d_4db2_b1be83b8329f0507" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_PoolingFileOpen(t_str_ExcludedSamplesFilePath, Translate(""), 2, 2, t_hdlFile_Excluded);
// }} ""
// {{ 987 1 0 "688e6575_8343_4c1b_8edea7bc614d918b" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Excluded.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Excluded.RemoveFields();
// }} ""
// {{ 988 1 0 "86698d20_60e9_46a6_a62b91b78dbaa1c1" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 989 1 0 "14b41fd3_2d8e_496e_9ac4ad52df0dc515" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 990 1 0 "b01daf91_0575_45e5_b8f122cc17666f17" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_str_MultipleUsedSampleSourcePositions = Translate("");
// }} ""
// {{ 991 1 0 "c9ad4101_46f5_4e5d_b86506d353bfaa8f" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_str_SampleSourcePosition.SetSize(0);
// }} ""
// {{ 992 1 0 "0584ac5d_6606_4569_be87e2fcf9c40e1a" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_str_MultipleUsedSampleSourcePositions.SetSize(0);
// }} ""
// {{ 993 1 0 "a3edc866_9e66_4175_b6eea310298a9e98" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension == "csv")
{
// }} ""
// {{ 994 1 0 "486039eb_2996_4320_adfc842c40371e61" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_01A43549FDA34ab694B1841C04C8A1A6 ;
err.Clear();
// }} ""
// {{ 995 1 0 "5f270aee_71f3_410b_9a8a1d11db964ba3" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Worklist.SetDelimiter(";");
if( 0 == t_hdlFile_Worklist.Open(i_str_WorklistFilePath, hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_WorklistFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 996 1 0 "486039eb_2996_4320_adfc842c40371e61" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_01A43549FDA34ab694B1841C04C8A1A6 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{{ 997 1 0 "4f2629be_0e36_465f_bce8eacfb415bf3e" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_DATA_IntegratedAbortHandler(l_strFunctionName, Translate("Normalization and Pooling Controller cannot open input worklist. Please review file structure and content, possibly required columns or entries are missing. System will abort"));
// }} ""
// {{{ 998 1 0 "e276b4f8_ea57_434e_88f757a63da32342" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::FALSE);
// }} ""
// {{ 999 1 0 "486039eb_2996_4320_adfc842c40371e61" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 1000 1 0 "a3edc866_9e66_4175_b6eea310298a9e98" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1001 1 0 "6b1e6ff1_d97b_4b7b_adc11b43e77f8308" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension == "xls")
{
// }} ""
// {{ 1002 1 0 "ef7976b6_5948_4333_beff8773556aa80c" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_7A13918F2AF44500B1E8B69DBEA6AAFC ;
err.Clear();
// }} ""
// {{ 1003 1 0 "ea80fb50_5a08_427e_b3f852147d526580" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
if( 0 == t_hdlFile_Worklist.Open(i_str_WorklistFilePath + " " + "Sheet1$", hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_WorklistFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 1004 1 0 "ef7976b6_5948_4333_beff8773556aa80c" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_7A13918F2AF44500B1E8B69DBEA6AAFC : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{{ 1005 1 0 "1e9fce66_25b5_4a36_b639499e2197d4d8" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_DATA_IntegratedAbortHandler(l_strFunctionName, Translate("Normalization and Pooling Controller cannot open input worklist. Please review file structure and content, possibly required columns or entries are missing. System will abort"));
// }} ""
// {{{ 1006 1 0 "7622f428_9507_4466_8897bd24269889a0" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::FALSE);
// }} ""
// {{ 1007 1 0 "ef7976b6_5948_4333_beff8773556aa80c" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 1008 1 0 "6b1e6ff1_d97b_4b7b_adc11b43e77f8308" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1009 1 0 "d9738180_4a97_49a2_a0dce3bbe90ab89c" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter3 = 0;
while (
   (t_hdlFile_Worklist.Eof() == 0)
)
{
loopCounter3 = loopCounter3 + 1;
// }} ""
// {{ 1010 1 0 "5b41c9c2_fa0e_44c9_8f6161d3f97ec608" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Worklist.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 1011 1 0 "9aa3837f_2fcd_47ab_89627c9054b7f5dc" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_str_SampleSourcePosition.AddAsLast(t_hdlFile_Worklist_Sample_Position);
// }} ""
// {{ 1012 1 0 "d9738180_4a97_49a2_a0dce3bbe90ab89c" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 1013 1 0 "b6b5dca4_1676_4b00_a48aca02d1ab0b2c" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Worklist.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Worklist.RemoveFields();
// }} ""
// {{ 1014 1 0 "5b5317b0_9b03_4a6d_a2205bc849bd9f9e" "{DB5A2B39-67F2-4a78-A78F-DAF3FB056366}"
l_arr_str_SampleSourcePosition_copy=l_arr_str_SampleSourcePosition;
// }} ""
// {{{ 1015 1 0 "06cc5b54_824a_465b_8e2f0caf2113d4fe" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ARRAYTOOLS::get_distinct_from_array(l_arr_str_SampleSourcePosition, l_arr_str_SampleSourcePosition_distinct);
// }} ""
// {{ 1016 1 0 "1013b8e9_a2bc_444c_a011a16c4a47836f" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
l_int_NumberOfSamples=l_arr_str_SampleSourcePosition_distinct.GetSize();
// }} ""
// {{ 1017 1 0 "60225e98_86da_4dd4_a453c3092f9e7feb" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(loopCounter3 = 0; loopCounter3 < l_int_NumberOfSamples;)
{
loopCounter3 = loopCounter3 + 1;
// }} ""
// {{{ 1018 1 0 "6d407e9c_a876_42de_862117802153f33a" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ARRAYTOOLS::ArrayVLookUp(l_arr_str_SampleSourcePosition, l_arr_str_SampleSourcePosition_copy, l_arr_str_SampleSourcePosition_distinct.ElementAt( loopCounter3 -1), l_arr_str_Temp);
// }} ""
// {{ 1019 1 0 "6fc509d8_d52f_45b9_b7175cf49851251d" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
l_int_NumberOfUseThisSample=l_arr_str_Temp.GetSize();
// }} ""
// {{ 1020 1 0 "db22361c_aacb_4998_a1110bbf6022cca3" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfUseThisSample > 1)
{
// }} ""
// {{ 1021 1 0 "b786327e_f9a0_4c23_a46af57d50d3d6c5" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_str_MultipleUsedSampleSourcePositions.AddAsLast(l_arr_str_SampleSourcePosition_distinct.ElementAt( loopCounter3 -1));
// }} ""
// {{ 1022 1 0 "f747dbc2_b6d3_4183_bf2560273217f893" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_MultipleUsedSampleSourcePositions == "")
{
// }} ""
// {{ 1023 1 0 "0e0d0a98_3e99_47ba_b530033603ff0754" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_str_MultipleUsedSampleSourcePositions = l_arr_str_SampleSourcePosition_distinct.ElementAt( loopCounter3 -1);
// }} ""
// {{ 1024 1 0 "f747dbc2_b6d3_4183_bf2560273217f893" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 1025 1 0 "fb84181e_dcfb_4937_bb01a9e3d7fde8ac" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_MultipleUsedSampleSourcePositions = StrConcat4(l_str_MultipleUsedSampleSourcePositions, Translate(", "), l_arr_str_SampleSourcePosition_distinct.ElementAt( loopCounter3 -1), Translate(""));
// }} ""
// {{ 1026 1 0 "f747dbc2_b6d3_4183_bf2560273217f893" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1027 1 0 "db22361c_aacb_4998_a1110bbf6022cca3" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1028 1 0 "60225e98_86da_4dd4_a453c3092f9e7feb" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 1029 1 0 "0686a4c2_3e33_4922_8dde8b20c4fd2202" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
l_int_NumberOfSamplesUsedMultipleTimes=l_arr_str_MultipleUsedSampleSourcePositions.GetSize();
// }} ""
// {{ 1030 1 0 "68660322_4204_4ed3_94380bc1d5ddc1dd" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfSamplesUsedMultipleTimes > 0)
{
// }} ""
// {{{ 1031 1 0 "0152417a_4d01_4e3b_ad58fc3bb2f45fbe" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceArray(TRACE_LEVEL_DEBUG, Translate("l_arr_str_MultipleUsedSampleSourcePositions: "), l_arr_str_MultipleUsedSampleSourcePositions);
// }} ""
// {{ 1032 1 0 "68660322_4204_4ed3_94380bc1d5ddc1dd" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1033 1 0 "14b41fd3_2d8e_496e_9ac4ad52df0dc515" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1034 1 0 "ec13b4f1_e6c8_48bd_ab96aa65d2f7c152" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 1035 1 0 "05edf613_5bba_4178_a4d3b5e89efbcf0a" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_GetPoolInfo(t_str_TemplateFilePath, Translate(""), t_intTraceLevel, t_hdlFile_Template, 2, l_arr_str_Pool_Ids, l_arr_int_NumberOfSamplesPerPool, l_arr_Dummy, l_arr_Dummy, l_arr_flt_VolumePerPool);
// }} ""
// {{ 1036 1 0 "6da9782e_0bcf_46b6_87fda70d7c692166" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
l_int_NumberOfPools=l_arr_str_Pool_Ids.GetSize();
// }} ""
// {{ 1037 1 0 "ec13b4f1_e6c8_48bd_ab96aa65d2f7c152" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1038 1 0 "41b96e9d_177a_4852_93fc8f691dfeaba1" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_Repeat_Analysis = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{{ 1039 1 0 "5302e6e8_d468_49c1_aa781ed97cea1dc6" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_PoolingFileOpen(t_str_ExcludedSamplesFilePath, Translate(""), 3, 2, t_hdlFile_Excluded);
// }} ""
// {{ 1040 1 0 "6cf966b5_f7c3_4597_9f3740bdfae82315" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_int_TotalNumberOfSamples_Excluded = 0;
// }} ""
// {{ 1041 1 0 "9bf5f6bd_4579_46f2_918e36dceec2cff8" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ExcludeSample = ASWGLOBAL::BOOL::FALSE;
// }} ""
// {{ 1042 1 0 "1b7d2b49_fcd0_4393_85a40ca4839da068" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
l_int_Counter_RepeatAnalysis = 0;
while (l_bln_Repeat_Analysis == ASWGLOBAL::BOOL::TRUE)
{
l_int_Counter_RepeatAnalysis = l_int_Counter_RepeatAnalysis + 1;
// }} ""
// {{{ 1043 1 0 "83442288_19a7_4377_b152105ad336c255" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_bln_FileExists = HSLExtensions::File::Exists(t_str_OutputFilePath);
// }} ""
// {{ 1044 1 0 "c693312e_b8e4_42b2_bdad86b4c5bfc9f3" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_FileExists == ASWGLOBAL::BOOL::FALSE)
{
// }} ""
// {{{ 1045 1 0 "34c3577e_8a67_463c_bc85680583e41cac" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_PoolingFileOpen(t_str_OutputFilePath, Translate(""), 2, 2, t_hdlFile_Output);
// }} ""
// {{ 1046 1 0 "66caeffe_4ae0_40a7_9f6484c5d9d39fa7" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Output.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Output.RemoveFields();
// }} ""
// {{ 1047 1 0 "c693312e_b8e4_42b2_bdad86b4c5bfc9f3" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 1048 1 0 "0a57aa2c_41bf_49b3_bf96bfb0609bba06" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_PoolingFileOpen(t_str_OutputFilePath, Translate(""), 3, 2, t_hdlFile_Output);
// }} ""
// {{ 1049 1 0 "617dd83e_d113_48d4_a9c82107317efc9d" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_flt_TotalVolumePerPool.SetSize(0);
// }} ""
// {{ 1050 1 0 "f075597a_fbb8_441c_9da57ea07581761b" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_flt_TotalVolumePerSample.SetSize(0);
// }} ""
// {{ 1051 1 0 "697583b6_3e38_4f1f_b509b59841a3c997" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_flt_TotalVolumePerSample.SetSize(l_int_NumberOfSamplesUsedMultipleTimes);
// }} ""
// {{ 1052 1 0 "47026fad_d0a9_48e4_9b86fd11dd4d0a73" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_int_TotalNumberOfUsePerSample.SetSize(0);
// }} ""
// {{ 1053 1 0 "76e5f6f5_2b7e_40f6_b6384598f31c16b9" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_int_TotalNumberOfUsePerSample.SetSize(l_int_NumberOfSamplesUsedMultipleTimes);
// }} ""
// {{ 1054 1 0 "c196ca5d_36ed_4f5a_a9d792cbaf7b8e84" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
o_arr_flt_Volumes_Pools.SetSize(0);
// }} ""
// {{ 1055 1 0 "56e05a71_89f2_4456_b6b83f33481998db" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
o_arr_str_PostionIDsPools.SetSize(0);
// }} ""
// {{ 1056 1 0 "d7b9796d_a760_44de_8fbf720aa0883efc" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_flt_Volumes_Sample.SetSize(0);
// }} ""
// {{ 1057 1 0 "00039859_fd0b_4994_8c52d0e9b4e4bc61" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_int_NumberOfSamples_Excluded = 0;
// }} ""
// {{{ 1058 1 0 "42bb1481_2fec_4554_b2acacf9ce9b2a49" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqRemoveAll(o_seq_Asp_Samples);
// }} ""
// {{{ 1059 1 0 "6ab7aed7_b486_48ab_8c583cdb3f7ea73a" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqRemoveAll(o_seq_Disp_Samples);
// }} ""
// {{ 1060 1 0 "ac3c7e81_3a43_486e_83875d18802eabfa" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(l_int_Counter_Pool = 0; l_int_Counter_Pool < l_int_NumberOfPools;)
{
l_int_Counter_Pool = l_int_Counter_Pool + 1;
// }} ""
// {{ 1061 1 0 "4c72ca2e_e296_4f06_b8e61842d27e1415" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ExcludePool = ASWGLOBAL::BOOL::FALSE;
// }} ""
// {{ 1062 1 0 "ad707d65_dc3a_4126_ae459b9728c857c5" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_PoolProcessed = ASWGLOBAL::BOOL::FALSE;
// }} ""
// {{ 1063 1 0 "8dfcf804_45b9_4df0_a2c514a39e7fa027" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_VolumePerPool = 0.0;
// }} ""
// {{ 1064 1 0 "2946fd0b_0132_4993_9204473ad07766ec" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
l_str_CurrentPoolId=l_arr_str_Pool_Ids.GetAt(l_int_Counter_Pool-1);
// }} ""
// {{ 1065 1 0 "c6ee8bc1_514c_4b7e_b493618925b7b2a7" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (t_intTraceLevel == TRACE_LEVEL_DEBUG)
{
// }} ""
Trace("*****************************************","");
Trace("------> Pool Id = ",l_str_CurrentPoolId);
Trace("------> Data analysis number: ", l_int_Counter_RepeatAnalysis);
Trace("","");
// {{ 1067 1 0 "c6ee8bc1_514c_4b7e_b493618925b7b2a7" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1068 1 0 "56d79cda_3242_42af_a1104f1732ef97a2" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
l_flt_TotalVolumeCurrentPool=l_arr_flt_VolumePerPool.GetAt(l_int_Counter_Pool-1);
// }} ""
// {{{ 1069 1 0 "880e07b6_6aaa_4c0f_9efe39bb9b9cc1e8" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_LabwareID_Pooling = SeqGetLabwareId(i_seq_Pooling);
// }} ""
// {{{ 1070 1 0 "c1f2be63_1087_4cf1_834361863fa64a95" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_LabwareID_SamplePlate = SeqGetLabwareId(i_seq_SourceSamplePlate);
// }} ""
// {{ 1071 1 0 "0b218c2b_2e42_49f5_b6cf08be405f2266" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1072 1 0 "9bec3035_16b9_4c26_8c7ff4ecba32549d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_UseVolumePerPoolFromWorklist == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{ 1073 1 0 "0f8ef3d4_3528_4cb0_9d85bc9ef5adc4ac" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 1074 1 0 "f1ce3a03_6a26_429e_91236952dbc3077b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_TotalVolumeCurrentPool > i_flt_MaximumVolumePerContainer)
{
// }} ""
// {{ 1075 1 0 "44a351f4_5b77_4f82_9d43fff467ad80c4" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ExcludePool = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 1076 1 0 "49abc8af_e979_4ac8_8cf32976bf968593" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_str_ExcludePool = Translate("Excluded - Total Volume of Pool exceeds maximum labware capacity");
// }} ""
// {{ 1077 1 0 "f1ce3a03_6a26_429e_91236952dbc3077b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1078 1 0 "9bec3035_16b9_4c26_8c7ff4ecba32549d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1079 1 0 "0b218c2b_2e42_49f5_b6cf08be405f2266" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1080 1 0 "a0d6dfcd_05c6_40fe_8d65f3d01f74408d" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_flt_TotalVolumePerPool.SetSize(l_int_NumberOfPools);
// }} ""
l_strSQL_Sentence1 = StrConcat12("Select * from [Sheet1$] where [Target_Well] = '",l_str_CurrentPoolId,"' and [SampleStatus] = 'Processed'","","","","","","","","","");
// {{{ 1082 1 0 "fd83670f_1471_45af_a91acec1d172aad5" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_DEBUG, Translate("l_strSQL_Sentence1: "), l_strSQL_Sentence1);
// }} ""
// {{{ 1083 1 0 "a3a05283_d799_4adc_93912d3f95614746" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_DEBUG, Translate("t_str_TemplateFilePath: "), t_str_TemplateFilePath);
// }} ""
// {{{ 1084 1 0 "6666f891_7686_4cba_b579bb53f3d9503a" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
l_int_ReturnValue = _GetPoolInfo(t_str_TemplateFilePath, l_strSQL_Sentence1, ASWGLOBAL::BOOL::FALSE, t_hdlFile_Template, 2, l_arr_str_Pool_Ids_current, l_arr_int_NumberOfSamplesPerPool_current, l_arr_Dummy, l_arr_Dummy, l_arr_flt_VolumePerPool_current);
// }} ""
// {{ 1085 1 0 "03ca1b42_3061_4d61_b8e801da671974d7" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_ReturnValue == -2)
{
// }} ""
// {{ 1086 1 0 "7bd43299_7db3_40bb_8c94cf6a0ffaef9c" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ExcludePool = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 1087 1 0 "b7dcbfcc_afbb_4fe0_82f7488ce52e7673" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_str_ExcludePool = Translate("Excluded - Total Volume in Pool not equal.");
// }} ""
// {{ 1088 1 0 "03ca1b42_3061_4d61_b8e801da671974d7" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 1089 1 0 "e654c3da_6b6d_4f49_a33fb751f341b13b" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_PoolingFileOpen(t_str_TemplateFilePath, l_strSQL_Sentence1, 1, 2, t_hdlFile_Template);
// }} ""
// {{ 1090 1 0 "94c1e971_b8f9_46aa_89984f962ae240f9" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter1 = 0;
while (
   (t_hdlFile_Template.Eof() == 0)
)
{
loopCounter1 = loopCounter1 + 1;
// }} ""
// {{ 1091 1 0 "47d051db_f6ef_4207_9f5fe4035526e9be" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Template.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 1092 1 0 "3a404496_7550_4a1f_8d495fe8dd8fc394" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (t_intTraceLevel == TRACE_LEVEL_DEBUG)
{
// }} ""
// {{{ 1093 1 0 "a311329b_acdc_4004_b1d6f5c1b729571d" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_10(t_intTraceLevel, Translate(" t_hdlFile_Worklist_Sample_ID: "), t_hdlFile_Worklist_Sample_ID, Translate("  t_hdlFile_Worklist_Sample_Position: "), t_hdlFile_Worklist_Sample_Position, Translate("  t_hdlFile_Worklist_Target_Well: "), t_hdlFile_Worklist_Target_Well, Translate(" t_hdlFile_Worklist_VolumeToAspirate: "), t_hdlFile_Worklist_VolumeToAspirate, Translate("  t_hdlFile_Worklist_VolumePerPool: "), t_hdlFile_Worklist_VolumePerPool);
// }} ""
// {{ 1094 1 0 "3a404496_7550_4a1f_8d495fe8dd8fc394" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1095 1 0 "216644b7_6a76_4e7b_a8fa516d83d91fcc" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_Volume_SampleAspirate = 0.0;
// }} ""
// {{ 1096 1 0 "4c84e0c4_9fa6_4ec0_a7471310ba05fcac" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_Volume_Total = 0.0;
// }} ""
// {{ 1097 1 0 "1fb6fbc8_e9d6_4c4e_99d783aef61fdb77" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_UseVolumePerPoolFromWorklist == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{ 1098 1 0 "5ecc8f02_e694_4bbe_93a9832fa766f9c1" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
l_flt_Volume_SampleAspirate = l_arr_flt_VolumePerPool_current.ElementAt( 1 -1) / (l_arr_int_NumberOfSamplesPerPool_current.ElementAt( 1 -1) * 1.0);
// }} ""
// {{ 1099 1 0 "1fb6fbc8_e9d6_4c4e_99d783aef61fdb77" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1100 1 0 "d81b8c02_2cd2_4071_ab59d38492570ad3" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_Volume_SampleAspirate = t_hdlFile_Worklist_VolumeToAspirate;
// }} ""
// {{ 1101 1 0 "1fb6fbc8_e9d6_4c4e_99d783aef61fdb77" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1102 1 0 "005095e4_1a6e_4cb0_a5f6534e1f1da343" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_VolumeToAspirate = l_flt_Volume_SampleAspirate;
// }} ""
// {{ 1103 1 0 "e8f5df86_6698_4f64_bd85faca2e34cd7f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_ExcludePool == ASWGLOBAL::BOOL::FALSE)
{
// }} ""
// {{ 1104 1 0 "276a817c_5896_42ea_86384280b6ea5001" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_Volume_SampleAspirate >= l_flt_Volume_MinimumToPipette)
{
// }} ""
// {{ 1105 1 0 "627a3582_c118_440f_aa9ff5d43bf289c0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_Volume_SampleAspirate <= t_hdlFile_Worklist_OriginalSampleVolume)
{
// }} ""
// {{ 1106 1 0 "998c100c_5f24_453e_bcf1a2d120bbdd1f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_UseVolumePerPoolFromWorklist == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{ 1107 1 0 "8f2ef1d8_e74e_4171_ace72fe2b4e5b959" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_VolumePerPool = l_arr_flt_VolumePerPool_current.ElementAt( 1 -1);
// }} ""
// {{ 1108 1 0 "998c100c_5f24_453e_bcf1a2d120bbdd1f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1109 1 0 "07b35d94_5352_4407_a1e55211e741545f" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
l_flt_VolumePerPool=l_arr_flt_TotalVolumePerPool.GetAt(l_int_Counter_Pool-1);
// }} ""
// {{ 1110 1 0 "cd07685f_1151_4d70_8731c4b6ee25fc3e" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
l_flt_VolumePerPool = l_flt_VolumePerPool + l_flt_Volume_SampleAspirate;
// }} ""
// {{ 1111 1 0 "998c100c_5f24_453e_bcf1a2d120bbdd1f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1112 1 0 "ffcd54c6_62a1_4eba_adce2f206c8b9649" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_VolumePerPool <= i_flt_MaximumVolumePerContainer)
{
// }} ""
// {{ 1113 1 0 "25771bb8_0fc8_4261_8c2d14ba980b90e4" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ExcludeSample = ASWGLOBAL::BOOL::FALSE;
// }} ""
// {{ 1114 1 0 "dfcc64b8_1f04_42a8_b7ee430817f9317d" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1115 1 0 "05c20945_f861_4511_96ac8379b5dac64a" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(loopCounter2 = 0; loopCounter2 < l_int_NumberOfSamplesUsedMultipleTimes;)
{
loopCounter2 = loopCounter2 + 1;
// }} ""
// {{ 1116 1 0 "d6ce92fc_e932_43e3_b25de1c20398388e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (t_hdlFile_Worklist_Sample_Position == l_arr_str_MultipleUsedSampleSourcePositions.ElementAt( loopCounter2 -1))
{
// }} ""
// {{ 1117 1 0 "03f1d9df_9e47_4d2d_8ef94a29aa412109" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
l_flt_TotalVolumePerSample=l_arr_flt_TotalVolumePerSample.GetAt(loopCounter2-1);
// }} ""
// {{ 1118 1 0 "41a7894b_bcad_4ef1_97559de02e74d92e" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
l_flt_TotalVolumePerSample = l_flt_TotalVolumePerSample + l_flt_Volume_SampleAspirate;
// }} ""
// {{ 1119 1 0 "5caadf61_5476_40a3_b6e84e94d2dc07f8" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_TotalVolumePerSample <= t_hdlFile_Worklist_OriginalSampleVolume)
{
// }} ""
// {{ 1120 1 0 "3965d876_f877_4def_932a4546cf04a53f" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_flt_TotalVolumePerSample.SetAt(loopCounter2-1, l_flt_TotalVolumePerSample);
// }} ""
// {{ 1121 1 0 "5caadf61_5476_40a3_b6e84e94d2dc07f8" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1122 1 0 "936dfa39_4371_4a6c_af3292c1d1e50ecb" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = Translate("Excluded - Sample used multiple times and the original sample volume is not sufficient for all pools");
// }} ""
// {{ 1123 1 0 "30cfa876_e002_49a9_b3d5f5cbb00c8733" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ExcludeSample = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 1124 1 0 "5caadf61_5476_40a3_b6e84e94d2dc07f8" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1125 1 0 "a676786f_4afa_43a5_9f9fd7946d474e27" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 1126 1 0 "d6ce92fc_e932_43e3_b25de1c20398388e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1127 1 0 "05c20945_f861_4511_96ac8379b5dac64a" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 1128 1 0 "dfcc64b8_1f04_42a8_b7ee430817f9317d" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1129 1 0 "b9a06caf_a87b_4125_bd79c123cba05710" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_ExcludeSample == ASWGLOBAL::BOOL::FALSE)
{
// }} ""
// {{ 1130 1 0 "229bc8cb_d4e6_4831_bfb07d19f13b6b3c" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_flt_TotalVolumePerPool.SetAt(l_int_Counter_Pool-1, l_flt_VolumePerPool);
// }} ""
// {{ 1131 1 0 "00f9c0f6_28d8_4732_bc6ef980dc70f15f" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = Translate("Processed");
// }} ""
// {{ 1132 1 0 "7fc9ac10_c22c_48c5_974397bc076ec159" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 1133 1 0 "2c094023_487d_4499_b2d5cfae70471a16" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqAdd(o_seq_Asp_Samples, l_str_LabwareID_SamplePlate, t_hdlFile_Worklist_Sample_Position);
// }} ""
// {{ 1134 1 0 "ba113180_bf17_489d_a4f3ab99e8f80cd2" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 1135 1 0 "9c537812_d44f_4c81_b09185c0f73e57ac" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqAdd(o_seq_Disp_Samples, l_str_LabwareID_Pooling, t_hdlFile_Worklist_Target_Well);
// }} ""
// {{ 1136 1 0 "bac55528_3f36_48b4_b4ca94010815c083" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 1137 1 0 "381603c8_1ac9_4c37_a0dcb4499440b19f" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_flt_Volumes_Sample.AddAsLast(l_flt_Volume_SampleAspirate);
// }} ""
// {{ 1138 1 0 "546a1b3a_a1a0_4f93_9ba5ddb8e1d25ada" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_PoolProcessed = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 1139 1 0 "b9a06caf_a87b_4125_bd79c123cba05710" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1140 1 0 "ffcd54c6_62a1_4eba_adce2f206c8b9649" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1141 1 0 "8f2d95cf_de43_442a_af10cc2b6c78ca1e" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = Translate("Excluded - Maximum volume per pool has been exceeded");
// }} ""
// {{ 1142 1 0 "b7065e64_43ab_4afa_8c15a0a1a30bf73a" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ExcludeSample = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 1143 1 0 "ffcd54c6_62a1_4eba_adce2f206c8b9649" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1144 1 0 "627a3582_c118_440f_aa9ff5d43bf289c0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1145 1 0 "ae47aeef_aaa7_4901_a27c87940d8da512" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = Translate("Excluded - Not enough volume to aspirate sample");
// }} ""
// {{ 1146 1 0 "5ed4dd75_5cda_4f60_9cb58d5c321dee93" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ExcludeSample = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 1147 1 0 "627a3582_c118_440f_aa9ff5d43bf289c0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1148 1 0 "276a817c_5896_42ea_86384280b6ea5001" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1149 1 0 "65519be8_6d86_4de3_9913760a2816c78d" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = Translate("Excluded - Sample volume to aspirate below minimum allowed");
// }} ""
// {{ 1150 1 0 "9f881304_ef06_4fb2_9a7f75bb1f5fae76" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ExcludeSample = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 1151 1 0 "276a817c_5896_42ea_86384280b6ea5001" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1152 1 0 "e8f5df86_6698_4f64_bd85faca2e34cd7f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1153 1 0 "5663c8a1_25e9_4642_88d02a4fec32a94d" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ExcludeSample = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 1154 1 0 "bcd2e258_a092_4d8e_981d98d640450fbf" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = l_str_ExcludePool;
// }} ""
// {{ 1155 1 0 "e8f5df86_6698_4f64_bd85faca2e34cd7f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1156 1 0 "aff56988_e520_46a5_9795694f6c618f75" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_ExcludeSample == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{ 1157 1 0 "ada37712_76f8_4b97_8ade0c1da4b32f88" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
l_int_NumberOfSamples_Excluded = l_int_NumberOfSamples_Excluded + 1;
// }} ""
// {{ 1158 1 0 "ddc6b026_8a53_4f60_b1090631346642dc" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
l_int_TotalNumberOfSamples_Excluded = l_int_TotalNumberOfSamples_Excluded + 1;
// }} ""
// {{ 1159 1 0 "299d3e7b_3271_417f_b0691d5a379365dc" "{B31F3537-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Excluded.WriteRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1473380096, MECC::IDS::stepNameFileWrite, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 1160 1 0 "aff56988_e520_46a5_9795694f6c618f75" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1161 1 0 "0f097902_67d8_4694_9957c32601555731" "{B31F3537-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Output.WriteRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1473380096, MECC::IDS::stepNameFileWrite, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 1162 1 0 "aff56988_e520_46a5_9795694f6c618f75" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1163 1 0 "94c1e971_b8f9_46aa_89984f962ae240f9" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 1164 1 0 "ad64a3f3_9ae5_438b_8f8fd6dd750d9951" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_PoolProcessed == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{ 1165 1 0 "6838f2a7_2a52_4414_868849fb4ab65ccb" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
o_arr_flt_Volumes_Pools.AddAsLast(l_arr_flt_TotalVolumePerPool.ElementAt( l_int_Counter_Pool -1));
// }} ""
// {{ 1166 1 0 "648c763d_c609_4dba_bd8111ea5e0a2dab" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
o_arr_str_PostionIDsPools.AddAsLast(t_hdlFile_Worklist_Target_Well);
// }} ""
// {{ 1167 1 0 "ad64a3f3_9ae5_438b_8f8fd6dd750d9951" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1168 1 0 "3969cb0f_4498_469a_b44ef7afcf946dcd" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (t_intTraceLevel == TRACE_LEVEL_DEBUG)
{
// }} ""
// {{{ 1169 1 0 "60e54e1e_20bf_4aee_a263f1cf6d39b97e" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
Util2::Debug::TraceArray_3(Translate("Well / Number Of Samples / Total Volume per Pool: "), l_arr_str_Pool_Ids_current, l_arr_int_NumberOfSamplesPerPool_current, l_arr_flt_VolumePerPool_current);
// }} ""
// {{ 1170 1 0 "3969cb0f_4498_469a_b44ef7afcf946dcd" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1171 1 0 "8ae9b8c0_9ab5_4953_bded1b17c3a3676f" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Template.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Template.RemoveFields();
// }} ""
// {{ 1172 1 0 "ac3c7e81_3a43_486e_83875d18802eabfa" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 1173 1 0 "f73386c3_0b0b_4de5_aded12a0644c7178" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfSamples_Excluded > 0)
{
// }} ""
// {{ 1174 1 0 "32f80388_2481_440f_94528d1a67d17fea" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_Repeat_Analysis = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 1175 1 0 "11c8b1c9_7216_4971_a7536224404bb85f" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Output.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Output.RemoveFields();
// }} ""
// {{{ 1176 1 0 "2d97d254_5cb9_453f_896f3f541069825a" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLExtensions::File::Delete(t_str_TemplateFilePath);
// }} ""
// {{{ 1177 1 0 "bfb7ddfc_a85e_4656_abd5677630f27440" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLExtensions::File::Copy(t_str_OutputFilePath, t_str_TemplateFilePath, ASWGLOBAL::BOOL::TRUE);
// }} ""
// {{{ 1178 1 0 "38506ac6_9589_4b74_bbe346cf565037c3" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLExtensions::File::Delete(t_str_OutputFilePath);
// }} ""
// {{ 1179 1 0 "f73386c3_0b0b_4de5_aded12a0644c7178" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1180 1 0 "2c94ee3c_b5e0_478c_baa0f643ddf60bbf" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_Repeat_Analysis = ASWGLOBAL::BOOL::FALSE;
// }} ""
// {{ 1181 1 0 "b0410119_0ffa_4226_bca4a927af5da6c5" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Output.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Output.RemoveFields();
// }} ""
// {{ 1182 1 0 "637b0dea_21ad_4a47_af27a164a5ec8a83" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1183 1 0 "5a6dc7b4_805d_4d5f_a0f80b5f1d015ae0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_UseVolumePerPoolFromWorklist == ASWGLOBAL::BOOL::FALSE)
{
// }} ""
// {{ 1184 1 0 "dedb040c_7291_478e_bc6794386f963dd6" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 1185 1 0 "d6f5c0e5_2e52_49b8_873c23fae6b550ef" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
l_int_NumberOfPools=o_arr_str_PostionIDsPools.GetSize();
// }} ""
// {{ 1186 1 0 "26faf1ea_0f5d_4924_9f22e51bbc767166" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(loopCounter5 = 0; loopCounter5 < l_int_NumberOfPools;)
{
loopCounter5 = loopCounter5 + 1;
// }} ""
// {{{ 1187 1 0 "d0a993c8_d189_4014_bbf79381697b718b" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_UpdateRecord(t_str_OutputFilePath, Translate("Sheet1"), Translate("Volume_PerPool"), o_arr_flt_Volumes_Pools.ElementAt( loopCounter5 -1), Translate("Target_Well"), o_arr_str_PostionIDsPools.ElementAt( loopCounter5 -1));
// }} ""
// {{ 1188 1 0 "26faf1ea_0f5d_4924_9f22e51bbc767166" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 1189 1 0 "5a6dc7b4_805d_4d5f_a0f80b5f1d015ae0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1190 1 0 "637b0dea_21ad_4a47_af27a164a5ec8a83" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1191 1 0 "f73386c3_0b0b_4de5_aded12a0644c7178" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1192 1 0 "1b7d2b49_fcd0_4393_85a40ca4839da068" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 1193 1 0 "b16bfe11_f750_465c_a738900df0252e75" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfSamplesUsedMultipleTimes != 0)
{
// }} ""
// {{{ 1194 1 0 "1e708071_b1d3_49f7_8dbb6fb6e28ecbaf" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
Util2::Debug::TraceArray_3(Translate("l_arr_str_MultipleUsedSampleSourcePositions / l_arr_int_TotalNumberOfUsePerSample / l_arr_flt_TotalVolumePerSample"), l_arr_str_MultipleUsedSampleSourcePositions, l_arr_int_TotalNumberOfUsePerSample, l_arr_flt_TotalVolumePerSample);
// }} ""
// {{ 1195 1 0 "b16bfe11_f750_465c_a738900df0252e75" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 1196 1 0 "b1fa9bd4_6e6d_4623_bf66b61c45b1ff71" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLExtensions::File::Delete(t_str_TemplateFilePath);
// }} ""
// {{ 1197 1 0 "6030f404_f971_406a_80c06a7d81725854" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1198 1 0 "c59e435c_e3f7_44a3_925a7c3e464aeaec" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_strTokens.SetSize(0);
// }} ""
Trace("l_int_TotalNumberOfSamples_Excluded:",l_int_TotalNumberOfSamples_Excluded);
// {{ 1200 1 0 "2db120e5_7cfe_498d_bc24aa0f36506567" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_TotalNumberOfSamples_Excluded > 0)
{
// }} ""
// {{{ 1201 1 0 "7bbdfa4c_2488_46e6_af240228650d455d" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_PoolingFileOpen(t_str_OutputFilePath, Translate(""), 3, 2, t_hdlFile_Output);
// }} ""
// {{{ 1202 1 0 "98e50506_521f_4f60_b75165ea82c4f8c0" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_PoolingFileOpen(t_str_ExcludedSamplesFilePath, Translate(""), 1, 2, t_hdlFile_Excluded);
// }} ""
// {{ 1203 1 0 "11a3eadd_f835_46ed_bbfc210d710c84b6" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter3 = 0;
while (
   (t_hdlFile_Excluded.Eof() == 0)
)
{
loopCounter3 = loopCounter3 + 1;
// }} ""
// {{ 1204 1 0 "885535aa_d760_4a90_9d738c63bad0ad99" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Excluded.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 1205 1 0 "b839f49e_0a5a_461d_a4541396b9c721e5" "{B31F3537-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Output.WriteRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1473380096, MECC::IDS::stepNameFileWrite, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 1206 1 0 "11a3eadd_f835_46ed_bbfc210d710c84b6" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 1207 1 0 "f4e92a88_16de_4a3c_ac70ad2964e4bc94" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Excluded.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Excluded.RemoveFields();
// }} ""
// {{ 1208 1 0 "e30d06be_6436_4802_9b7fcffd66c754b5" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Output.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Output.RemoveFields();
// }} ""
// {{{ 1209 1 0 "c9a4b3e2_0cce_47d6_b121e0e6b95362e8" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLExtensions::File::Delete(t_str_ExcludedSamplesFilePath);
// }} ""
// {{ 1210 1 0 "7f17220f_d75b_4a58_861dea39e46993cd" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_TotalNumberOfSamples_Excluded == l_int_NumberOfSamples_Source)
{
// }} ""
// {{{ 1211 1 0 "28b77352_cb03_4826_a6684a7bc25ade40" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Message = StrConcat12(Translate("Number of samples excluded for this run = "), l_int_TotalNumberOfSamples_Excluded, Translate("\n\nALL SAMPLES ARE EXCLUDED. Please review worklist and input parameters "), Translate("\n\nPress RETRY to load a new worklist."), Translate("\nPress CANCEL to abort the run."), Translate(""), Translate(""), Translate(""), Translate(""), Translate(""), Translate(""), Translate(""));
// }} ""
// {{{ 1212 1 0 "803ad346_77ad_44f0_87f6962b0b0f7f96" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
STRTOKENIZE::StrTokenize(l_strFunctionName, Translate("::"), l_arr_strTokens, ASWGLOBAL::BOOL::TRUE);
// }} ""
// {{{ 1213 1 0 "fe769adc_ee0e_458c_ad4e961a1f2ac47b" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_int_ReturnValue = VectorCustomDialogs::MessageDialog(l_arr_strTokens.ElementAt( 3 -1), 3, 5, 0, 0, 0, l_str_Message);
// }} ""
// {{ 1214 1 0 "88b228bc_e94e_4bbc_a8834df088287b4f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_ReturnValue == 4)
{
// }} ""
// {{{ 1215 1 0 "589f7c22_1481_45ae_b78f40e5d4d6258c" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_Display_InputWorklist_Dialog(i_str_WorklistFilePath);
// }} ""
// {{ 1216 1 0 "88b228bc_e94e_4bbc_a8834df088287b4f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1217 1 0 "129e7738_1acf_4f54_960cf90693af809d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_ReturnValue == 2)
{
// }} ""
// {{{ 1218 1 0 "894d9970_fca2_4495_8a6bf9c7f7ac4b75" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::DIALOG::ABORT);
// }} ""
// {{ 1219 1 0 "129e7738_1acf_4f54_960cf90693af809d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1220 1 0 "88b228bc_e94e_4bbc_a8834df088287b4f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1221 1 0 "7f17220f_d75b_4a58_861dea39e46993cd" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1222 1 0 "0c9dee28_c05a_407a_a0778b408a17a9f8" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfSamplesUsedMultipleTimes != 0)
{
// }} ""
// {{ 1223 1 0 "64f21efd_015d_4e4c_b08835e0e56688fb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_UseVolumePerPoolFromWorklist == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{{ 1224 1 0 "f303afe1_c768_488f_8caba90363a4e57d" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Message = StrConcat12(Translate("Number of samples excluded for this run = "), l_int_TotalNumberOfSamples_Excluded, Translate("\n\nATTENTION: Remaining samples in pools with excluded samples will be adjusted to the new number of samples per pool. The total volume of the pool will stay the same!"), Translate("\n\nData has been logged into the following file: "), Translate("\n"), t_str_OutputFilePath, Translate("\n\nPlease note that "), l_int_NumberOfSamplesUsedMultipleTimes, Translate(" samples ("), l_str_MultipleUsedSampleSourcePositions, Translate(") are used multiple times."), Translate(""));
// }} ""
// {{ 1225 1 0 "64f21efd_015d_4e4c_b08835e0e56688fb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 1226 1 0 "884057ea_d8e4_476b_b47c0818cc8c2f35" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Message = StrConcat12(Translate("Number of samples excluded for this run = "), l_int_TotalNumberOfSamples_Excluded, Translate("\n\nATTENTION: The volumes of the remaining samples in pools will stay the same. The total volume of the pool will be adjusted!"), Translate("\n\nData has been logged into the following file: "), Translate("\n"), t_str_OutputFilePath, Translate("\n\nPlease note that "), l_int_NumberOfSamplesUsedMultipleTimes, Translate(" samples ("), l_str_MultipleUsedSampleSourcePositions, Translate(") are used multiple times."), Translate(""));
// }} ""
// {{ 1227 1 0 "64f21efd_015d_4e4c_b08835e0e56688fb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1228 1 0 "0c9dee28_c05a_407a_a0778b408a17a9f8" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1229 1 0 "b782d114_80a6_4fa0_95bf9a2aed581b5e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_UseVolumePerPoolFromWorklist == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{{ 1230 1 0 "28410b9b_87ed_440e_af81c2ee433d6460" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Message = StrConcat12(Translate("Number of samples excluded for this run = "), l_int_TotalNumberOfSamples_Excluded, Translate("\n"), Translate("\n\nATTENTION: Remaining samples in pools with excluded samples will be adjusted to the new number of samples per pool. The total volume of the pool will stay the same!"), Translate("\n\nData has been logged into the following file: "), Translate("\n"), t_str_OutputFilePath, Translate(""), Translate(""), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 1231 1 0 "b782d114_80a6_4fa0_95bf9a2aed581b5e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 1232 1 0 "8a7b9b9d_105e_404f_ae804278ae324264" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Message = StrConcat12(Translate("Number of samples excluded for this run = "), l_int_TotalNumberOfSamples_Excluded, Translate("\n"), Translate("\n\nATTENTION: The volumes of the remaining samples in pools will stay the same. The total volume of the pool will be adjusted!"), Translate("\n\nData has been logged into the following file: "), Translate("\n"), t_str_OutputFilePath, Translate(""), Translate(""), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 1233 1 0 "b782d114_80a6_4fa0_95bf9a2aed581b5e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1234 1 0 "0c9dee28_c05a_407a_a0778b408a17a9f8" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
Trace("l_str_Message:",l_str_Message);
// {{{ 1236 1 0 "4808f091_fdb0_46d6_8364ca25feb356cd" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Message = StrConcat12(l_str_Message, Translate(""), Translate(""), Translate(""), Translate(""), Translate(""), Translate(""), Translate(""), Translate("\n\nPress IGNORE to continue run without excluded samples."), Translate("\nPress RETRY to load a new worklist"), Translate("\nPress ABORT to abort the run"), Translate(""));
// }} ""
// {{ 1237 1 0 "c6ad888a_4db6_4901_99bca7f7bd3185e0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_bln_AllowCostumerIntervention == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{{ 1238 1 0 "fb7ff36b_2ef4_4f87_9baaecfa203ec895" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
STRTOKENIZE::StrTokenize(l_strFunctionName, Translate("::"), l_arr_strTokens, ASWGLOBAL::BOOL::TRUE);
// }} ""
// {{{ 1239 1 0 "795ca935_581c_411c_b8f6a0654c8fdfc6" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_int_ReturnValue = VectorCustomDialogs::MessageDialog(l_arr_strTokens.ElementAt( 3 -1), 3, 7, 0, 0, 0, l_str_Message);
// }} ""
// {{ 1240 1 0 "6e488c42_0b97_440b_913deda44813cfd4" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_ReturnValue == 4)
{
// }} ""
// {{{ 1241 1 0 "8c86b879_1b52_44d2_836510072a3e7ade" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_Display_InputWorklist_Dialog(i_str_WorklistFilePath);
// }} ""
// {{ 1242 1 0 "6e488c42_0b97_440b_913deda44813cfd4" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1243 1 0 "b579f36f_4e1d_4015_9e06bfa1777ec7ed" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_ReturnValue == 5)
{
// }} ""
// {{ 1244 1 0 "49ff8f1e_2a31_48c0_9769a0f85c0588ed" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 1245 1 0 "b579f36f_4e1d_4015_9e06bfa1777ec7ed" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 1246 1 0 "c9f18bfe_f78e_4aed_b231eeaf292f8535" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::DIALOG::ABORT);
// }} ""
// {{ 1247 1 0 "b579f36f_4e1d_4015_9e06bfa1777ec7ed" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1248 1 0 "6e488c42_0b97_440b_913deda44813cfd4" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1249 1 0 "c6ad888a_4db6_4901_99bca7f7bd3185e0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1250 1 0 "7352661d_c2bd_495a_9c328b47257c2c85" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 1251 1 0 "c6ad888a_4db6_4901_99bca7f7bd3185e0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1252 1 0 "7f17220f_d75b_4a58_861dea39e46993cd" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1253 1 0 "2db120e5_7cfe_498d_bc24aa0f36506567" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1254 1 0 "fc567ebd_0d8a_4d51_83757ed2b0d05741" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfSamplesUsedMultipleTimes != 0)
{
// }} ""
// {{{ 1255 1 0 "56b91807_acc7_4b3b_ad02e1c7c0d3f59a" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Message = StrConcat12(Translate("Please note that "), l_int_NumberOfSamplesUsedMultipleTimes, Translate(" samples ("), l_str_MultipleUsedSampleSourcePositions, Translate(") are used multiple times"), Translate(""), Translate(""), Translate(""), Translate(""), Translate("\n\nPress IGNORE to continue run with samples used multiple times."), Translate("\nPress RETRY to load a new worklist."), Translate("\nPress ABORT to abort the run."));
// }} ""
// {{ 1256 1 0 "b74a5d35_da9a_4c77_95767853a2088ab1" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_bln_AllowCostumerIntervention == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{{ 1257 1 0 "29eb7c70_9834_4503_a253b8622cdef9a2" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
STRTOKENIZE::StrTokenize(l_strFunctionName, Translate("::"), l_arr_strTokens, ASWGLOBAL::BOOL::TRUE);
// }} ""
// {{{ 1258 1 0 "326c091d_35c5_48c7_b252bf56c59608a7" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_int_ReturnValue = VectorCustomDialogs::MessageDialog(l_arr_strTokens.ElementAt( 3 -1), 3, 7, 0, 0, 0, l_str_Message);
// }} ""
// {{ 1259 1 0 "ea0f20e0_913b_4f16_8cf025f2af06f53b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_ReturnValue == 4)
{
// }} ""
// {{{ 1260 1 0 "86204f6c_ff15_4dd0_b3cb1237438ce7f6" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_Display_InputWorklist_Dialog(i_str_WorklistFilePath);
// }} ""
// {{ 1261 1 0 "ea0f20e0_913b_4f16_8cf025f2af06f53b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1262 1 0 "862fd0ed_1935_4551_af3184511a0c815c" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_ReturnValue == 5)
{
// }} ""
// {{ 1263 1 0 "cd0a0cb3_7e97_44ae_bb9869bc34331282" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Excluded.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Excluded.RemoveFields();
// }} ""
// {{{ 1264 1 0 "4811df18_cd31_4a49_b58cbd4cb540cb72" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLExtensions::File::Delete(t_str_ExcludedSamplesFilePath);
// }} ""
// {{ 1265 1 0 "ffbc7845_4322_4539_97adea48f66e2eb2" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 1266 1 0 "862fd0ed_1935_4551_af3184511a0c815c" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 1267 1 0 "7b7a2ea2_5174_4bcc_96756fd17b9186a1" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::DIALOG::ABORT);
// }} ""
// {{ 1268 1 0 "862fd0ed_1935_4551_af3184511a0c815c" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1269 1 0 "ea0f20e0_913b_4f16_8cf025f2af06f53b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1270 1 0 "b74a5d35_da9a_4c77_95767853a2088ab1" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1271 1 0 "daa23d97_e70e_48b6_9d822223fa4134e4" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Excluded.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Excluded.RemoveFields();
// }} ""
// {{{ 1272 1 0 "45f8ac48_fd20_4497_8d155ae7b3f51521" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLExtensions::File::Delete(t_str_ExcludedSamplesFilePath);
// }} ""
// {{ 1273 1 0 "df22b839_7ae7_4800_a1f1cabe90b5d4b4" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 1274 1 0 "b74a5d35_da9a_4c77_95767853a2088ab1" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1275 1 0 "fc567ebd_0d8a_4d51_83757ed2b0d05741" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1276 1 0 "4c2b304c_2b79_439b_a42a29f69c0f8d1e" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Excluded.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Excluded.RemoveFields();
// }} ""
// {{{ 1277 1 0 "b3e6f581_3152_4735_a9b966da722fb0fa" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLExtensions::File::Delete(t_str_ExcludedSamplesFilePath);
// }} ""
// {{ 1278 1 0 "413e5df7_90e5_4530_8a1fd93ac4d61f03" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 1279 1 0 "fc567ebd_0d8a_4d51_83757ed2b0d05741" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1280 1 0 "2db120e5_7cfe_498d_bc24aa0f36506567" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1281 1 0 "6030f404_f971_406a_80c06a7d81725854" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1282 1 0 "f1aee5a5_1470_41a2_b613f5a472fd692d" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 1283 1 0 "47310885_b7fb_4cd1_89ec7205ea606be7" "{DB5A2B39-67F2-4a78-A78F-DAF3FB056366}"
o_arr_flt_Volumes_Sample=l_arr_flt_Volumes_Sample;
// }} ""
// {{ 1284 1 0 "93e69a42_045b_4abb_be22d7b37b8104dd" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
o_int_NumberOfPools=o_arr_flt_Volumes_Pools.GetSize();
// }} ""
// {{ 1285 1 0 "74c1f005_e1bc_4bcc_a55f5cc31909f62e" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 1286 1 0 "9c91fbbd_57f2_4822_9fbf26dc44d2d1a0" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_RELEASE, Translate("t_str_OutputFilePath: "), t_str_OutputFilePath);
// }} ""
// {{ 1287 1 0 "0f5f3b67_b1ad_44a1_b16843eb99aaee1f" "{B31F353A-5D80-11d4-A5EB-0050DA737D89}"
o_seq_Asp_Samples.SetCurrentPosition(1);
// }} ""
// {{ 1288 1 0 "29e501b8_cd5b_48eb_bb46c7e5c2935709" "{B31F353A-5D80-11d4-A5EB-0050DA737D89}"
o_seq_Disp_Samples.SetCurrentPosition(1);
// }} ""
// {{{ 1289 1 0 "6d95d8aa_2e37_487c_ad4fc171bad8df16" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceSequence(TRACE_LEVEL_RELEASE, o_seq_Asp_Samples);
// }} ""
// {{{ 1290 1 0 "2fcd0d0c_e7cb_4369_844811fb929110bf" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceSequence(TRACE_LEVEL_RELEASE, o_seq_Disp_Samples);
// }} ""
// {{{ 1291 1 0 "9e82aa40_70ae_4729_a7da905f80c159d1" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceArray(TRACE_LEVEL_RELEASE, Translate("o_arr_flt_Volumes_Sample: "), o_arr_flt_Volumes_Sample);
// }} ""
// {{{ 1292 1 0 "25f1c3a4_5ec0_4d57_947375104266d8ad" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_RELEASE, Translate("o_int_NumberOfPools: "), o_int_NumberOfPools);
// }} ""
// {{{ 1293 1 0 "c3dcb347_3f5e_4a9f_b3d5aead75c371ae" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
Util2::Debug::TraceArray_2(Translate("o_arr_str_PostionIDsPools / o_arr_flt_Volumes_Pools: "), o_arr_str_PostionIDsPools, o_arr_flt_Volumes_Pools);
// }} ""
// {{ 1294 1 0 "74c1f005_e1bc_4bcc_a55f5cc31909f62e" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1295 1 0 "063653e9_04a2_4640_949910cb25dd45b8" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
o_str_FilePath_OutputFile = t_str_OutputFilePath;
// }} ""
// {{ 1296 1 0 "1e64b8ed_243e_40d2_908d57e44348c52b" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 1297 1 0 "c2fa2e1a_9fa1_40da_8dafc6394c39fbf1" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::COMPLETE, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{{ 1298 1 0 "83a99105_0b45_4326_994a61dfe75a127d" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::TRUE);
// }} ""
// {{ 1299 1 0 "1e64b8ed_243e_40d2_908d57e44348c52b" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 5 "Pooling_ByVolume" "End"
}
// }} ""
// {{{ 5 "_GetPoolInfo" "Begin"
private function _GetPoolInfo( variable i_str_FilePath, variable i_str_SQL, variable i_bln_TraceArrayInfo, file & i_hdlFile, variable i_int_PoolingMode, variable & o_arr_str_Pools[], variable & o_arr_int_NumberOfSamplesPerPool[], variable & o_arr_flt_MassPerSampleInPool[], variable & o_arr_flt_MassPerPool[], variable & o_arr_flt_VolumePerPool[] ) variable {
// }} ""
private variable l_int_NumberOfSamplesPerPool;
private variable l_int_NumberOfPools;
private variable loopCounter2;
private variable loopCounter4;
private variable l_arr_str_TargetWells_distinct[];
private variable l_arr_str_Temp[];
private variable l_arr_str_TargetWells[];
private variable l_arr_flt_MassPerSampleInPool[];
private variable l_arr_str_TargetWells_copy[];
private variable l_arr_int_NumberOfSamplesPerPool[];
private variable l_flt_MassPerSample;
private variable l_flt_MassThisPool;
private variable l_int_NumberOfDifferentVolumeForThisPool;
private variable l_flt_VolumeThisPool;
private variable l_int_NumberOfDifferentMassForThisPool;
private variable l_arr_flt_MassPerPool[];
private variable l_arr_flt_TempVolumePerPool[];
private variable l_arr_flt_VolumePerPool[];
private variable l_arr_flt_VolumeThisPool[];
private variable l_arr_flt_MassThisPool[];
private variable l_arr_flt_TempMassPerPool[];
private variable l_int_ReturnValue;
private variable l_flt_VolumeThisSample;
private variable loopCounter1;
private variable l_arr_flt_TempVolumePerSample[];
private variable l_arr_flt_VolumePerSample[];
private variable l_strFunctionName;
// {{ 5 "_GetPoolInfo" "InitLocals"
o_arr_str_Pools.SetSize( 0);
o_arr_int_NumberOfSamplesPerPool.SetSize( 0);
o_arr_flt_MassPerSampleInPool.SetSize( 0);
o_arr_flt_MassPerPool.SetSize( 0);
o_arr_flt_VolumePerPool.SetSize( 0);
// }} ""
// {{ 1426 1 0 "da46c79e_4928_421f_ac608cfff655e1f4" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1427 1 0 "9223efde_dde8_420b_84e16e1d65b13b84" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_strFunctionName = Translate("");
// }} ""
l_strFunctionName = GetFunctionName();
// {{{ 1429 1 0 "0c301788_615d_4be5_9b436ad006888bce" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::START, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{ 1430 1 0 "da46c79e_4928_421f_ac608cfff655e1f4" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1431 1 0 "9c01254b_564a_4cfb_85a22921e30f5f0b" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_str_TargetWells.SetSize(0);
// }} ""
// {{ 1432 1 0 "ba95941c_8e84_4ec8_806e3f718c56676e" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_int_NumberOfSamplesPerPool.SetSize(0);
// }} ""
// {{ 1433 1 0 "f04b267c_8f3c_4193_97c3c15cf8adb9c9" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_flt_VolumePerPool.SetSize(0);
// }} ""
// {{ 1434 1 0 "8943a16b_442b_4ff3_88465b1e39c7475a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_int_PoolingMode == 1)
{
// }} ""
// {{ 1435 1 0 "2b476935_129a_410e_9482db0c29321f7e" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_flt_MassPerPool.SetSize(0);
// }} ""
// {{ 1436 1 0 "0cc6b6c6_97fc_4ef4_91f5d7edea454cf8" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_flt_MassPerSampleInPool.SetSize(0);
// }} ""
// {{ 1437 1 0 "8943a16b_442b_4ff3_88465b1e39c7475a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1438 1 0 "8c778dd9_6fd2_459a_b550054bd1e9e374" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_int_PoolingMode == 2)
{
// }} ""
// {{ 1439 1 0 "5e1b376b_037b_462b_901f6d5b49450bfa" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_flt_VolumePerSample.SetSize(0);
// }} ""
// {{ 1440 1 0 "8c778dd9_6fd2_459a_b550054bd1e9e374" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1441 1 0 "f34dea80_e2a9_4a13_820d29cbb2da34e0" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_int_ReturnValue = 0;
// }} ""
// {{{ 1442 1 0 "12e002ba_7068_4dc2_bbede5aff82d06c4" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_PoolingFileOpen(i_str_FilePath, i_str_SQL, 1, i_int_PoolingMode, i_hdlFile);
// }} ""
// {{ 1443 1 0 "36588b9b_dbab_4370_82ea7b54f2c59a04" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter4 = 0;
while (
   (i_hdlFile.Eof() == 0)
)
{
loopCounter4 = loopCounter4 + 1;
// }} ""
// {{ 1444 1 0 "9aee9d86_4f73_47c0_beb703b1327a72b4" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == i_hdlFile.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 1445 1 0 "20a36850_931c_4e41_b3f22f5384fd27d1" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_str_TargetWells.AddAsLast(t_hdlFile_Worklist_Target_Well);
// }} ""
// {{ 1446 1 0 "f2eee835_4a2a_45c2_957cce86084f0f01" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_flt_VolumePerPool.AddAsLast(t_hdlFile_Worklist_VolumePerPool);
// }} ""
// {{ 1447 1 0 "adf5f02d_00a5_40b1_86419b08286642dd" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_int_PoolingMode == 1)
{
// }} ""
// {{ 1448 1 0 "b11111e2_5982_4101_bfc94abf4c0d6749" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_flt_MassPerPool.AddAsLast(t_hdlFile_Worklist_MassPerPool);
// }} ""
// {{ 1449 1 0 "adf5f02d_00a5_40b1_86419b08286642dd" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1450 1 0 "834372b9_51c0_4df9_ad8594850bd0acc5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_int_PoolingMode == 2)
{
// }} ""
// {{ 1451 1 0 "5d192cb6_6f5a_47e4_a054dbc80e590bb1" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_flt_VolumePerSample.AddAsLast(t_hdlFile_Worklist_VolumeToAspirate);
// }} ""
// {{ 1452 1 0 "834372b9_51c0_4df9_ad8594850bd0acc5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1453 1 0 "36588b9b_dbab_4370_82ea7b54f2c59a04" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 1454 1 0 "d9ef9ebe_7aae_45de_86d37c542aa32530" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != i_hdlFile.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
i_hdlFile.RemoveFields();
// }} ""
// {{{ 1455 1 0 "f1a6a05b_202a_4707_96d8d3289a23e8a4" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ARRAYTOOLS::get_distinct_from_array(l_arr_str_TargetWells, l_arr_str_TargetWells_distinct);
// }} ""
// {{ 1456 1 0 "5e5e020e_f3f6_4761_af8a68e7c89e6bb1" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
l_int_NumberOfPools=l_arr_str_TargetWells_distinct.GetSize();
// }} ""
// {{ 1457 1 0 "17bc5917_f69a_46b4_bb0615be35de02ba" "{DB5A2B39-67F2-4a78-A78F-DAF3FB056366}"
l_arr_str_TargetWells_copy=l_arr_str_TargetWells;
// }} ""
// {{ 1458 1 0 "b08f5c5a_3be4_418f_853296ea652e93d8" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(loopCounter2 = 0; loopCounter2 < l_int_NumberOfPools;)
{
loopCounter2 = loopCounter2 + 1;
// }} ""
// {{ 1459 1 0 "23d61b1f_7f29_4e02_a2aabea7f4817dd6" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1460 1 0 "6c4b86eb_ace1_4669_8dd2f17552f19f22" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_str_Temp.SetSize(0);
// }} ""
// {{{ 1461 1 0 "2bbe7993_675e_41c2_ac6d94502b933fff" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ARRAYTOOLS::ArrayVLookUp(l_arr_str_TargetWells_copy, l_arr_str_TargetWells, l_arr_str_TargetWells_distinct.ElementAt( loopCounter2 -1), l_arr_str_Temp);
// }} ""
// {{ 1462 1 0 "a507ed38_9004_4fa4_82d91eefd0fb6762" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
l_int_NumberOfSamplesPerPool=l_arr_str_Temp.GetSize();
// }} ""
// {{ 1463 1 0 "7da6f6a6_12b7_4395_bf10f2b6285bc90e" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_int_NumberOfSamplesPerPool.AddAsLast(l_int_NumberOfSamplesPerPool);
// }} ""
// {{ 1464 1 0 "23d61b1f_7f29_4e02_a2aabea7f4817dd6" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1465 1 0 "50fc0eaa_c74b_484a_8c279b1d4da9d887" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1466 1 0 "a98ebcf3_74cf_470d_a6b8a01df0ecd28d" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_flt_TempVolumePerPool.SetSize(0);
// }} ""
// {{{ 1467 1 0 "4b9c30de_de3b_431e_88eac4f5c3ef653c" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ARRAYTOOLS::ArrayVLookUp(l_arr_flt_VolumePerPool, l_arr_str_TargetWells, l_arr_str_TargetWells_distinct.ElementAt( loopCounter2 -1), l_arr_flt_TempVolumePerPool);
// }} ""
// {{{ 1468 1 0 "4b72e7bd_5505_4398_bfee6974dd52ca5d" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ARRAYTOOLS::get_distinct_from_array(l_arr_flt_TempVolumePerPool, l_arr_flt_VolumeThisPool);
// }} ""
// {{ 1469 1 0 "f4398eee_740e_4202_83c171bcec775225" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
l_int_NumberOfDifferentVolumeForThisPool=l_arr_flt_VolumeThisPool.GetSize();
// }} ""
// {{ 1470 1 0 "5c3f71f5_631c_40e2_bb44ccb6f16b9b83" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfDifferentVolumeForThisPool != 1)
{
// }} ""
// {{ 1471 1 0 "861d7c82_df28_4c64_a66d7ca128838042" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 1472 1 0 "aa3728f3_19ee_4ea2_80c7cdc18629ca25" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_int_ReturnValue = -2;
// }} ""
// {{ 1473 1 0 "ce20190f_c174_461c_8ab2f3c8e55eba95" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_VolumeThisPool = 0;
// }} ""
// {{ 1474 1 0 "5c3f71f5_631c_40e2_bb44ccb6f16b9b83" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1475 1 0 "3d45a2ad_8a83_417c_9727da58b61dd491" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_int_PoolingMode == 1)
{
// }} ""
// {{ 1476 1 0 "cceca192_f8d9_45a0_a78ce91b22118d23" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_VolumeThisPool = l_arr_flt_VolumeThisPool.ElementAt( 1 -1);
// }} ""
// {{ 1477 1 0 "3d45a2ad_8a83_417c_9727da58b61dd491" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1478 1 0 "4c445ceb_116e_420c_958e01d9b162e4af" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_VolumeThisPool = l_arr_flt_VolumeThisPool.ElementAt( 1 -1);
// }} ""
// {{ 1479 1 0 "a2b5c3ef_a751_4998_b841b6c840cbdded" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_VolumeThisPool == 0)
{
// }} ""
// {{ 1480 1 0 "3de16eb7_4338_44b7_97dd84b14bbbe6ab" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 1481 1 0 "152b2fa5_1b1c_456c_b94788b231e15c78" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_flt_TempVolumePerSample.SetSize(0);
// }} ""
// {{{ 1482 1 0 "65217b7d_7d62_427a_9e1e2b6cfd18fcaa" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ARRAYTOOLS::ArrayVLookUp(l_arr_flt_VolumePerSample, l_arr_str_TargetWells, l_arr_str_TargetWells_distinct.ElementAt( loopCounter2 -1), l_arr_flt_TempVolumePerSample);
// }} ""
// {{ 1483 1 0 "9e625fdc_4a1b_4e55_a4b25a58be368e04" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
l_int_NumberOfSamplesPerPool=l_arr_flt_TempVolumePerSample.GetSize();
// }} ""
// {{ 1484 1 0 "a0a5ce12_b898_4e36_9153465fc9a07075" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(loopCounter1 = 0; loopCounter1 < l_int_NumberOfSamplesPerPool;)
{
loopCounter1 = loopCounter1 + 1;
// }} ""
// {{ 1485 1 0 "40c79991_5b38_4ac9_9641c3522aac4672" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
l_flt_VolumeThisSample=l_arr_flt_TempVolumePerSample.GetAt(loopCounter1-1);
// }} ""
// {{ 1486 1 0 "273fd08a_be8c_4bc5_bcc7fa6f5116e7c1" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
l_flt_VolumeThisPool = l_flt_VolumeThisPool + l_flt_VolumeThisSample;
// }} ""
// {{ 1487 1 0 "a0a5ce12_b898_4e36_9153465fc9a07075" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 1488 1 0 "a2b5c3ef_a751_4998_b841b6c840cbdded" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1489 1 0 "3d45a2ad_8a83_417c_9727da58b61dd491" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1490 1 0 "5c3f71f5_631c_40e2_bb44ccb6f16b9b83" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1491 1 0 "f701d1fb_686b_4961_a41bd3d738cc4d60" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
o_arr_flt_VolumePerPool.AddAsLast(l_flt_VolumeThisPool);
// }} ""
// {{ 1492 1 0 "50fc0eaa_c74b_484a_8c279b1d4da9d887" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1493 1 0 "768050d7_1122_46fa_81273836eace0303" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_int_PoolingMode == 1)
{
// }} ""
// {{ 1494 1 0 "7a38472a_8118_4396_8eff4e597d8b0d6d" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1495 1 0 "2c912bc6_66d7_421e_a545c8225fdec656" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_flt_TempMassPerPool.SetSize(0);
// }} ""
// {{{ 1496 1 0 "861e10b8_2112_4ce9_a30142da218d15c1" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ARRAYTOOLS::ArrayVLookUp(l_arr_flt_MassPerPool, l_arr_str_TargetWells, l_arr_str_TargetWells_distinct.ElementAt( loopCounter2 -1), l_arr_flt_TempMassPerPool);
// }} ""
// {{{ 1497 1 0 "23db51c1_4a26_4f8c_8aa99cc740b3febf" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ARRAYTOOLS::get_distinct_from_array(l_arr_flt_TempMassPerPool, l_arr_flt_MassThisPool);
// }} ""
// {{ 1498 1 0 "49ddc55d_7721_40b2_8524442d88fa843b" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
l_int_NumberOfDifferentMassForThisPool=l_arr_flt_MassThisPool.GetSize();
// }} ""
// {{ 1499 1 0 "16465e93_7fca_4c4d_b594d620e31f1263" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfDifferentMassForThisPool != 1)
{
// }} ""
// {{ 1500 1 0 "eb83951a_642a_44fd_a5d709bb76ecff7d" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 1501 1 0 "8f3c3d5c_f57f_47fd_b421a75d09721f87" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_int_ReturnValue = -1;
// }} ""
// {{ 1502 1 0 "fde6631d_dbf5_43ae_967f4981c0138d66" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_MassThisPool = 0;
// }} ""
// {{ 1503 1 0 "16465e93_7fca_4c4d_b594d620e31f1263" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1504 1 0 "18476342_3efa_43d7_af711c2d6c667f18" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_MassThisPool = l_arr_flt_MassThisPool.ElementAt( 1 -1);
// }} ""
// {{ 1505 1 0 "16465e93_7fca_4c4d_b594d620e31f1263" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1506 1 0 "555ff536_35a9_4198_803a78bdb50cd418" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
o_arr_flt_MassPerPool.AddAsLast(l_flt_MassThisPool);
// }} ""
// {{ 1507 1 0 "7a38472a_8118_4396_8eff4e597d8b0d6d" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1508 1 0 "1ebfbd88_5e35_4d74_811d381ebbec85f1" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1509 1 0 "fcf3679a_5cb8_41d7_967b7298a051876f" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
l_flt_MassPerSample = l_flt_MassThisPool / (l_int_NumberOfSamplesPerPool * 1.0);
// }} ""
// {{ 1510 1 0 "8c3bd233_2143_49d6_904b0fdd5bace95a" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_flt_MassPerSampleInPool.AddAsLast(l_flt_MassPerSample);
// }} ""
// {{ 1511 1 0 "1ebfbd88_5e35_4d74_811d381ebbec85f1" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1512 1 0 "768050d7_1122_46fa_81273836eace0303" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1513 1 0 "b08f5c5a_3be4_418f_853296ea652e93d8" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 1514 1 0 "fd85f411_e5ac_409f_87c1982db3c538b5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_bln_TraceArrayInfo == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{ 1515 1 0 "14b5c609_59c6_4de3_bdfb29111414320b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_int_PoolingMode == 1)
{
// }} ""
// {{{ 1516 1 0 "f4782d5a_d8d5_42cb_81e8b2cdd5f74f00" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
Util2::Debug::TraceArray_4(Translate("Well / Number of Samples / Mass per Pool / Volume per Pool: "), l_arr_str_TargetWells_distinct, l_arr_int_NumberOfSamplesPerPool, o_arr_flt_MassPerPool, o_arr_flt_VolumePerPool);
// }} ""
// {{{ 1517 1 0 "b6adb9d0_2d47_411c_b24fd6c1749d8012" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
Util2::Debug::TraceArray_4(Translate("Well / Number of Samples / Mass per Pool / Mass per Sample: "), l_arr_str_TargetWells_distinct, l_arr_int_NumberOfSamplesPerPool, o_arr_flt_MassPerPool, l_arr_flt_MassPerSampleInPool);
// }} ""
// {{ 1518 1 0 "14b5c609_59c6_4de3_bdfb29111414320b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 1519 1 0 "484fd809_9f8f_452f_8115c358deb196a1" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
Util2::Debug::TraceArray_3(Translate(""), l_arr_str_TargetWells_distinct, l_arr_int_NumberOfSamplesPerPool, o_arr_flt_VolumePerPool);
// }} ""
// {{ 1520 1 0 "14b5c609_59c6_4de3_bdfb29111414320b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1521 1 0 "fd85f411_e5ac_409f_87c1982db3c538b5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1522 1 0 "e5ce728a_8408_4210_b1afcb52601aaf4e" "{DB5A2B39-67F2-4a78-A78F-DAF3FB056366}"
o_arr_int_NumberOfSamplesPerPool=l_arr_int_NumberOfSamplesPerPool;
// }} ""
// {{ 1523 1 0 "bb7a205a_64d5_48cb_baadd117be0fa7a8" "{DB5A2B39-67F2-4a78-A78F-DAF3FB056366}"
o_arr_str_Pools=l_arr_str_TargetWells_distinct;
// }} ""
// {{ 1524 1 0 "195c9662_e8d3_41c2_9df99d3d96c280fe" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_int_PoolingMode == 1)
{
// }} ""
// {{ 1525 1 0 "17c5f8e9_104b_46bb_a6c0cf713e2bd5fa" "{DB5A2B39-67F2-4a78-A78F-DAF3FB056366}"
o_arr_flt_MassPerSampleInPool=l_arr_flt_MassPerSampleInPool;
// }} ""
// {{ 1526 1 0 "195c9662_e8d3_41c2_9df99d3d96c280fe" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1527 1 0 "26250c05_3123_46b1_ab15e07fad207fd3" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
o_arr_flt_MassPerPool.SetSize(0);
// }} ""
// {{ 1528 1 0 "40a6636d_45e6_4281_ac48be4a003fecec" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
o_arr_flt_MassPerSampleInPool.SetSize(0);
// }} ""
// {{ 1529 1 0 "195c9662_e8d3_41c2_9df99d3d96c280fe" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 1530 1 0 "349e9e45_14e2_46b9_bf78a1adb6ebfd96" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (l_int_ReturnValue);
// }} ""
// {{ 1531 1 0 "83c5cf52_e30f_4068_907e59e407fd2909" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 1532 1 0 "d84e1a99_ffca_44d7_9bdc1624ccc6b4b3" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::COMPLETE, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{ 1533 1 0 "83c5cf52_e30f_4068_907e59e407fd2909" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 5 "_GetPoolInfo" "End"
}
// }} ""
// {{{ 5 "_Display_InputWorklist_Dialog" "Begin"
private function _Display_InputWorklist_Dialog( variable & o_str_FileWorklistFullPath ) void {
// }} ""
private variable i_str_fileFormat;
private variable l_str_FileFilter;
private variable g_str_InputWorklistFilePath;
private variable l_strErrorMessage;
private variable l_int_rtnErrorDialog;
private variable l_intReturnDisplayDialog;
private variable loopCounter2;
private variable t_strDirectoryName;
private variable l_strFunctionName;
// {{ 5 "_Display_InputWorklist_Dialog" "InitLocals"
o_str_FileWorklistFullPath = 0;
// }} ""
// {{ 1386 1 0 "0b832aec_f448_4572_a79bc86734af8edb" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1387 1 0 "95713076_48a3_4f98_a56652dcc56449c0" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_strFunctionName = Translate("");
// }} ""
l_strFunctionName = GetFunctionName();
// {{{ 1389 1 0 "19004055_cd94_4a27_9bcb886e996bac9d" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::START, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{ 1390 1 0 "0b832aec_f448_4572_a79bc86734af8edb" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1391 1 0 "4c452796_4cd5_4b1c_a3f63c0ca4756d95" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_str_FileFilter = Translate("*");
// }} ""
// {{{ 1392 1 0 "4ba3d98f_4975_45af_b6d916b6d72f229b" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_CheckBindReturnValueVectorCustomDialogs(l_int_rtnErrorDialog);
// }} ""
// {{ 1393 1 0 "55116c60_275e_4053_8d21e7f0ae268755" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 1394 1 0 "b9b566fc_9d3c_4643_8c664b994382c262" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_FileFilter = StrConcat4(i_str_fileFormat, Translate(" files allowed|*."), Translate("*"), Translate(""));
// }} ""
// {{ 1395 1 0 "55116c60_275e_4053_8d21e7f0ae268755" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1396 1 0 "d07e13af_d07a_4c90_8161215e0dc75e79" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1397 1 0 "631327cf_2cbc_4165_973bfc7253a1d6c2" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter2 = 0;
while (1 == 1)
{
loopCounter2 = loopCounter2 + 1;
// }} ""
// {{{ 1398 1 0 "8c8040c7_6f24_4d0b_bfafd002edfb8db7" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_strErrorMessage = StrConcat4(Translate("Error during previous selection of a worklist "), Translate("Select again a worklist - "), Translate("Trial : "), loopCounter2);
// }} ""
// {{{ 1399 1 0 "17ada40d_592a_4823_94620b130b8cc9db" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_intReturnDisplayDialog = VectorCustomDialogs::FileBrowserDialog(Translate(""), VectorCustomDialogs::ButtonType::OkCancel, 0, 0, Translate("Please select Input File Worklist"), VectorCustomDialogs::FileBrowserDialog::DialogType::Open, l_str_FileFilter, 1, Translate(""), o_str_FileWorklistFullPath);
// }} ""
// {{{ 1400 1 0 "5467a39e_df06_41af_a2e0b9c2f3179a1c" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_CheckBindReturnValueVectorCustomDialogs(l_intReturnDisplayDialog);
// }} ""
// {{{ 1401 1 0 "c873d020_bff7_422f_a04bbddf92baac98" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
t_strDirectoryName = HSLExtensions::File::GetDirectoryName(o_str_FileWorklistFullPath);
// }} ""
Trace("l_intReturnDisplayDialog : ",l_intReturnDisplayDialog);
// {{ 1403 1 0 "7b99c6c2_3192_406a_80819ebf04e1813b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_intReturnDisplayDialog == 2)
{
// }} ""
// {{{ 1404 1 0 "64585524_17fd_455a_aef12dee3f1b09d4" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
VectorCustomDialogs::MessageDialog(Translate(""), VectorCustomDialogs::IconType::Error, VectorCustomDialogs::ButtonType::Ok, 0, 0, 0, Translate("User pressed abort"));
// }} ""
// {{ 1405 1 0 "ffdaf13a_9279_4e93_93b3e600cd95292a" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 1406 1 0 "7b99c6c2_3192_406a_80819ebf04e1813b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1407 1 0 "04ceb8e0_6780_442e_a449af28c411ae40" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_intReturnDisplayDialog == -9)
{
// }} ""
// {{{ 1408 1 0 "0e22925c_7055_4b48_971cc00a12f8502a" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_int_rtnErrorDialog = VectorCustomDialogs::MessageDialog(Translate(""), VectorCustomDialogs::IconType::Error, VectorCustomDialogs::ButtonType::Ok, 0, 0, 0, l_strErrorMessage);
// }} ""
// {{{ 1409 1 0 "3404bd25_982c_4b9b_be9dff5ab3a7ba37" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_CheckBindReturnValueVectorCustomDialogs(l_int_rtnErrorDialog);
// }} ""
// {{ 1410 1 0 "04ceb8e0_6780_442e_a449af28c411ae40" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1411 1 0 "4a601679_3587_4cda_99c031597fdd6704" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (o_str_FileWorklistFullPath == "")
{
// }} ""
// {{{ 1412 1 0 "6aa6b279_a88e_4f75_9746668d9cb8c8f1" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_int_rtnErrorDialog = VectorCustomDialogs::MessageDialog(Translate(""), VectorCustomDialogs::IconType::Error, VectorCustomDialogs::ButtonType::Ok, 0, 0, 0, l_strErrorMessage);
// }} ""
// {{{ 1413 1 0 "0d3e6da0_e3dd_4f3f_9590234c0af95263" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_CheckBindReturnValueVectorCustomDialogs(l_int_rtnErrorDialog);
// }} ""
// {{ 1414 1 0 "4a601679_3587_4cda_99c031597fdd6704" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1415 1 0 "9f7dd72b_3ac1_448c_b190b081619df525" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
g_str_InputWorklistFilePath = o_str_FileWorklistFullPath;
// }} ""
// {{ 1416 1 0 "a80bcebc_fe77_4ccb_bbfa81274c3fbf83" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 1417 1 0 "4a601679_3587_4cda_99c031597fdd6704" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1418 1 0 "04ceb8e0_6780_442e_a449af28c411ae40" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1419 1 0 "7b99c6c2_3192_406a_80819ebf04e1813b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1420 1 0 "631327cf_2cbc_4165_973bfc7253a1d6c2" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 1421 1 0 "d07e13af_d07a_4c90_8161215e0dc75e79" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1422 1 0 "2aae137c_95d4_47ed_b5f895a3fe23fa76" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 1423 1 0 "a18444d4_9425_464c_af0f6047b1a3943b" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::COMPLETE, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{ 1424 1 0 "2aae137c_95d4_47ed_b5f895a3fe23fa76" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 5 "_Display_InputWorklist_Dialog" "End"
}
// }} ""
// {{{ 5 "_CheckBindReturnValueVectorCustomDialogs" "Begin"
private function _CheckBindReturnValueVectorCustomDialogs( variable i_intBindReturnValue ) void {
// }} ""
private variable l_blnSkipDialog;
private variable l_strErrorMessage;
private variable l_intBindReturnValue;
private variable l_strFunctionName;
// {{ 5 "_CheckBindReturnValueVectorCustomDialogs" "InitLocals"
// }} ""
// {{ 1301 1 0 "819eb548_ac68_4e89_9ab0109929308432" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1302 1 0 "034d62ce_1b3a_46d1_b909a5a67aa392fb" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_strFunctionName = Translate("");
// }} ""
l_strFunctionName = GetFunctionName();
// {{{ 1304 1 0 "90117333_a3da_4b44_b9f2a0ee344a4b5e" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::START, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{ 1305 1 0 "819eb548_ac68_4e89_9ab0109929308432" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1306 1 0 "7dfc3d85_ccf6_4f8d_ac93b43ca73d15c2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_intBindReturnValue == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{ 1307 1 0 "7dfc3d85_ccf6_4f8d_ac93b43ca73d15c2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
Trace("Bind return value of current Vector custom dialog : ", i_intBindReturnValue);
// {{ 1309 1 0 "c4f386a4_5b16_49fd_ad7fcaff2de3fed9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_intBindReturnValue == ASWGLOBAL::BOOL::FALSE)
{
// }} ""
// {{ 1310 1 0 "92df99af_ce92_4bee_ae7a9dafc78fb78f" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_blnSkipDialog = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 1311 1 0 "41fa4bb0_8149_4c2c_b31192041c7a37cf" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_strErrorMessage = Translate("Command did not end successfully ");
// }} ""
// {{ 1312 1 0 "c4f386a4_5b16_49fd_ad7fcaff2de3fed9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1313 1 0 "9d004e9f_1503_4e97_b0b36117f75f0561" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_blnSkipDialog = ASWGLOBAL::BOOL::FALSE;
// }} ""
// {{ 1314 1 0 "c4f386a4_5b16_49fd_ad7fcaff2de3fed9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1315 1 0 "82c2d02d_19a5_46b9_ba20d2a9aac28816" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_intBindReturnValue == -1)
{
// }} ""
// {{ 1316 1 0 "19b1d917_b8f3_4130_9b46e8f29435e3de" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_strErrorMessage = Translate("Sizes of initialization arrays are inhomogeneous. Hint : Check your arrays (sizes have to be equal). ");
// }} ""
// {{ 1317 1 0 "82c2d02d_19a5_46b9_ba20d2a9aac28816" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1318 1 0 "5ac8e9bc_f4ab_462a_85343af4c918c360" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_intBindReturnValue == -2)
{
// }} ""
// {{ 1319 1 0 "f0416c9f_4bcd_4963_bb0896f20814ae7c" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_strErrorMessage = Translate("Data range / type. Hint : Used range or range in combination with data type is invalid.");
// }} ""
// {{ 1320 1 0 "5ac8e9bc_f4ab_462a_85343af4c918c360" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1321 1 0 "d424604b_62b8_4528_802001090f6582a9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_intBindReturnValue == -5)
{
// }} ""
// {{ 1322 1 0 "c336b726_6f9f_4845_b88fe9a38e5464e2" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_strErrorMessage = Translate("IconSet Directory. Hint : Make sure that the directory named ASWIconSet exists inside the directory of ASWStandardDialogs library.");
// }} ""
// {{ 1323 1 0 "d424604b_62b8_4528_802001090f6582a9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1324 1 0 "95f4a268_8d9f_41ff_9787e1e102fbce11" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_intBindReturnValue == -8)
{
// }} ""
// {{ 1325 1 0 "38229b5d_53e4_4169_b173395229990f3e" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_strErrorMessage = Translate("Dialog has been closed through timeout. Hint : This may or may not be an error, depending on the programmers intention. Clicking on a dialog interrupts timer and thus does not lead to a error.");
// }} ""
// {{ 1326 1 0 "95f4a268_8d9f_41ff_9787e1e102fbce11" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1327 1 0 "cb80922f_4171_4fca_91f8845b7f3e10c7" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_intBindReturnValue == -9)
{
// }} ""
// {{ 1328 1 0 "c2de6f38_eb10_44f3_a2f5f89205d0727a" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_strErrorMessage = Translate("The dialog was not . Hint : Do not use shortcuts to close the dialog, use buttons from the dialog.");
// }} ""
// {{ 1329 1 0 "cb80922f_4171_4fca_91f8845b7f3e10c7" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1330 1 0 "4251f864_bc6d_4f74_91b0bca4f7902246" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_intBindReturnValue == -10)
{
// }} ""
// {{ 1331 1 0 "54f3a1cc_efc9_48e9_97e7bac28fb94987" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_strErrorMessage = Translate("Library is not initialized. Hint : Initialize library before any other function is called.");
// }} ""
// {{ 1332 1 0 "4251f864_bc6d_4f74_91b0bca4f7902246" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1333 1 0 "4ed57380_77be_43a9_b0dd065fa9ad8270" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_intBindReturnValue == -11)
{
// }} ""
// {{ 1334 1 0 "7be95faa_40ff_42a6_89ed6c382a1e4bf0" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_strErrorMessage = Translate("Bad Parameter. Hint : See trace for more information about which parameter caused the error. Adjust the input parameter accordingly.");
// }} ""
// {{ 1335 1 0 "4ed57380_77be_43a9_b0dd065fa9ad8270" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1336 1 0 "095e3a06_1e87_4c84_8f6c0ece443c3c61" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_intBindReturnValue == -1000)
{
// }} ""
// {{ 1337 1 0 "f5395a12_aa9d_4125_960c3b9ce5fbdb1f" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_strErrorMessage = Translate("A COM error has occured. Hint : Please ensure that the com library HamiltonASWGUI.Dialogs.dll is registered.");
// }} ""
// {{ 1338 1 0 "095e3a06_1e87_4c84_8f6c0ece443c3c61" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1339 1 0 "7949777c_afdc_4777_9a1da986f41e956a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_intBindReturnValue == -1001)
{
// }} ""
// {{ 1340 1 0 "8b3eab4b_170a_4307_853c387bf73b7aea" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_strErrorMessage = Translate("A COM error has occured. Hint : You cannot execute more dialogs at the same time than defined in the HSL library (default is dialog at a time).");
// }} ""
// {{ 1341 1 0 "7949777c_afdc_4777_9a1da986f41e956a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
Trace("Error message od Vector custom dialog library : ", l_strErrorMessage);
// {{ 1343 1 0 "3ef55738_601d_4448_948db187a7bc9bfe" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_blnSkipDialog == ASWGLOBAL::BOOL::FALSE)
{
// }} ""
// {{{ 1344 1 0 "f06cf340_fb4a_4b1f_93304152cd3333ab" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_intBindReturnValue = VectorCustomDialogs::MessageDialog(Translate("Error message of Vector Custom Dialogs. OK is trying to continue the run ignoring the error - CANCEL will abort the run"), VectorCustomDialogs::IconType::Error, VectorCustomDialogs::ButtonType::OkCancel, 0, 0, 60, l_strErrorMessage);
// }} ""
// {{ 1345 1 0 "74551d30_9ead_4dc3_83ee4b3d8ca6c4f1" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_intBindReturnValue == ASWGLOBAL::DIALOG::CANCEL)
{
// }} ""
// {{ 1346 1 0 "c50dd441_c84c_4661_8d61ea59f84166b5" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 1347 1 0 "74551d30_9ead_4dc3_83ee4b3d8ca6c4f1" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1348 1 0 "3ef55738_601d_4448_948db187a7bc9bfe" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1349 1 0 "7dfc3d85_ccf6_4f8d_ac93b43ca73d15c2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1350 1 0 "19948da7_022d_44f1_b49b76fc0bfbe99f" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 1351 1 0 "a5d89de5_6f70_42dc_bce4502e80f3768d" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::COMPLETE, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{ 1352 1 0 "19948da7_022d_44f1_b49b76fc0bfbe99f" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 5 "_CheckBindReturnValueVectorCustomDialogs" "End"
}
// }} ""
// {{{ 5 "Pooling_ByMass" "Begin"
function Pooling_ByMass( variable i_str_WorklistFilePath, sequence i_seq_SourceSamplePlate, sequence i_seq_Pooling, variable i_flt_MaximumVolumePerContainer, variable i_bln_AllowCostumerIntervention, sequence & o_seq_Asp_Samples, sequence & o_seq_Disp_Samples, variable & o_arr_flt_Volumes_Sample[], sequence & o_seq_Disp_Diluent, variable & o_arr_flt_Volumes_Diluent[], variable & o_flt_Diluent_TotalVolume, variable & o_str_FilePath_OutputFile, variable & o_int_NumberOfPools, variable & o_arr_flt_Volumes_Pools[], variable & o_arr_str_PostionIDsPools[], device & ML_STAR ) variable {
// }} ""
private variable l_int_NumberOfSamples_Source;
private variable l_bln_ReloadWorklist;
private variable l_bln_FileExists;
private variable l_str_CurrentPoolId;
private variable l_int_ReturnValue;
private variable l_flt_Volume_SampleAspirate;
private variable l_flt_CurrentMass;
private variable l_bln_ExcludePool;
private variable l_str_Message;
private variable l_int_NumberOfSamplesUsedMultipleTimes;
private variable l_strSQL_Sentence1;
private variable l_str_ExcludePool;
private variable l_int_NumberOfUseThisSample;
private variable l_int_CurrentPool_IndexCounter;
private variable l_str_LabwareID_Pooling;
private variable l_int_NumberOfPools;
private variable l_flt_Volume_DiluentAspirate;
private variable l_flt_MaximumVolumePerPool;
private variable l_int_NumberOfSamples_Excluded;
private variable l_flt_TotalVolumePerSample;
private variable l_flt_TotalVolumeCurrentPool;
private variable l_int_NumberOfSamples;
private variable l_bln_ExcludeSample;
private variable l_bln_Repeat_Analysis;
private variable l_flt_VolumeDiluent;
private variable l_str_MultipleUsedSampleSourcePositions;
private variable l_int_Counter_RepeatAnalysis;
private variable l_str_Worklist_Extension;
private variable loopCounter1;
private variable CounterWorklistReloading;
private variable loopCounter2;
private variable l_flt_Volume_Total;
private variable l_int_TotalNumberOfSamples_Excluded;
private variable loopCounter3;
private variable l_flt_VolumePerPool;
private variable l_flt_Volume_MinimumToPipetteDiluent;
private variable l_str_Worklist_FileName;
private variable l_int_NumberOfElements;
private variable l_flt_Volume_MinimumToPipette;
private variable l_str_LabwareID_SamplePlate;
private variable l_int_Counter_Pool;
private sequence l_seq_Disp_Diluent;
private variable l_arr_flt_VolumeDiluent_PerPool[];
private variable l_arr_flt_MassPerPool[];
private variable l_arr_str_Temp[];
private variable l_arr_str_SampleSourcePosition[];
private variable l_arr_str_SampleSourcePosition_distinct[];
private variable l_arr_flt_VolumePerPool[];
private variable l_arr_flt_TotalVolumePerSample[];
private variable l_arr_strTokens[];
private variable l_arr_int_TotalNumberOfUsePerSample[];
private variable l_arr_flt_MassPerPool_current[];
private variable l_arr_int_NumberOfSamplesPerPool_current[];
private variable l_arr_str_Pool_Ids[];
private variable l_arr_flt_TotalVolumePerPool[];
private variable l_arr_flt_MassPerSampleInPool[];
private variable l_arr_flt_MassPerSampleInPool_current[];
private variable l_arr_flt_Volumes_Sample[];
private variable l_arr_flt_MassForThisSample[];
private variable l_arr_str_Pool_Ids_current[];
private variable l_arr_flt_VolumePerPool_current[];
private variable l_arr_int_NumberOfSamplesPerPool[];
private variable l_arr_str_SampleSourcePosition_copy[];
private variable l_arr_str_MultipleUsedSampleSourcePositions[];
private variable l_bln_PoolProcessed;
private variable l_strFunctionName;
// {{ 5 "Pooling_ByMass" "InitLocals"
{ sequence __temp; o_seq_Asp_Samples = __temp; }
{ sequence __temp; o_seq_Disp_Samples = __temp; }
o_arr_flt_Volumes_Sample.SetSize( 0);
{ sequence __temp; o_seq_Disp_Diluent = __temp; }
o_arr_flt_Volumes_Diluent.SetSize( 0);
o_flt_Diluent_TotalVolume = 0;
o_str_FilePath_OutputFile = 0;
o_int_NumberOfPools = 0;
o_arr_flt_Volumes_Pools.SetSize( 0);
o_arr_str_PostionIDsPools.SetSize( 0);
// }} ""
// {{ 487 1 0 "ef51acf2_c6eb_41fb_9204e7c4856720df" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 488 1 0 "224cfb01_41b1_44c1_8506324150b2d780" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_strFunctionName = Translate("");
// }} ""
l_strFunctionName = GetFunctionName();
// {{{ 490 1 0 "aaf4c9b0_02a7_49b5_9e1295a45907e196" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::START, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{ 491 1 0 "ef51acf2_c6eb_41fb_9204e7c4856720df" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 492 1 0 "6ec3d8c9_0930_4fbd_9572e57e453b5f8d" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
CounterWorklistReloading = 0;
while (1 == 1)
{
CounterWorklistReloading = CounterWorklistReloading + 1;
// }} ""
// {{ 493 1 0 "2c60dfd4_f662_4ee9_8116285825fdb177" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ReloadWorklist = ASWGLOBAL::BOOL::FALSE;
// }} ""
// {{ 494 1 0 "6cf7c41c_87e8_4cc9_a12146ff7b689a42" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 495 1 0 "485445c2_87a7_4847_82ef3af31ef3e0e2" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_RELEASE, Translate("i_str_WorklistFilePath: "), i_str_WorklistFilePath);
// }} ""
// {{ 496 1 0 "6cf7c41c_87e8_4cc9_a12146ff7b689a42" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 497 1 0 "63c2c0da_42e0_4937_acca4d0e0de0597c" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 498 1 0 "c564bb5f_4c55_451b_97b894decfaf0c85" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_Volume_MinimumToPipette = 2;
// }} ""
// {{ 499 1 0 "28854814_cbe6_4ce3_ba75ccb8abc03321" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_Volume_MinimumToPipetteDiluent = 0.5;
// }} ""
// {{ 500 1 0 "f01713db_88f0_4bed_bc0091bb59522200" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
o_arr_flt_Volumes_Sample.SetSize(0);
// }} ""
// {{ 501 1 0 "f9d05e7d_94d8_47cb_973816ec7904d97f" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
o_arr_flt_Volumes_Diluent.SetSize(0);
// }} ""
// {{{ 502 1 0 "c5c226ef_cc8b_4625_95fbc655a14c88b2" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Worklist_FileName = HSLExtensions::File::GetFileNameWithoutExtension(i_str_WorklistFilePath);
// }} ""
// {{{ 503 1 0 "70f2b403_b8a5_4dc9_9e9198da20615011" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Worklist_Extension = HSLExtensions::File::GetFileExtension(i_str_WorklistFilePath);
// }} ""
// {{{ 504 1 0 "adc29006_e238_4a5b_bd16b523b94e459e" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
t_str_OutputFilePath = StrConcat12(t_strLogFilesDirectory, Translate("\\"), t_strKitTitle, Translate("_"), Translate("PoolingOutput"), Translate("_"), t_str_Date, Translate("_"), t_str_Time, Translate("."), Translate("xls"), Translate(""));
// }} ""
// {{{ 505 1 0 "864a8d59_9108_469f_b686ded5d13b45b5" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
t_str_TemplateFilePath = StrConcat12(t_strLogFilesDirectory, Translate("\\"), t_strKitTitle, Translate("_"), Translate("PoolingTemplate"), Translate("_"), t_str_Date, Translate("_"), t_str_Time, Translate("."), Translate("xls"), Translate(""));
// }} ""
// {{{ 506 1 0 "1cabb1a9_7f40_4985_abac62372d6f2c1d" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
t_str_ExcludedSamplesFilePath = StrConcat12(t_strLogFilesDirectory, Translate("\\"), t_strKitTitle, Translate("_"), Translate("PoolingExcludedSamples"), Translate("_"), t_str_Date, Translate("_"), t_str_Time, Translate("."), Translate("xls"), Translate(""));
// }} ""
// {{ 507 1 0 "117bc39c_9193_42c2_a59353b8684baee4" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
o_flt_Diluent_TotalVolume = 0.0;
// }} ""
// {{ 508 1 0 "9c73847a_0b9d_46f2_ac216116c8e5931c" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_Volume_SampleAspirate = 0.0;
// }} ""
// {{ 509 1 0 "1cb0faac_ab12_47fc_abcfd14bca079832" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_Volume_DiluentAspirate = 0.0;
// }} ""
// {{ 510 1 0 "909591b2_a903_4ca4_9aa6fcad18c788df" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_Volume_Total = 0.0;
// }} ""
// {{ 511 1 0 "dc22dedf_41af_4a5b_a865ef46c176b895" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_VolumePerPool = 0.0;
// }} ""
// {{ 512 1 0 "63c2c0da_42e0_4937_acca4d0e0de0597c" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 513 1 0 "ce05de80_08a4_4af9_8bcaecd3440e5b45" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 514 1 0 "97ac63be_0b19_4fbe_a9437d436be93acf" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 515 1 0 "06594660_7df2_450e_bc5739c3c1931516" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension == "csv")
{
// }} ""
// {{ 516 1 0 "8078a924_092a_4daa_ac823e5e4ffe5245" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_ABFD2FD254DD47c9B0833FC43AB6567D ;
err.Clear();
// }} ""
// {{ 517 1 0 "afc238cf_cbd0_4ae4_a9de96652d235cd6" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Worklist.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Concentration", t_hdlFile_Worklist_Sample_Concentration, hslFloat);
t_hdlFile_Worklist.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
t_hdlFile_Worklist.AddField("Mass_PerPool", t_hdlFile_Worklist_MassPerPool, hslFloat);
t_hdlFile_Worklist.AddField("Volume_PerPool", t_hdlFile_Worklist_VolumePerPool, hslFloat);
t_hdlFile_Worklist.SetDelimiter(";");
if( 0 == t_hdlFile_Worklist.Open(i_str_WorklistFilePath, hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_WorklistFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 518 1 0 "8078a924_092a_4daa_ac823e5e4ffe5245" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_ABFD2FD254DD47c9B0833FC43AB6567D : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{{ 519 1 0 "7cf28c0d_90e7_4950_b5fcea440d52eb8e" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_DATA_IntegratedAbortHandler(l_strFunctionName, Translate("Normalization and Pooling Controller cannot open input worklist. Please review file structure and content, possibly required columns or entries are missing. System will abort"));
// }} ""
// {{{ 520 1 0 "96b8302b_df7f_450b_990b1536fc9609e2" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::FALSE);
// }} ""
// {{ 521 1 0 "8078a924_092a_4daa_ac823e5e4ffe5245" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 522 1 0 "06594660_7df2_450e_bc5739c3c1931516" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 523 1 0 "02be3b51_6fd9_460f_86354e66b267a861" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension == "xls")
{
// }} ""
// {{ 524 1 0 "f734ef8d_732c_4698_a1e723c550fff2cd" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_F9B4B719350E4816B062156CF48C58BF ;
err.Clear();
// }} ""
// {{ 525 1 0 "545cba2c_ac1c_4ccc_8ab33c51d56c21f0" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Worklist.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Concentration", t_hdlFile_Worklist_Sample_Concentration, hslFloat);
t_hdlFile_Worklist.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
t_hdlFile_Worklist.AddField("Mass_PerPool", t_hdlFile_Worklist_MassPerPool, hslFloat);
t_hdlFile_Worklist.AddField("Volume_PerPool", t_hdlFile_Worklist_VolumePerPool, hslFloat);
if( 0 == t_hdlFile_Worklist.Open(i_str_WorklistFilePath + " " + "Sheet1$", hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_WorklistFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 526 1 0 "f734ef8d_732c_4698_a1e723c550fff2cd" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_F9B4B719350E4816B062156CF48C58BF : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{{ 527 1 0 "e8c0424b_ae1c_4d0b_9dd35b327f0319bd" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_DATA_IntegratedAbortHandler(l_strFunctionName, Translate("Normalization and Pooling Controller cannot open input worklist. Please review file structure and content, possibly required columns or entries are missing. System will abort"));
// }} ""
// {{{ 528 1 0 "ccdeaaf6_499d_4f17_b3de8d96a961795a" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::FALSE);
// }} ""
// {{ 529 1 0 "f734ef8d_732c_4698_a1e723c550fff2cd" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 530 1 0 "02be3b51_6fd9_460f_86354e66b267a861" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 531 1 0 "752b7742_5ff8_4df0_b58f28458b224eab" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension != "csv")
{
// }} ""
// {{ 532 1 0 "3a3fae85_2dc3_4c0c_b01a045159498687" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension != "xls")
{
// }} ""
// {{{ 533 1 0 "7d14e5ee_885a_4924_a043d5fc17d36d5a" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_DATA_IntegratedAbortHandler(l_strFunctionName, Translate("Normalization and Pooling Controller cannot open input worklist (only .xls and .csv file formats are accepted). System will abort"));
// }} ""
// {{{ 534 1 0 "b3d39838_7dc4_48f3_a56ec0a2c4e38002" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::FALSE);
// }} ""
// {{ 535 1 0 "3a3fae85_2dc3_4c0c_b01a045159498687" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 536 1 0 "752b7742_5ff8_4df0_b58f28458b224eab" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 537 1 0 "38b20feb_ee2f_463c_83f413a39314eab9" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_PoolingFileOpen(t_str_TemplateFilePath, Translate(""), 2, 1, t_hdlFile_Template);
// }} ""
// {{ 538 1 0 "16da2b6a_e0d9_4b8b_9d549fcd6ff3c8ba" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter3 = 0;
while (
   (t_hdlFile_Worklist.Eof() == 0)
)
{
loopCounter3 = loopCounter3 + 1;
// }} ""
// {{ 539 1 0 "2eeea007_fe20_493a_89293d5d61fb8cd9" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Worklist.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 540 1 0 "cc45e716_ce08_4d9a_abf3acf6d4b1fe00" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = Translate("Processed");
// }} ""
// {{ 541 1 0 "a56eb2b7_d791_423e_a922b224b344f945" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_Mass_per_sample = 0.0;
// }} ""
// {{ 542 1 0 "dd989588_33d3_4e51_a95a8863769ad5b7" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_VolumeToAspirate = 0.0;
// }} ""
// {{ 543 1 0 "b2595aad_a046_4e62_8b0c9d98cf6fe45b" "{B31F3537-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Template.WriteRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1473380096, MECC::IDS::stepNameFileWrite, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 544 1 0 "1897f6eb_5c84_4b97_8f4eeaedea18970d" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_int_NumberOfSamples_Source = loopCounter3;
// }} ""
// {{ 545 1 0 "16da2b6a_e0d9_4b8b_9d549fcd6ff3c8ba" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 546 1 0 "bd75d068_41f9_4241_96ea3c5623cbb91a" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Template.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Template.RemoveFields();
// }} ""
// {{ 547 1 0 "7c184606_d4e1_403d_b901d39e63766f23" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Worklist.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Worklist.RemoveFields();
// }} ""
// {{{ 548 1 0 "a99c3a30_3232_4caf_989b791430ed4cb1" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_PoolingFileOpen(t_str_OutputFilePath, Translate(""), 2, 1, t_hdlFile_Output);
// }} ""
// {{ 549 1 0 "3a4c0c87_42e1_4fe9_997970aa2366bb52" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Output.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Output.RemoveFields();
// }} ""
// {{{ 550 1 0 "88845c70_6796_4d27_8bd22b7b4e2d89f3" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_PoolingFileOpen(t_str_ExcludedSamplesFilePath, Translate(""), 2, 1, t_hdlFile_Excluded);
// }} ""
// {{ 551 1 0 "68def11f_045b_49e2_ab4e99abe4e444c6" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Excluded.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Excluded.RemoveFields();
// }} ""
// {{ 552 1 0 "ce05de80_08a4_4af9_8bcaecd3440e5b45" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 553 1 0 "45a2651a_00b7_426a_a5485038e5f867d1" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 554 1 0 "b57c7bd9_34b3_4016_bcd6c0ba2b0db4bf" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_str_MultipleUsedSampleSourcePositions = Translate("");
// }} ""
// {{ 555 1 0 "ac46456e_f3c6_4150_b4342691406d57bc" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_str_SampleSourcePosition.SetSize(0);
// }} ""
// {{ 556 1 0 "24040dd8_5804_4af5_b3a08aa83166104a" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_str_MultipleUsedSampleSourcePositions.SetSize(0);
// }} ""
// {{ 557 1 0 "eef1cd62_1558_4ef9_b6c04e150973f5c5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension == "csv")
{
// }} ""
// {{ 558 1 0 "a45fd5ec_0f29_4855_849897c3b5b86c12" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_B732345528164e0fBBAC9F5E2A5C0276 ;
err.Clear();
// }} ""
// {{ 559 1 0 "e246acfa_2a68_4274_aed982f47184c872" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Worklist.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Concentration", t_hdlFile_Worklist_Sample_Concentration, hslFloat);
t_hdlFile_Worklist.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
t_hdlFile_Worklist.AddField("Mass_PerPool", t_hdlFile_Worklist_MassPerPool, hslFloat);
t_hdlFile_Worklist.AddField("Volume_PerPool", t_hdlFile_Worklist_VolumePerPool, hslFloat);
t_hdlFile_Worklist.SetDelimiter(";");
if( 0 == t_hdlFile_Worklist.Open(i_str_WorklistFilePath, hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_WorklistFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 560 1 0 "a45fd5ec_0f29_4855_849897c3b5b86c12" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_B732345528164e0fBBAC9F5E2A5C0276 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{{ 561 1 0 "50770ceb_e494_4ad4_a6aeb393fca4bc71" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_DATA_IntegratedAbortHandler(l_strFunctionName, Translate("Normalization and Pooling Controller cannot open input worklist. Please review file structure and content, possibly required columns or entries are missing. System will abort"));
// }} ""
// {{{ 562 1 0 "d263e202_e53f_43a6_b1a5c570c7d17de7" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::FALSE);
// }} ""
// {{ 563 1 0 "a45fd5ec_0f29_4855_849897c3b5b86c12" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 564 1 0 "eef1cd62_1558_4ef9_b6c04e150973f5c5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 565 1 0 "e01b1fc1_c861_4473_84c890492442a61e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Worklist_Extension == "xls")
{
// }} ""
// {{ 566 1 0 "b1cacbcf_115d_4d0d_ba65ccbd46c1c4b8" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_E88AD7732FA14bca8B9EDDB24CCC6176 ;
err.Clear();
// }} ""
// {{ 567 1 0 "8f3cd852_bb70_46a2_8a29af203c5a4022" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
t_hdlFile_Worklist.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
t_hdlFile_Worklist.AddField("Sample_Concentration", t_hdlFile_Worklist_Sample_Concentration, hslFloat);
t_hdlFile_Worklist.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
t_hdlFile_Worklist.AddField("Mass_PerPool", t_hdlFile_Worklist_MassPerPool, hslFloat);
t_hdlFile_Worklist.AddField("Volume_PerPool", t_hdlFile_Worklist_VolumePerPool, hslFloat);
if( 0 == t_hdlFile_Worklist.Open(i_str_WorklistFilePath + " " + "Sheet1$", hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_WorklistFilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 568 1 0 "b1cacbcf_115d_4d0d_ba65ccbd46c1c4b8" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_E88AD7732FA14bca8B9EDDB24CCC6176 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{{ 569 1 0 "1d0e2cc4_005f_442b_b6121d22199eba06" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_DATA_IntegratedAbortHandler(l_strFunctionName, Translate("Normalization and Pooling Controller cannot open input worklist. Please review file structure and content, possibly required columns or entries are missing. System will abort"));
// }} ""
// {{{ 570 1 0 "d637f199_dcb6_4049_8724949a886b3bd0" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::FALSE);
// }} ""
// {{ 571 1 0 "b1cacbcf_115d_4d0d_ba65ccbd46c1c4b8" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 572 1 0 "e01b1fc1_c861_4473_84c890492442a61e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 573 1 0 "ae4489aa_d592_4651_bf1ac76c114a6b5d" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter3 = 0;
while (
   (t_hdlFile_Worklist.Eof() == 0)
)
{
loopCounter3 = loopCounter3 + 1;
// }} ""
// {{ 574 1 0 "340289ac_cd79_4827_a9077e06992c5937" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Worklist.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 575 1 0 "ca5cda55_40c5_43fe_b54fc10dec76c961" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_str_SampleSourcePosition.AddAsLast(t_hdlFile_Worklist_Sample_Position);
// }} ""
// {{ 576 1 0 "ae4489aa_d592_4651_bf1ac76c114a6b5d" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 577 1 0 "65b6b913_5e10_49b6_bfcc3a5058369b85" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Worklist.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Worklist.RemoveFields();
// }} ""
// {{ 578 1 0 "52eb6a40_2189_48f7_920139d1fa44af7d" "{DB5A2B39-67F2-4a78-A78F-DAF3FB056366}"
l_arr_str_SampleSourcePosition_copy=l_arr_str_SampleSourcePosition;
// }} ""
// {{{ 579 1 0 "6a1588de_179f_4e22_88a28480df7187af" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ARRAYTOOLS::get_distinct_from_array(l_arr_str_SampleSourcePosition, l_arr_str_SampleSourcePosition_distinct);
// }} ""
// {{ 580 1 0 "3a041a82_e8c0_49e3_bcb09b338a11cac3" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
l_int_NumberOfSamples=l_arr_str_SampleSourcePosition_distinct.GetSize();
// }} ""
// {{ 581 1 0 "13bb0934_07cc_4b8a_905afb4f26138a58" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(loopCounter3 = 0; loopCounter3 < l_int_NumberOfSamples;)
{
loopCounter3 = loopCounter3 + 1;
// }} ""
// {{{ 582 1 0 "46507576_bcc7_4ed6_97fdc0620207e461" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ARRAYTOOLS::ArrayVLookUp(l_arr_str_SampleSourcePosition, l_arr_str_SampleSourcePosition_copy, l_arr_str_SampleSourcePosition_distinct.ElementAt( loopCounter3 -1), l_arr_str_Temp);
// }} ""
// {{ 583 1 0 "117ea144_80bb_48eb_868f64bec83bcd1a" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
l_int_NumberOfUseThisSample=l_arr_str_Temp.GetSize();
// }} ""
// {{ 584 1 0 "5b7f6b49_31ce_4918_bd9d8d06fbbe6ed9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfUseThisSample > 1)
{
// }} ""
// {{ 585 1 0 "3dfc3329_e914_45b2_8d64b6977049859d" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_str_MultipleUsedSampleSourcePositions.AddAsLast(l_arr_str_SampleSourcePosition_distinct.ElementAt( loopCounter3 -1));
// }} ""
// {{ 586 1 0 "112a5ff8_f637_4f36_8138a0cf11b964b4" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_MultipleUsedSampleSourcePositions == "")
{
// }} ""
// {{ 587 1 0 "f298a865_e501_41f5_8c93ec2b66659e72" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_str_MultipleUsedSampleSourcePositions = l_arr_str_SampleSourcePosition_distinct.ElementAt( loopCounter3 -1);
// }} ""
// {{ 588 1 0 "112a5ff8_f637_4f36_8138a0cf11b964b4" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 589 1 0 "589152ec_bdc7_4642_b16640c0a938ddae" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_MultipleUsedSampleSourcePositions = StrConcat4(l_str_MultipleUsedSampleSourcePositions, Translate(", "), l_arr_str_SampleSourcePosition_distinct.ElementAt( loopCounter3 -1), Translate(""));
// }} ""
// {{ 590 1 0 "112a5ff8_f637_4f36_8138a0cf11b964b4" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 591 1 0 "5b7f6b49_31ce_4918_bd9d8d06fbbe6ed9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 592 1 0 "13bb0934_07cc_4b8a_905afb4f26138a58" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 593 1 0 "a48b4a74_36e6_46f8_9134707e59b3ba1e" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
l_int_NumberOfSamplesUsedMultipleTimes=l_arr_str_MultipleUsedSampleSourcePositions.GetSize();
// }} ""
// {{ 594 1 0 "0143f958_9d79_47c0_9e839c034fb31be0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfSamplesUsedMultipleTimes > 0)
{
// }} ""
// {{{ 595 1 0 "ad75fa55_f182_4aae_b14d16441686d95d" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceArray(TRACE_LEVEL_DEBUG, Translate("l_arr_str_MultipleUsedSampleSourcePositions: "), l_arr_str_MultipleUsedSampleSourcePositions);
// }} ""
// {{ 596 1 0 "0143f958_9d79_47c0_9e839c034fb31be0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 597 1 0 "45a2651a_00b7_426a_a5485038e5f867d1" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 598 1 0 "2a1902fe_e4ae_4d13_9be6948c5e9471a1" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 599 1 0 "fc4ccbd6_0a6c_4f6a_96355761b9b06e79" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_GetPoolInfo(t_str_TemplateFilePath, Translate(""), t_intTraceLevel, t_hdlFile_Template, 1, l_arr_str_Pool_Ids, l_arr_int_NumberOfSamplesPerPool, l_arr_flt_MassPerSampleInPool, l_arr_flt_MassPerPool, l_arr_flt_VolumePerPool);
// }} ""
// {{ 600 1 0 "0bed6d8b_7e73_4345_8d5485923ca0dd18" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
l_int_NumberOfPools=l_arr_str_Pool_Ids.GetSize();
// }} ""
// {{ 601 1 0 "2a1902fe_e4ae_4d13_9be6948c5e9471a1" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 602 1 0 "c3545eec_86a6_4ea1_ae299845055f979a" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_Repeat_Analysis = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{{ 603 1 0 "e62cd6ca_0cef_493e_9b0a9734cae5a211" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_PoolingFileOpen(t_str_ExcludedSamplesFilePath, Translate(""), 3, 1, t_hdlFile_Excluded);
// }} ""
// {{ 604 1 0 "504377a1_2f1e_4f44_9e48a432a4d842a5" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_int_TotalNumberOfSamples_Excluded = 0;
// }} ""
// {{ 605 1 0 "0beda212_219e_4f7f_9cffbf445eb215af" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ExcludeSample = ASWGLOBAL::BOOL::FALSE;
// }} ""
// {{ 606 1 0 "947c3be9_f406_4c0c_9aff0b1248cc24c2" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
l_int_Counter_RepeatAnalysis = 0;
while (l_bln_Repeat_Analysis == ASWGLOBAL::BOOL::TRUE)
{
l_int_Counter_RepeatAnalysis = l_int_Counter_RepeatAnalysis + 1;
// }} ""
// {{{ 607 1 0 "bdad58b2_8124_4e06_8a6f2d8d1aa5dd0c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_bln_FileExists = HSLExtensions::File::Exists(t_str_OutputFilePath);
// }} ""
// {{ 608 1 0 "def554fc_a6ce_434d_b9c9e7cc44a24b70" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_FileExists == ASWGLOBAL::BOOL::FALSE)
{
// }} ""
// {{{ 609 1 0 "379a22f3_51d6_47c0_bf0b709424023b28" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_PoolingFileOpen(t_str_OutputFilePath, Translate(""), 2, 1, t_hdlFile_Output);
// }} ""
// {{ 610 1 0 "e80a0194_a34c_40d7_81b519b7c1ad8a2f" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Output.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Output.RemoveFields();
// }} ""
// {{ 611 1 0 "def554fc_a6ce_434d_b9c9e7cc44a24b70" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 612 1 0 "52d4f59a_6a92_4430_be759aff6770d606" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_PoolingFileOpen(t_str_OutputFilePath, Translate(""), 3, 1, t_hdlFile_Output);
// }} ""
// {{ 613 1 0 "356e801d_6e7d_4f35_9d04084ca4c2c533" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_flt_TotalVolumePerPool.SetSize(0);
// }} ""
// {{ 614 1 0 "40a640c9_c05c_414a_b6f4f2a7b88bd4cf" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_flt_TotalVolumePerSample.SetSize(0);
// }} ""
// {{ 615 1 0 "6d5444d3_f187_4e1c_8ad7294c777edbae" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_flt_VolumeDiluent_PerPool.SetSize(0);
// }} ""
// {{ 616 1 0 "04c92c8b_0fb9_4925_942c0190a3642bc7" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_flt_TotalVolumePerSample.SetSize(l_int_NumberOfSamplesUsedMultipleTimes);
// }} ""
// {{ 617 1 0 "54333397_e1b3_406b_ac88ba78c0854074" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_int_TotalNumberOfUsePerSample.SetSize(0);
// }} ""
// {{ 618 1 0 "bb00df09_4d3f_4ae8_b6144b21b757f52d" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_int_TotalNumberOfUsePerSample.SetSize(l_int_NumberOfSamplesUsedMultipleTimes);
// }} ""
// {{ 619 1 0 "99baff8a_a389_4683_af8bcff590eaa897" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
o_arr_flt_Volumes_Pools.SetSize(0);
// }} ""
// {{ 620 1 0 "51ef7807_d4e8_4a56_9e51e0ce97dc49df" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
o_arr_str_PostionIDsPools.SetSize(0);
// }} ""
// {{ 621 1 0 "4568ea61_6551_405b_b347d199a2f98200" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_int_NumberOfSamples_Excluded = 0;
// }} ""
// {{{ 622 1 0 "099b7dcc_9192_472c_865e61acbab8966f" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqRemoveAll(o_seq_Asp_Samples);
// }} ""
// {{{ 623 1 0 "c8bf9f40_5282_4701_a6264dd2efe12843" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqRemoveAll(o_seq_Disp_Samples);
// }} ""
// {{{ 624 1 0 "8c7cadb9_76e5_4086_b8a1ecdf96a2b21a" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqRemoveAll(l_seq_Disp_Diluent);
// }} ""
// {{ 625 1 0 "ff5ee60d_36c1_45c0_baf2bcda57df7c3f" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_flt_Volumes_Sample.SetSize(0);
// }} ""
// {{ 626 1 0 "db24247c_590b_486f_97303f5d1261727b" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(l_int_Counter_Pool = 0; l_int_Counter_Pool < l_int_NumberOfPools;)
{
l_int_Counter_Pool = l_int_Counter_Pool + 1;
// }} ""
// {{ 627 1 0 "06362659_8174_411c_9d9f9a9cbd368e55" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ExcludePool = ASWGLOBAL::BOOL::FALSE;
// }} ""
// {{ 628 1 0 "9474fa8a_6dba_48fc_87f48b73971af150" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_PoolProcessed = ASWGLOBAL::BOOL::FALSE;
// }} ""
// {{ 629 1 0 "deca3b9a_06b3_495e_b681835f0df17d86" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_VolumePerPool = 0.0;
// }} ""
// {{ 630 1 0 "b599b1c7_9800_42fa_bfe21848ba323b02" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
l_str_CurrentPoolId=l_arr_str_Pool_Ids.GetAt(l_int_Counter_Pool-1);
// }} ""
// {{ 631 1 0 "6def6dc1_8c36_422d_b11dc7f091533d36" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (t_intTraceLevel == TRACE_LEVEL_DEBUG)
{
// }} ""
Trace("*****************************************","");
Trace("------> Pool Id = ",l_str_CurrentPoolId);
Trace("------> Data analysis number: ", l_int_Counter_RepeatAnalysis);
Trace("","");
// {{ 633 1 0 "6def6dc1_8c36_422d_b11dc7f091533d36" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 634 1 0 "a7adf725_ad64_4639_9249ef06deebb129" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
l_flt_TotalVolumeCurrentPool=l_arr_flt_VolumePerPool.GetAt(l_int_Counter_Pool-1);
// }} ""
// {{ 635 1 0 "479323d3_1dfd_43a7_a83898e40a2d99c3" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 636 1 0 "72671827_15d1_44b7_909fe452b82c60e5" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_LabwareID_Pooling = SeqGetLabwareId(i_seq_Pooling);
// }} ""
// {{{ 637 1 0 "fd3c819c_8c27_46c6_b36e0fa0aed3b6ce" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_LabwareID_SamplePlate = SeqGetLabwareId(i_seq_SourceSamplePlate);
// }} ""
// {{ 638 1 0 "776283d7_29b3_4fb2_ab7266af4160bf84" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_TotalVolumeCurrentPool == 0)
{
// }} ""
// {{ 639 1 0 "36d507d6_0e72_459d_a2e8cd96fa0813df" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_MaximumVolumePerPool = i_flt_MaximumVolumePerContainer;
// }} ""
// {{ 640 1 0 "776283d7_29b3_4fb2_ab7266af4160bf84" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 641 1 0 "ac24a913_aeb5_488c_8f55bb52f0cc87fb" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_MaximumVolumePerPool = l_flt_TotalVolumeCurrentPool;
// }} ""
// {{ 642 1 0 "776283d7_29b3_4fb2_ab7266af4160bf84" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 643 1 0 "a35ba875_b062_4767_9c96b260acfaa5be" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_DEBUG, Translate("l_flt_MaximumVolumePerPool: "), l_flt_MaximumVolumePerPool);
// }} ""
// {{ 644 1 0 "8f390216_723c_47db_820d8f2b7c8510e0" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 645 1 0 "1e4c64f9_315b_4ddc_8c5ebf332d942e2c" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 646 1 0 "cebd74a0_17f4_4008_9040bebb6ada94f8" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_TotalVolumeCurrentPool > i_flt_MaximumVolumePerContainer)
{
// }} ""
// {{ 647 1 0 "174ecacb_dd9a_4150_bf8a2801f071dd5c" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ExcludePool = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 648 1 0 "5fea0cd9_fca7_4628_b25936033a08b001" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_str_ExcludePool = Translate("Excluded - Total Volume of Pool exceeds maximum labware capacity");
// }} ""
// {{ 649 1 0 "cebd74a0_17f4_4008_9040bebb6ada94f8" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 650 1 0 "8f390216_723c_47db_820d8f2b7c8510e0" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 651 1 0 "479323d3_1dfd_43a7_a83898e40a2d99c3" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 652 1 0 "47d0ede9_b885_4c88_8abcbab30491855f" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_flt_TotalVolumePerPool.SetSize(l_int_NumberOfPools);
// }} ""
// {{ 653 1 0 "dea95874_271d_4439_9f35125b88a981c0" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_flt_VolumeDiluent_PerPool.SetSize(l_int_NumberOfPools);
// }} ""
l_strSQL_Sentence1 = StrConcat12("Select * from [Sheet1$] where [Target_Well] = '",l_str_CurrentPoolId,"' and [SampleStatus] = 'Processed'","","","","","","","","","");
// {{{ 655 1 0 "2fe4f674_b7f2_430d_a07e0972d9304390" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_DEBUG, Translate("l_strSQL_Sentence1: "), l_strSQL_Sentence1);
// }} ""
// {{{ 656 1 0 "8bc88fc6_2afd_4703_b90f73593500cb3a" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_DEBUG, Translate("t_str_TemplateFilePath: "), t_str_TemplateFilePath);
// }} ""
// {{{ 657 1 0 "47f4d673_c1d6_4349_859e60938a4d6a70" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
l_int_ReturnValue = _GetPoolInfo(t_str_TemplateFilePath, l_strSQL_Sentence1, ASWGLOBAL::BOOL::FALSE, t_hdlFile_Template, 1, l_arr_str_Pool_Ids_current, l_arr_int_NumberOfSamplesPerPool_current, l_arr_flt_MassPerSampleInPool_current, l_arr_flt_MassPerPool_current, l_arr_flt_VolumePerPool_current);
// }} ""
// {{ 658 1 0 "084b1342_8932_4ac8_8ffabd064610acdd" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_ReturnValue == -1)
{
// }} ""
// {{ 659 1 0 "c1b96ef2_71a8_4256_92cf7f5eb2cd80e3" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ExcludePool = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 660 1 0 "6f20feaf_b38e_4d90_86ae68f4c5b16f67" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_str_ExcludePool = Translate("Excluded - Total Mass in Pool not equal.");
// }} ""
// {{ 661 1 0 "084b1342_8932_4ac8_8ffabd064610acdd" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 662 1 0 "9a433c9f_b7c8_4701_b979337c4514c2b4" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_ReturnValue == -2)
{
// }} ""
// {{ 663 1 0 "571e419f_81ba_43da_b4099312aea613f5" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ExcludePool = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 664 1 0 "afa8aed1_2ca3_45dc_9010665311f363d0" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_str_ExcludePool = Translate("Excluded - Total Volume in Pool not equal.");
// }} ""
// {{ 665 1 0 "9a433c9f_b7c8_4701_b979337c4514c2b4" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 666 1 0 "084b1342_8932_4ac8_8ffabd064610acdd" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 667 1 0 "1179a12c_deb7_426b_8469254d47120ed2" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_PoolingFileOpen(t_str_TemplateFilePath, l_strSQL_Sentence1, 1, 1, t_hdlFile_Template);
// }} ""
// {{ 668 1 0 "ed73d260_d196_4e20_b73b96df84ed7d62" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter1 = 0;
while (
   (t_hdlFile_Template.Eof() == 0)
)
{
loopCounter1 = loopCounter1 + 1;
// }} ""
// {{ 669 1 0 "b67cd391_9c05_4df1_a3d5dae0323543db" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Template.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 670 1 0 "eea47f8a_6422_43c8_83dfb22699fd36ae" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (t_intTraceLevel == TRACE_LEVEL_DEBUG)
{
// }} ""
// {{{ 671 1 0 "9d9cd0c3_de7b_4351_a79194edaae38dd2" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_10(t_intTraceLevel, Translate(" t_hdlFile_Worklist_Sample_ID: "), t_hdlFile_Worklist_Sample_ID, Translate("  t_hdlFile_Worklist_Sample_Position: "), t_hdlFile_Worklist_Sample_Position, Translate("  t_hdlFile_Worklist_Sample_Concentration: "), t_hdlFile_Worklist_Sample_Concentration, Translate("  t_hdlFile_Worklist_Target_Well: "), t_hdlFile_Worklist_Target_Well, Translate("  t_hdlFile_Worklist_OriginalSampleVolume: "), t_hdlFile_Worklist_OriginalSampleVolume);
// }} ""
// {{ 672 1 0 "eea47f8a_6422_43c8_83dfb22699fd36ae" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 673 1 0 "26a56493_c3b0_4f82_b6ddcb19cbd17e7c" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_Volume_SampleAspirate = 0.0;
// }} ""
// {{ 674 1 0 "7df62ad5_e079_4077_9c21eaf0960df5b3" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_Volume_DiluentAspirate = 0.0;
// }} ""
// {{ 675 1 0 "e24ba8ac_a901_42f7_9de01f83eaee361c" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_flt_Volume_Total = 0.0;
// }} ""
// {{{ 676 1 0 "6e5ce3d3_cb42_4e77_9733214d51928e1f" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ARRAYTOOLS::ArrayVLookUp(l_arr_flt_MassPerSampleInPool_current, l_arr_str_Pool_Ids_current, t_hdlFile_Worklist_Target_Well, l_arr_flt_MassForThisSample);
// }} ""
// {{ 677 1 0 "0f4a44a2_bb68_428f_9d8c59aeef0b19aa" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
l_flt_CurrentMass=l_arr_flt_MassForThisSample.GetAt(1-1);
// }} ""
// {{ 678 1 0 "7e161924_f43a_40cb_8b6398f341a99d9e" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_Mass_per_sample = l_flt_CurrentMass;
// }} ""
l_flt_Volume_SampleAspirate = l_flt_CurrentMass/t_hdlFile_Worklist_Sample_Concentration;
// {{ 680 1 0 "566976b6_6b8b_47d5_8d85c390238a03dd" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 681 1 0 "0e240bc3_ecb6_435e_a729dab79ef9fce1" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
l_flt_Volume_SampleAspirate = l_flt_Volume_SampleAspirate * 1000;
// }} ""
// {{{ 682 1 0 "13d1c09d_962a_4b56_9a3f53be17fb7e91" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_flt_Volume_SampleAspirate = MthFloor(l_flt_Volume_SampleAspirate);
// }} ""
// {{ 683 1 0 "07fd7bc3_6e37_4d3c_898842cb56dcd39f" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
l_flt_Volume_SampleAspirate = l_flt_Volume_SampleAspirate / (1000 * 1.0);
// }} ""
// {{ 684 1 0 "566976b6_6b8b_47d5_8d85c390238a03dd" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 685 1 0 "2ef1841f_278f_4053_b177fd64fe3337cd" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_VolumeToAspirate = l_flt_Volume_SampleAspirate;
// }} ""
// {{ 686 1 0 "d7c13e8a_f70b_4171_96748ef127f1344a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_ExcludePool == ASWGLOBAL::BOOL::FALSE)
{
// }} ""
// {{ 687 1 0 "0f31e326_151c_4273_8938b05a3c4254e4" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_Volume_SampleAspirate >= l_flt_Volume_MinimumToPipette)
{
// }} ""
// {{ 688 1 0 "0f4f7b1f_ead8_4d31_bc5def03958c8e06" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_Volume_SampleAspirate <= t_hdlFile_Worklist_OriginalSampleVolume)
{
// }} ""
// {{ 689 1 0 "f160699e_4462_45cd_aefdd64296958f66" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
l_flt_VolumePerPool=l_arr_flt_TotalVolumePerPool.GetAt(l_int_Counter_Pool-1);
// }} ""
// {{ 690 1 0 "b970ba21_4463_47c1_ac0ef89c6b3be1c4" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
l_flt_VolumePerPool = l_flt_VolumePerPool + l_flt_Volume_SampleAspirate;
// }} ""
// {{ 691 1 0 "6f9b3c44_bb17_488c_9e236715030cd68c" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_VolumePerPool <= l_flt_MaximumVolumePerPool)
{
// }} ""
// {{ 692 1 0 "79a8687a_b444_4e9c_8d795abc073ca980" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ExcludeSample = ASWGLOBAL::BOOL::FALSE;
// }} ""
// {{ 693 1 0 "1562d092_c4cb_4d6a_b4af10b6c64620ad" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 694 1 0 "86f7283f_d1de_4dd9_b1e6f26f201779dd" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(loopCounter2 = 0; loopCounter2 < l_int_NumberOfSamplesUsedMultipleTimes;)
{
loopCounter2 = loopCounter2 + 1;
// }} ""
// {{ 695 1 0 "a6a0095e_2bfd_49a4_88aec88e2b0a1a32" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (t_hdlFile_Worklist_Sample_Position == l_arr_str_MultipleUsedSampleSourcePositions.ElementAt( loopCounter2 -1))
{
// }} ""
// {{ 696 1 0 "402aee48_ee9e_4fea_8c3c4aee78e8ddeb" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
l_flt_TotalVolumePerSample=l_arr_flt_TotalVolumePerSample.GetAt(loopCounter2-1);
// }} ""
// {{ 697 1 0 "77462394_6693_413e_bedeb7bdcc0ba9bb" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
l_flt_TotalVolumePerSample = l_flt_TotalVolumePerSample + l_flt_Volume_SampleAspirate;
// }} ""
// {{ 698 1 0 "d9bda727_dc89_45aa_a695dbb25f84a90d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_TotalVolumePerSample <= t_hdlFile_Worklist_OriginalSampleVolume)
{
// }} ""
// {{ 699 1 0 "bff94396_db91_45de_85540a6f3dcc9891" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_flt_TotalVolumePerSample.SetAt(loopCounter2-1, l_flt_TotalVolumePerSample);
// }} ""
// {{ 700 1 0 "d9bda727_dc89_45aa_a695dbb25f84a90d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 701 1 0 "0d79c788_03ab_4d65_942d8b08d59866ef" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = Translate("Excluded - Sample used multiple times and the original sample volume is not sufficient for all pools");
// }} ""
// {{ 702 1 0 "4d58f108_73af_466f_96499da61944d871" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ExcludeSample = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 703 1 0 "d9bda727_dc89_45aa_a695dbb25f84a90d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 704 1 0 "30d06a06_96c1_4f99_aaf92aec49182576" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 705 1 0 "a6a0095e_2bfd_49a4_88aec88e2b0a1a32" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 706 1 0 "86f7283f_d1de_4dd9_b1e6f26f201779dd" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 707 1 0 "1562d092_c4cb_4d6a_b4af10b6c64620ad" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 708 1 0 "6e4201ff_6527_4c49_b5d9da7b3b8837d8" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_ExcludeSample == ASWGLOBAL::BOOL::FALSE)
{
// }} ""
// {{ 709 1 0 "39e15f69_5098_4bae_86045c1b1a0d325c" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_flt_TotalVolumePerPool.SetAt(l_int_Counter_Pool-1, l_flt_VolumePerPool);
// }} ""
// {{ 710 1 0 "dc821ff2_3187_4ea8_afc500d5b3bc5dce" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = Translate("Processed");
// }} ""
// {{ 711 1 0 "5adc179d_1830_4467_af291cab06b2e959" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 712 1 0 "16ccc8d5_1fe7_4cee_a809f681de4919ac" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqAdd(o_seq_Asp_Samples, l_str_LabwareID_SamplePlate, t_hdlFile_Worklist_Sample_Position);
// }} ""
// {{ 713 1 0 "62448bb2_0c56_4e0c_8886e95b3ad15a70" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 714 1 0 "535ccc56_3b7e_4e8c_a28d65996cb2bd66" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqAdd(o_seq_Disp_Samples, l_str_LabwareID_Pooling, t_hdlFile_Worklist_Target_Well);
// }} ""
// {{ 715 1 0 "8920cd0a_eba8_48a4_92fc03fb4dc4310b" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 716 1 0 "6192de32_77a6_4c20_a1353f98fe031d11" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_flt_Volumes_Sample.AddAsLast(l_flt_Volume_SampleAspirate);
// }} ""
// {{ 717 1 0 "22af4160_dc4a_4dc0_abe744feddb4ef7b" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_PoolProcessed = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 718 1 0 "6e4201ff_6527_4c49_b5d9da7b3b8837d8" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 719 1 0 "6f9b3c44_bb17_488c_9e236715030cd68c" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 720 1 0 "52377081_f1cf_495e_923532f1b0bec5e3" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = Translate("Excluded - Maximum volume per pool has been exceeded");
// }} ""
// {{ 721 1 0 "a2b763ea_3b96_47d3_b7db8fc74ec45943" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ExcludeSample = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 722 1 0 "6f9b3c44_bb17_488c_9e236715030cd68c" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 723 1 0 "0f4f7b1f_ead8_4d31_bc5def03958c8e06" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 724 1 0 "1a6c393e_07b4_47ae_b0b52da06e2ee067" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = Translate("Excluded - Sample concentration too low (Not enough volume to aspirate sample)");
// }} ""
// {{ 725 1 0 "217d543d_228e_4bca_8db497200dd4ea5d" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ExcludeSample = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 726 1 0 "0f4f7b1f_ead8_4d31_bc5def03958c8e06" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 727 1 0 "0f31e326_151c_4273_8938b05a3c4254e4" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 728 1 0 "68af8c8f_4031_44b3_b4d81b03ecf0bdd0" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = Translate("Excluded - Sample concentration too high (Sample volume to aspirate below minimum allowed)");
// }} ""
// {{ 729 1 0 "e3ae0d3c_d0b3_443c_b7a708da9500fa46" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ExcludeSample = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 730 1 0 "0f31e326_151c_4273_8938b05a3c4254e4" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 731 1 0 "d7c13e8a_f70b_4171_96748ef127f1344a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 732 1 0 "937bc637_0f2d_4b68_8c9c6defe0c68f27" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_ExcludeSample = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 733 1 0 "d5f8ca60_8389_4622_bdffcaa88f2c9da7" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_hdlFile_Worklist_SampleStatus = l_str_ExcludePool;
// }} ""
// {{ 734 1 0 "d7c13e8a_f70b_4171_96748ef127f1344a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 735 1 0 "6d4a9706_09be_49c5_bea990f25b826fcb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_ExcludeSample == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{ 736 1 0 "16af5323_a8af_4a4f_b4a3c9f54321a56a" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
l_int_NumberOfSamples_Excluded = l_int_NumberOfSamples_Excluded + 1;
// }} ""
// {{ 737 1 0 "d30b64e9_bdd7_4547_8969631bcb9c8481" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
l_int_TotalNumberOfSamples_Excluded = l_int_TotalNumberOfSamples_Excluded + 1;
// }} ""
// {{ 738 1 0 "2eab94c7_32c0_4ca7_980507eecbe8b969" "{B31F3537-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Excluded.WriteRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1473380096, MECC::IDS::stepNameFileWrite, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 739 1 0 "6d4a9706_09be_49c5_bea990f25b826fcb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 740 1 0 "174d560c_73d6_4d82_b32b3ab2c0592743" "{B31F3537-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Output.WriteRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1473380096, MECC::IDS::stepNameFileWrite, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 741 1 0 "6d4a9706_09be_49c5_bea990f25b826fcb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 742 1 0 "ed73d260_d196_4e20_b73b96df84ed7d62" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 743 1 0 "1b54e567_2eaf_4c52_bd5ab0e06a9838fe" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 744 1 0 "88a9f207_eb23_4826_b5ed997212ce749e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_TotalVolumeCurrentPool > 0)
{
// }} ""
// {{ 745 1 0 "1a3a2b6f_f740_492c_aaef1cb537e0074c" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
l_flt_VolumeDiluent = l_flt_TotalVolumeCurrentPool - l_flt_VolumePerPool;
// }} ""
// {{ 746 1 0 "d40ab98b_ee5b_412e_a81964aaa2f497b4" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_VolumeDiluent != l_flt_TotalVolumeCurrentPool)
{
// }} ""
// {{ 747 1 0 "62bc5758_8fd7_4865_b6df4b7974447cc0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_VolumeDiluent >= l_flt_Volume_MinimumToPipetteDiluent)
{
// }} ""
// {{ 748 1 0 "a75d7cb1_e3e9_4a5a_a7bc29245309e9d9" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arr_flt_VolumeDiluent_PerPool.SetAt(l_int_Counter_Pool-1, l_flt_VolumeDiluent);
// }} ""
// {{ 749 1 0 "c2fb7e73_9030_4a52_82c3d901213f9ba7" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 750 1 0 "6831a51d_354d_42dd_a811165f1c41a3a4" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqAdd(l_seq_Disp_Diluent, l_str_LabwareID_Pooling, t_hdlFile_Worklist_Target_Well);
// }} ""
// {{ 751 1 0 "62bc5758_8fd7_4865_b6df4b7974447cc0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 752 1 0 "d40ab98b_ee5b_412e_a81964aaa2f497b4" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 753 1 0 "88a9f207_eb23_4826_b5ed997212ce749e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 754 1 0 "1b54e567_2eaf_4c52_bd5ab0e06a9838fe" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 755 1 0 "48245acd_573a_47de_95d8b04f5030531c" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_PoolProcessed == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{ 756 1 0 "38b7487a_1b7d_442f_aeb6608ce1fd904e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_TotalVolumeCurrentPool > 0)
{
// }} ""
// {{ 757 1 0 "2816f25b_0f84_4904_aaed6e52bdb63fb3" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
o_arr_flt_Volumes_Pools.AddAsLast(l_flt_TotalVolumeCurrentPool);
// }} ""
// {{ 758 1 0 "38b7487a_1b7d_442f_aeb6608ce1fd904e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 759 1 0 "cf47338c_c727_40c5_a835c283c18d193b" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
o_arr_flt_Volumes_Pools.AddAsLast(l_flt_VolumePerPool);
// }} ""
// {{ 760 1 0 "38b7487a_1b7d_442f_aeb6608ce1fd904e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 761 1 0 "955e7f09_773b_4bcb_a06f8ec2f7e0b45e" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
o_arr_str_PostionIDsPools.AddAsLast(t_hdlFile_Worklist_Target_Well);
// }} ""
// {{ 762 1 0 "48245acd_573a_47de_95d8b04f5030531c" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 763 1 0 "07d7f611_1fd1_461f_a196bf5204b3eca4" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (t_intTraceLevel == TRACE_LEVEL_DEBUG)
{
// }} ""
// {{{ 764 1 0 "a2774b78_faa2_49f6_aaa0c80e8c0f11df" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
Util2::Debug::TraceArray_4(Translate("Well / Number Of Samples / Mass per Sample in Pool / Total Volume per Pool: "), l_arr_str_Pool_Ids_current, l_arr_int_NumberOfSamplesPerPool_current, l_arr_flt_MassPerSampleInPool_current, l_arr_flt_TotalVolumePerPool);
// }} ""
// {{ 765 1 0 "07d7f611_1fd1_461f_a196bf5204b3eca4" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 766 1 0 "9ce010b0_7421_4937_9ad279ffefd4cc7c" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Template.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Template.RemoveFields();
// }} ""
// {{ 767 1 0 "db24247c_590b_486f_97303f5d1261727b" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 768 1 0 "0ff46c79_7e21_497f_a69c94d36b54c449" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfSamples_Excluded > 0)
{
// }} ""
// {{ 769 1 0 "8a25010b_ee61_4f3c_82689520cb6bca86" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_Repeat_Analysis = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 770 1 0 "d30c7bed_6a7e_48c7_879a626392f02a69" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Output.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Output.RemoveFields();
// }} ""
// {{{ 771 1 0 "cf684e2c_5d92_40d1_bf5b266943cad436" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLExtensions::File::Delete(t_str_TemplateFilePath);
// }} ""
// {{{ 772 1 0 "d0a5bc5a_9005_4657_a3e467d4c75be6b3" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLExtensions::File::Copy(t_str_OutputFilePath, t_str_TemplateFilePath, ASWGLOBAL::BOOL::TRUE);
// }} ""
// {{{ 773 1 0 "3baa9672_f7e7_460b_90b123f425aaf0b2" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLExtensions::File::Delete(t_str_OutputFilePath);
// }} ""
// {{ 774 1 0 "0ff46c79_7e21_497f_a69c94d36b54c449" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 775 1 0 "1c777bda_d719_428f_b4fd80836087802a" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_Repeat_Analysis = ASWGLOBAL::BOOL::FALSE;
// }} ""
// {{ 776 1 0 "ca47a1b4_7c0b_48ef_8da542b7e4ff6ae0" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Output.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Output.RemoveFields();
// }} ""
// {{ 777 1 0 "0ff46c79_7e21_497f_a69c94d36b54c449" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 778 1 0 "947c3be9_f406_4c0c_9aff0b1248cc24c2" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 779 1 0 "ada77375_386a_42fa_87f54cfde978577f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfSamplesUsedMultipleTimes != 0)
{
// }} ""
// {{{ 780 1 0 "95d716db_f006_492e_b6a3a104193c162b" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
Util2::Debug::TraceArray_3(Translate("l_arr_str_MultipleUsedSampleSourcePositions / l_arr_int_TotalNumberOfUsePerSample / l_arr_flt_TotalVolumePerSample"), l_arr_str_MultipleUsedSampleSourcePositions, l_arr_int_TotalNumberOfUsePerSample, l_arr_flt_TotalVolumePerSample);
// }} ""
// {{ 781 1 0 "ada77375_386a_42fa_87f54cfde978577f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 782 1 0 "1578ec15_abc8_4de4_a8a44969c9c58c0c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLExtensions::File::Delete(t_str_TemplateFilePath);
// }} ""
// {{ 783 1 0 "bd58d285_2008_46a6_ade4cb874e29ad8a" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 784 1 0 "69fd3004_99b1_4b31_b64d9860ca759279" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arr_strTokens.SetSize(0);
// }} ""
Trace("l_int_TotalNumberOfSamples_Excluded:",l_int_TotalNumberOfSamples_Excluded);
// {{ 786 1 0 "cc2ddda7_affb_444c_9d6ec58a5d9741db" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_TotalNumberOfSamples_Excluded > 0)
{
// }} ""
// {{{ 787 1 0 "12e1bc52_e0e8_4ffd_91a36759c159f806" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_PoolingFileOpen(t_str_OutputFilePath, Translate(""), 3, 1, t_hdlFile_Output);
// }} ""
// {{{ 788 1 0 "fee486f4_513f_43b1_8be633ab833c74b0" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_PoolingFileOpen(t_str_ExcludedSamplesFilePath, Translate(""), 1, 1, t_hdlFile_Excluded);
// }} ""
// {{ 789 1 0 "6bf15235_c139_4f14_bc4a825c0dd6ca48" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter3 = 0;
while (
   (t_hdlFile_Excluded.Eof() == 0)
)
{
loopCounter3 = loopCounter3 + 1;
// }} ""
// {{ 790 1 0 "d5de40c1_01be_408d_b2efd5aeb68938be" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Excluded.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 791 1 0 "ad9b7200_e630_4ce8_b6d50e36aafb691b" "{B31F3537-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == t_hdlFile_Output.WriteRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1473380096, MECC::IDS::stepNameFileWrite, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 792 1 0 "6bf15235_c139_4f14_bc4a825c0dd6ca48" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 793 1 0 "e259f565_7905_4c3f_87a09ff69ca855db" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Excluded.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Excluded.RemoveFields();
// }} ""
// {{ 794 1 0 "0cebcafd_e775_4ce5_8af4aa3ada445d57" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Output.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Output.RemoveFields();
// }} ""
// {{{ 795 1 0 "b1c860ec_8967_4c2f_bd61c028ee204fd4" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLExtensions::File::Delete(t_str_ExcludedSamplesFilePath);
// }} ""
// {{ 796 1 0 "dc4d0abd_b0e7_474b_91b8e6d14097a5e0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_TotalNumberOfSamples_Excluded == l_int_NumberOfSamples_Source)
{
// }} ""
// {{{ 797 1 0 "d2d4982b_8c86_42ad_bd22c3aae853b7d0" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Message = StrConcat12(Translate("Number of samples excluded for this run = "), l_int_TotalNumberOfSamples_Excluded, Translate("\n\nALL SAMPLES ARE EXCLUDED. Please review worklist and input parameters "), Translate("\n\nPress RETRY to load a new worklist."), Translate("\nPress CANCEL to abort the run."), Translate(""), Translate(""), Translate(""), Translate(""), Translate(""), Translate(""), Translate(""));
// }} ""
// {{{ 798 1 0 "aec93f24_0bad_40ca_93967e33d68883a3" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
STRTOKENIZE::StrTokenize(l_strFunctionName, Translate("::"), l_arr_strTokens, ASWGLOBAL::BOOL::TRUE);
// }} ""
// {{{ 799 1 0 "ec0b5b75_5983_4518_b36fda0a825c3615" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_int_ReturnValue = VectorCustomDialogs::MessageDialog(l_arr_strTokens.ElementAt( 3 -1), 3, 5, 0, 0, 0, l_str_Message);
// }} ""
// {{ 800 1 0 "e5e2274f_2979_4fba_b680595ede3557fa" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_ReturnValue == 4)
{
// }} ""
// {{{ 801 1 0 "ab5769d0_3d4b_4827_93a34e5791532523" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_Display_InputWorklist_Dialog(i_str_WorklistFilePath);
// }} ""
// {{ 802 1 0 "e5e2274f_2979_4fba_b680595ede3557fa" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 803 1 0 "da098870_b6ff_4587_ace0325759d4dd28" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_ReturnValue == 2)
{
// }} ""
// {{{ 804 1 0 "47ab37fc_ed06_4e9d_b76d04f31596ccd0" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::DIALOG::ABORT);
// }} ""
// {{ 805 1 0 "da098870_b6ff_4587_ace0325759d4dd28" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 806 1 0 "e5e2274f_2979_4fba_b680595ede3557fa" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 807 1 0 "dc4d0abd_b0e7_474b_91b8e6d14097a5e0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 808 1 0 "195cdba4_5a8f_4e32_8cf1544ccfe81b68" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfSamplesUsedMultipleTimes != 0)
{
// }} ""
// {{{ 809 1 0 "752780a8_3776_48f4_87c5209d8b21f7ed" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Message = StrConcat12(Translate("Number of samples excluded for this run = "), l_int_TotalNumberOfSamples_Excluded, Translate("\n\nATTENTION: Remaining samples in pools with excluded samples will be adjusted to the new number of samples per pool. The total mass of the pool will stay the same!"), Translate("\n\nData has been logged into the following file: "), Translate("\n"), t_str_OutputFilePath, Translate("\n\nPlease note that "), l_int_NumberOfSamplesUsedMultipleTimes, Translate(" samples ("), l_str_MultipleUsedSampleSourcePositions, Translate(") are used multiple times."), Translate(""));
// }} ""
// {{ 810 1 0 "195cdba4_5a8f_4e32_8cf1544ccfe81b68" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 811 1 0 "54deed80_d927_40b4_acf1ec280a9a0558" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Message = StrConcat12(Translate("Number of samples excluded for this run = "), l_int_TotalNumberOfSamples_Excluded, Translate("\n"), Translate("\n\nATTENTION: Remaining samples in pools with excluded samples will be adjusted to the new number of samples per pool. The total mass of the pool will stay the same!"), Translate("\n\nData has been logged into the following file: "), Translate("\n"), t_str_OutputFilePath, Translate(""), Translate(""), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 812 1 0 "195cdba4_5a8f_4e32_8cf1544ccfe81b68" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
Trace("l_str_Message:",l_str_Message);
// {{{ 814 1 0 "ff806420_d66a_4881_ad04b05d8f341cda" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Message = StrConcat12(l_str_Message, Translate(""), Translate(""), Translate(""), Translate(""), Translate(""), Translate(""), Translate(""), Translate("\n\nPress IGNORE to continue run without excluded samples."), Translate("\nPress RETRY to load a new worklist"), Translate("\nPress ABORT to abort the run"), Translate(""));
// }} ""
// {{ 815 1 0 "7d033871_d079_4982_b05a03be01246a8b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_bln_AllowCostumerIntervention == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{{ 816 1 0 "0191300b_7516_49fb_bd391b979bd9ef61" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
STRTOKENIZE::StrTokenize(l_strFunctionName, Translate("::"), l_arr_strTokens, ASWGLOBAL::BOOL::TRUE);
// }} ""
// {{{ 817 1 0 "4c533061_8048_4f5f_b34833ef9d76afad" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_int_ReturnValue = VectorCustomDialogs::MessageDialog(l_arr_strTokens.ElementAt( 3 -1), 3, 7, 0, 0, 0, l_str_Message);
// }} ""
// {{ 818 1 0 "e714c1fd_e195_4bb4_8c1b571eb0e7690d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_ReturnValue == 4)
{
// }} ""
// {{{ 819 1 0 "abcc44d2_b728_45d2_a4ea5d9ef7c6d86c" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_Display_InputWorklist_Dialog(i_str_WorklistFilePath);
// }} ""
// {{ 820 1 0 "e714c1fd_e195_4bb4_8c1b571eb0e7690d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 821 1 0 "9006c8ff_cf56_4b07_86d5a1fcf4608d73" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_ReturnValue == 5)
{
// }} ""
// {{ 822 1 0 "cc509474_f717_4cfa_88be5389cda4c698" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 823 1 0 "9006c8ff_cf56_4b07_86d5a1fcf4608d73" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 824 1 0 "3e8b58f9_3362_4b2d_9a0b7872d6dc0998" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::DIALOG::ABORT);
// }} ""
// {{ 825 1 0 "9006c8ff_cf56_4b07_86d5a1fcf4608d73" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 826 1 0 "e714c1fd_e195_4bb4_8c1b571eb0e7690d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 827 1 0 "7d033871_d079_4982_b05a03be01246a8b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 828 1 0 "510d84a5_741d_4104_a3099b142f427c5d" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 829 1 0 "7d033871_d079_4982_b05a03be01246a8b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 830 1 0 "dc4d0abd_b0e7_474b_91b8e6d14097a5e0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 831 1 0 "cc2ddda7_affb_444c_9d6ec58a5d9741db" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 832 1 0 "e40d927b_c2a4_4516_a654fa3129618378" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfSamplesUsedMultipleTimes != 0)
{
// }} ""
// {{{ 833 1 0 "577b8f93_1c36_4e43_bef55cf0e0deb792" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Message = StrConcat12(Translate("Please note that "), l_int_NumberOfSamplesUsedMultipleTimes, Translate(" samples ("), l_str_MultipleUsedSampleSourcePositions, Translate(") are used multiple times"), Translate(""), Translate(""), Translate(""), Translate(""), Translate("\n\nPress IGNORE to continue run with samples used multiple times."), Translate("\nPress RETRY to load a new worklist."), Translate("\nPress ABORT to abort the run."));
// }} ""
// {{ 834 1 0 "2f1527e3_d607_4030_af92ee06eee0e370" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_bln_AllowCostumerIntervention == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{{ 835 1 0 "59ee71da_019f_4a19_96d1c419e63b96f6" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
STRTOKENIZE::StrTokenize(l_strFunctionName, Translate("::"), l_arr_strTokens, ASWGLOBAL::BOOL::TRUE);
// }} ""
// {{{ 836 1 0 "26a4c0b9_3750_4adf_8fe581a5dc2e6361" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_int_ReturnValue = VectorCustomDialogs::MessageDialog(l_arr_strTokens.ElementAt( 3 -1), 3, 7, 0, 0, 0, l_str_Message);
// }} ""
// {{ 837 1 0 "80f02e24_3ebb_4770_ae185236ac3a2c72" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_ReturnValue == 4)
{
// }} ""
// {{{ 838 1 0 "6fc8c9c9_16b9_4be2_a8809a0caa011075" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_Display_InputWorklist_Dialog(i_str_WorklistFilePath);
// }} ""
// {{ 839 1 0 "80f02e24_3ebb_4770_ae185236ac3a2c72" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 840 1 0 "f53ce34b_66cf_4274_96cc66df2a530e79" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_ReturnValue == 5)
{
// }} ""
// {{ 841 1 0 "54214f15_a037_43fb_b0523d348e25cd55" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Excluded.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Excluded.RemoveFields();
// }} ""
// {{{ 842 1 0 "49b6d0e6_3b29_4419_9118e2f7c58dbefe" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLExtensions::File::Delete(t_str_ExcludedSamplesFilePath);
// }} ""
// {{ 843 1 0 "a9348613_bed8_4e13_b0cee6dc39fbc7dc" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 844 1 0 "f53ce34b_66cf_4274_96cc66df2a530e79" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 845 1 0 "50aed0e3_5ff4_4566_b18f1bf161c3d1da" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::DIALOG::ABORT);
// }} ""
// {{ 846 1 0 "f53ce34b_66cf_4274_96cc66df2a530e79" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 847 1 0 "80f02e24_3ebb_4770_ae185236ac3a2c72" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 848 1 0 "2f1527e3_d607_4030_af92ee06eee0e370" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 849 1 0 "cb0c864f_1c53_4a81_b914ae67cbe0eaba" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Excluded.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Excluded.RemoveFields();
// }} ""
// {{{ 850 1 0 "5c7b59ef_a02a_4bb8_b15be1d73242691d" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLExtensions::File::Delete(t_str_ExcludedSamplesFilePath);
// }} ""
// {{ 851 1 0 "d0b634e1_a31f_4d47_9236e2d2c61e2930" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 852 1 0 "2f1527e3_d607_4030_af92ee06eee0e370" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 853 1 0 "e40d927b_c2a4_4516_a654fa3129618378" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 854 1 0 "21ef2c08_2eef_4b9e_b2411f00ef011b72" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != t_hdlFile_Excluded.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
t_hdlFile_Excluded.RemoveFields();
// }} ""
// {{{ 855 1 0 "026436d1_9fe7_459b_b4465436f7880de3" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLExtensions::File::Delete(t_str_ExcludedSamplesFilePath);
// }} ""
// {{ 856 1 0 "ecd946ae_9f8f_4a76_a1eda26f8a3562e8" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 857 1 0 "e40d927b_c2a4_4516_a654fa3129618378" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 858 1 0 "cc2ddda7_affb_444c_9d6ec58a5d9741db" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 859 1 0 "bd58d285_2008_46a6_ade4cb874e29ad8a" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 860 1 0 "6ec3d8c9_0930_4fbd_9572e57e453b5f8d" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 861 1 0 "1da4d811_4670_4d62_b3cb536eded0b35e" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 862 1 0 "17f23fde_fe07_4aa1_b14d12621ad26152" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 863 1 0 "1193479d_4f79_4922_a35948f48e72621d" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
l_int_NumberOfElements=l_arr_flt_VolumeDiluent_PerPool.GetSize();
// }} ""
// {{ 864 1 0 "9a337869_1de2_44b8_a1c35b66b69342d8" "{B31F353A-5D80-11d4-A5EB-0050DA737D89}"
l_seq_Disp_Diluent.SetCurrentPosition(1);
// }} ""
// {{ 865 1 0 "07b12934_6559_439f_8d7f05e0810840b6" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(l_int_CurrentPool_IndexCounter = 0; l_int_CurrentPool_IndexCounter < l_int_NumberOfElements;)
{
l_int_CurrentPool_IndexCounter = l_int_CurrentPool_IndexCounter + 1;
// }} ""
// {{ 866 1 0 "1e2749dc_41f7_45f7_ac8ce506995250e7" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_arr_flt_VolumeDiluent_PerPool.ElementAt( l_int_CurrentPool_IndexCounter -1) != 0)
{
// }} ""
// {{ 867 1 0 "2f946520_0a83_44a1_b095417434813a84" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
o_arr_flt_Volumes_Diluent.AddAsLast(l_arr_flt_VolumeDiluent_PerPool.ElementAt( l_int_CurrentPool_IndexCounter -1));
// }} ""
// {{ 868 1 0 "87364c67_adb5_4538_88e8e7bc388628eb" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
o_flt_Diluent_TotalVolume = o_flt_Diluent_TotalVolume + l_arr_flt_VolumeDiluent_PerPool.ElementAt( l_int_CurrentPool_IndexCounter -1);
// }} ""
// {{ 869 1 0 "1e2749dc_41f7_45f7_ac8ce506995250e7" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 870 1 0 "07b12934_6559_439f_8d7f05e0810840b6" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 871 1 0 "28e1d924_46f5_4cab_b02a111e16db5a47" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqCopySequence(o_seq_Disp_Diluent, l_seq_Disp_Diluent);
// }} ""
// {{ 872 1 0 "1da4d811_4670_4d62_b3cb536eded0b35e" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 873 1 0 "01b476b2_3eeb_441e_83bde7c2cda455a4" "{DB5A2B39-67F2-4a78-A78F-DAF3FB056366}"
o_arr_flt_Volumes_Sample=l_arr_flt_Volumes_Sample;
// }} ""
// {{ 874 1 0 "2a5432f2_7a2d_45f1_b13773558b3dded9" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
o_int_NumberOfPools=o_arr_flt_Volumes_Pools.GetSize();
// }} ""
// {{ 875 1 0 "b5f6d89f_506d_4cb5_a1744e01ebb00655" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 876 1 0 "d93458d4_3f5f_4dd5_94e6c05a84198d09" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_RELEASE, Translate("t_str_OutputFilePath: "), t_str_OutputFilePath);
// }} ""
// {{ 877 1 0 "a6b58a3a_a730_4ac5_8420625d75939b10" "{B31F353A-5D80-11d4-A5EB-0050DA737D89}"
o_seq_Asp_Samples.SetCurrentPosition(1);
// }} ""
// {{ 878 1 0 "b69ffe54_760d_4788_8729f371b82e9062" "{B31F353A-5D80-11d4-A5EB-0050DA737D89}"
o_seq_Disp_Samples.SetCurrentPosition(1);
// }} ""
// {{ 879 1 0 "2e040efe_0bb7_4ccb_82beaf48f5b73c63" "{B31F353A-5D80-11d4-A5EB-0050DA737D89}"
o_seq_Disp_Diluent.SetCurrentPosition(1);
// }} ""
// {{{ 880 1 0 "c212c2e2_9fd2_485e_8c8303a5fd0a3d8c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceSequence(TRACE_LEVEL_RELEASE, o_seq_Asp_Samples);
// }} ""
// {{{ 881 1 0 "009b2306_67a2_42b1_b93cff191c0db44e" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceSequence(TRACE_LEVEL_RELEASE, o_seq_Disp_Samples);
// }} ""
// {{{ 882 1 0 "900f4c9e_6843_4a8a_b46ffc88927af673" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceArray(TRACE_LEVEL_RELEASE, Translate("o_arr_flt_Volumes_Sample: "), o_arr_flt_Volumes_Sample);
// }} ""
// {{{ 883 1 0 "c65b8412_d078_45f8_85221496c4d73bf0" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceSequence(TRACE_LEVEL_RELEASE, o_seq_Disp_Diluent);
// }} ""
// {{{ 884 1 0 "746cff1e_3f8a_4554_a26975c90a9c1cde" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceArray(TRACE_LEVEL_RELEASE, Translate("o_arr_flt_Volumes_Diluent: "), o_arr_flt_Volumes_Diluent);
// }} ""
// {{{ 885 1 0 "5b0a07c6_842c_4116_8d0f601f0be156d4" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_RELEASE, Translate("o_flt_Diluent_TotalVolume: "), o_flt_Diluent_TotalVolume);
// }} ""
// {{{ 886 1 0 "8ccfb90e_c406_4c7e_b8a2de445a3bd59d" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_RELEASE, Translate("o_int_NumberOfPools: "), o_int_NumberOfPools);
// }} ""
// {{{ 887 1 0 "df9ffcab_0903_4eb7_beca50e10e2b7bcc" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
Util2::Debug::TraceArray_2(Translate("o_arr_str_PostionIDsPools / o_arr_flt_Volumes_Pools: "), o_arr_str_PostionIDsPools, o_arr_flt_Volumes_Pools);
// }} ""
// {{ 888 1 0 "b5f6d89f_506d_4cb5_a1744e01ebb00655" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 889 1 0 "7b418787_d858_4e8b_ba1c19654013f20a" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
o_str_FilePath_OutputFile = t_str_OutputFilePath;
// }} ""
// {{ 890 1 0 "7540af15_38ce_49cf_b1da6b9f380324c8" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 891 1 0 "c67ac457_0db3_4f6a_83b6b284798024d9" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::COMPLETE, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{{ 892 1 0 "99caa653_35a3_4723_ba834401e1b1b24a" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::TRUE);
// }} ""
// {{ 893 1 0 "7540af15_38ce_49cf_b1da6b9f380324c8" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 5 "Pooling_ByMass" "End"
}
// }} ""
// {{{ 5 "_PoolingFileOpen" "Begin"
private function _PoolingFileOpen( variable i_str_FilePath, variable i_str_SQLSentence, variable i_int_Mode, variable i_int_PoolingMode, file & io_hdlFile ) void {
// }} ""
private variable l_strFunctionName;
// {{ 5 "_PoolingFileOpen" "InitLocals"
// }} ""
// {{ 1535 1 0 "023e25ad_7906_48de_bc7d1adde216adeb" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1536 1 0 "ae2634ad_34e1_48d8_8165fac3cdd40eda" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_strFunctionName = Translate("");
// }} ""
l_strFunctionName = GetFunctionName();
// {{{ 1538 1 0 "b39c3753_c681_4cac_b178d6ad31cca77a" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::START, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{ 1539 1 0 "023e25ad_7906_48de_bc7d1adde216adeb" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1540 1 0 "b400eef3_7a21_4c98_8f97bd5eae3b9289" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_int_Mode == 1)
{
// }} ""
// {{ 1541 1 0 "0824f78e_5d12_4a8e_bfe4ed69fb75bf3a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_int_PoolingMode == 1)
{
// }} ""
// {{ 1542 1 0 "b6164684_f5cd_412f_96cda88df8b6a8f6" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
io_hdlFile.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
io_hdlFile.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
io_hdlFile.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
io_hdlFile.AddField("Sample_Concentration", t_hdlFile_Worklist_Sample_Concentration, hslFloat);
io_hdlFile.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
io_hdlFile.AddField("Mass per sample", t_hdlFile_Worklist_Mass_per_sample, hslFloat);
io_hdlFile.AddField("Mass_PerPool", t_hdlFile_Worklist_MassPerPool, hslFloat);
io_hdlFile.AddField("Volume_PerPool", t_hdlFile_Worklist_VolumePerPool, hslFloat);
io_hdlFile.AddField("VolumeToAspirate", t_hdlFile_Worklist_VolumeToAspirate, hslFloat);
io_hdlFile.AddField("SampleStatus", t_hdlFile_Worklist_SampleStatus, hslString, 255);
if( 0 == io_hdlFile.Open(i_str_FilePath + " " + "Sheet1$", hslRead, i_str_SQLSentence) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_FilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 1543 1 0 "0824f78e_5d12_4a8e_bfe4ed69fb75bf3a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1544 1 0 "5070e851_f16e_461f_8c9200594d5f237e" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
io_hdlFile.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
io_hdlFile.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
io_hdlFile.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
io_hdlFile.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
io_hdlFile.AddField("Volume_ToAspirate", t_hdlFile_Worklist_VolumeToAspirate, hslFloat);
io_hdlFile.AddField("Volume_PerPool", t_hdlFile_Worklist_VolumePerPool, hslFloat);
io_hdlFile.AddField("SampleStatus", t_hdlFile_Worklist_SampleStatus, hslString, 255);
if( 0 == io_hdlFile.Open(i_str_FilePath + " " + "Sheet1$", hslRead, i_str_SQLSentence) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_FilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 1545 1 0 "0824f78e_5d12_4a8e_bfe4ed69fb75bf3a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1546 1 0 "b400eef3_7a21_4c98_8f97bd5eae3b9289" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1547 1 0 "aeb20e4e_b26a_43fd_aabcd0463fc5cb93" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_int_Mode == 2)
{
// }} ""
// {{ 1548 1 0 "28c4d18f_634c_45ab_bc78abadbeecf784" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_int_PoolingMode == 1)
{
// }} ""
// {{ 1549 1 0 "6ecb1c5e_efad_46f9_98edeab9b7acb9f5" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
io_hdlFile.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
io_hdlFile.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
io_hdlFile.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
io_hdlFile.AddField("Sample_Concentration", t_hdlFile_Worklist_Sample_Concentration, hslFloat);
io_hdlFile.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
io_hdlFile.AddField("Mass per sample", t_hdlFile_Worklist_Mass_per_sample, hslFloat);
io_hdlFile.AddField("Mass_PerPool", t_hdlFile_Worklist_MassPerPool, hslFloat);
io_hdlFile.AddField("Volume_PerPool", t_hdlFile_Worklist_VolumePerPool, hslFloat);
io_hdlFile.AddField("VolumeToAspirate", t_hdlFile_Worklist_VolumeToAspirate, hslFloat);
io_hdlFile.AddField("SampleStatus", t_hdlFile_Worklist_SampleStatus, hslString, 255);
if( 0 == io_hdlFile.Open(i_str_FilePath + " " + "Sheet1", hslWrite, i_str_SQLSentence) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_FilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 1550 1 0 "28c4d18f_634c_45ab_bc78abadbeecf784" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1551 1 0 "35d184e0_7e65_4759_96f027cf3bfdc7c5" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
io_hdlFile.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
io_hdlFile.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
io_hdlFile.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
io_hdlFile.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
io_hdlFile.AddField("Volume_ToAspirate", t_hdlFile_Worklist_VolumeToAspirate, hslFloat);
io_hdlFile.AddField("Volume_PerPool", t_hdlFile_Worklist_VolumePerPool, hslFloat);
io_hdlFile.AddField("SampleStatus", t_hdlFile_Worklist_SampleStatus, hslString, 255);
if( 0 == io_hdlFile.Open(i_str_FilePath + " " + "Sheet1", hslWrite, i_str_SQLSentence) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_FilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 1552 1 0 "28c4d18f_634c_45ab_bc78abadbeecf784" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1553 1 0 "aeb20e4e_b26a_43fd_aabcd0463fc5cb93" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1554 1 0 "a395a556_2c34_405b_81c896c762a916d1" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_int_Mode == 3)
{
// }} ""
// {{ 1555 1 0 "a28c5e5a_3339_4e3e_960ab4473f48a9d8" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (i_int_PoolingMode == 1)
{
// }} ""
// {{ 1556 1 0 "10063847_925c_4fa5_a8ffed75a458b4e4" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
io_hdlFile.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
io_hdlFile.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
io_hdlFile.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
io_hdlFile.AddField("Sample_Concentration", t_hdlFile_Worklist_Sample_Concentration, hslFloat);
io_hdlFile.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
io_hdlFile.AddField("Mass per sample", t_hdlFile_Worklist_Mass_per_sample, hslFloat);
io_hdlFile.AddField("Mass_PerPool", t_hdlFile_Worklist_MassPerPool, hslFloat);
io_hdlFile.AddField("Volume_PerPool", t_hdlFile_Worklist_VolumePerPool, hslFloat);
io_hdlFile.AddField("VolumeToAspirate", t_hdlFile_Worklist_VolumeToAspirate, hslFloat);
io_hdlFile.AddField("SampleStatus", t_hdlFile_Worklist_SampleStatus, hslString, 255);
if( 0 == io_hdlFile.Open(i_str_FilePath + " " + "Sheet1$", hslAppend, i_str_SQLSentence) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_FilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 1557 1 0 "a28c5e5a_3339_4e3e_960ab4473f48a9d8" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1558 1 0 "befef76f_005a_4310_bebe8ad5507fb543" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
io_hdlFile.AddField("Sample_ID", t_hdlFile_Worklist_Sample_ID, hslString, 255);
io_hdlFile.AddField("Sample_Position", t_hdlFile_Worklist_Sample_Position, hslString, 255);
io_hdlFile.AddField("Target_Well", t_hdlFile_Worklist_Target_Well, hslString, 255);
io_hdlFile.AddField("Original_SampleVolume", t_hdlFile_Worklist_OriginalSampleVolume, hslFloat);
io_hdlFile.AddField("Volume_ToAspirate", t_hdlFile_Worklist_VolumeToAspirate, hslFloat);
io_hdlFile.AddField("Volume_PerPool", t_hdlFile_Worklist_VolumePerPool, hslFloat);
io_hdlFile.AddField("SampleStatus", t_hdlFile_Worklist_SampleStatus, hslString, 255);
if( 0 == io_hdlFile.Open(i_str_FilePath + " " + "Sheet1$", hslAppend, i_str_SQLSentence) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_FilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 1559 1 0 "a28c5e5a_3339_4e3e_960ab4473f48a9d8" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1560 1 0 "a395a556_2c34_405b_81c896c762a916d1" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1561 1 0 "61263602_30bc_4035_8aa64cc021fe953f" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 1562 1 0 "3b85930b_8257_4f0f_8d51c98c6337a657" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::COMPLETE, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{ 1563 1 0 "61263602_30bc_4035_8aa64cc021fe953f" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 5 "_PoolingFileOpen" "End"
}
// }} ""
// {{{ 5 "_UpdateRecord" "Begin"
private function _UpdateRecord( variable i_str_FilePath, variable i_str_SheetName, variable i_str_ColumnName, variable i_keyNewValue, variable i_str_ColumnReference, variable i_keyValueReference ) void {
// }} ""
private variable l_str_Type_keyNewValue;
private variable l_bln_errorUpdating;
private variable l_str_Type_keyValueReference;
private variable loopCounter1;
private variable l_str_SQLSentence;
private timer l_timer_errorUpdating;
private file file_Update;
private variable l_strFunctionName;
// {{ 5 "_UpdateRecord" "InitLocals"
// }} ""
// {{ 1565 1 0 "b9183aef_a394_4c5d_8750857825bda049" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1566 1 0 "e7841679_7b2e_4273_af8848fdf73bfce6" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_strFunctionName = Translate("");
// }} ""
l_strFunctionName = GetFunctionName();
// {{{ 1568 1 0 "6bcd1e73_9248_4a36_b828320fc65df5a1" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::START, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{ 1569 1 0 "b9183aef_a394_4c5d_8750857825bda049" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1570 1 0 "668821b4_8a97_476f_a89f229209d353f4" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_errorUpdating = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{{ 1571 1 0 "dfe88d13_41f2_42fe_ab7c6d7ed1ca7893" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
i_str_SheetName = StrConcat2(i_str_SheetName, Translate("$"));
// }} ""
// {{ 1572 1 0 "1e97ebbe_9738_4f79_86099a44f68793e9" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter1 = 0;
while (l_bln_errorUpdating == ASWGLOBAL::BOOL::TRUE)
{
loopCounter1 = loopCounter1 + 1;
// }} ""
// {{ 1573 1 0 "afcc9cfd_5b7a_479c_88465b428b2d612c" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_906D982FF50B41fc8D46C111C71BFE94 ;
err.Clear();
// }} ""
// {{ 1574 1 0 "2d45712b_6482_4b6a_ac771c7608db0db9" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 1575 1 0 "6edf9980_6a53_4143_9057a4bb9e1f5556" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Type_keyNewValue = StrGetType(i_keyNewValue);
// }} ""
// {{{ 1576 1 0 "e7105d3d_9605_4666_8e83482703953f1d" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_Type_keyValueReference = StrGetType(i_keyValueReference);
// }} ""
// {{ 1577 1 0 "675bf69c_e98e_4f74_bf11757886d5e84c" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 1578 1 0 "06faa820_c1e6_4c88_b69b005ef06f2a0e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Type_keyNewValue == "s")
{
// }} ""
// {{ 1579 1 0 "dbb024db_9e06_4ee2_a0ef2dcd507cd84f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Type_keyValueReference == "s")
{
// }} ""
l_str_SQLSentence=StrConcat12("UPDATE [",i_str_SheetName,"] SET [",i_str_ColumnName,"] ='",i_keyNewValue,"' WHERE [",i_str_ColumnReference,"] = '",i_keyValueReference,"'","");
Trace(l_str_SQLSentence);

// {{ 1581 1 0 "dbb024db_9e06_4ee2_a0ef2dcd507cd84f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
l_str_SQLSentence=StrConcat12("UPDATE [",i_str_SheetName,"] SET [",i_str_ColumnName,"] ='",i_keyNewValue,"' WHERE [",i_str_ColumnReference,"] = ",i_keyValueReference,"","");
Trace(l_str_SQLSentence);

// {{ 1583 1 0 "dbb024db_9e06_4ee2_a0ef2dcd507cd84f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1584 1 0 "59bd8a9d_b1bf_410b_b2ec4a2c66c24717" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
file_Update.AddField(i_str_ColumnName, i_keyNewValue, hslString, 255);
if( 0 == file_Update.Open(i_str_FilePath + " " + i_str_SheetName, hslRead, l_str_SQLSentence) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_FilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 1585 1 0 "06faa820_c1e6_4c88_b69b005ef06f2a0e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1586 1 0 "2052d2d4_6d9d_4261_933523af5219f207" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Type_keyValueReference == "s")
{
// }} ""
l_str_SQLSentence=StrConcat12("UPDATE [",i_str_SheetName,"] SET [",i_str_ColumnName,"] =",i_keyNewValue," WHERE [",i_str_ColumnReference,"] = '",i_keyValueReference,"'","");
Trace(l_str_SQLSentence);

// {{ 1588 1 0 "2052d2d4_6d9d_4261_933523af5219f207" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
l_str_SQLSentence=StrConcat12("UPDATE [",i_str_SheetName,"] SET [",i_str_ColumnName,"] =",i_keyNewValue," WHERE [",i_str_ColumnReference,"] = ",i_keyValueReference,"","");
Trace(l_str_SQLSentence);

// {{ 1590 1 0 "2052d2d4_6d9d_4261_933523af5219f207" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1591 1 0 "6710ea41_967c_44d9_813f9a1c36c6b8c0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_str_Type_keyNewValue == "f")
{
// }} ""
// {{ 1592 1 0 "9b9fba22_db3e_4cf5_88e66cf746c90cac" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
file_Update.AddField(i_str_ColumnName, i_keyNewValue, hslFloat);
if( 0 == file_Update.Open(i_str_FilePath + " " + i_str_SheetName, hslRead, l_str_SQLSentence) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_FilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 1593 1 0 "6710ea41_967c_44d9_813f9a1c36c6b8c0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1594 1 0 "03d50b50_5be2_4c5c_a412351d53537bc8" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
file_Update.AddField(i_str_ColumnName, i_keyNewValue, hslInteger);
if( 0 == file_Update.Open(i_str_FilePath + " " + i_str_SheetName, hslRead, l_str_SQLSentence) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, i_str_FilePath, "HxMetEdCompCmd");
}
// }} ""
// {{ 1595 1 0 "6710ea41_967c_44d9_813f9a1c36c6b8c0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1596 1 0 "06faa820_c1e6_4c88_b69b005ef06f2a0e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1597 1 0 "f249e853_6358_4216_8a1d02b0a90f85d3" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != file_Update.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
file_Update.RemoveFields();
// }} ""
// {{ 1598 1 0 "2d45712b_6482_4b6a_ac771c7608db0db9" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1599 1 0 "aeb41d29_3a6e_4506_9c30373147ff3322" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_errorUpdating = ASWGLOBAL::BOOL::FALSE;
// }} ""
// {{ 1600 1 0 "afcc9cfd_5b7a_479c_88465b428b2d612c" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_906D982FF50B41fc8D46C111C71BFE94 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 1601 1 0 "41624988_e084_4f17_8c2cecf6788671a7" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_errorUpdating = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 1602 1 0 "c108a43e_ffd2_472b_a84a3cbd89327843" "{B31F353E-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == l_timer_errorUpdating.SetTimer(2) )
{
    MECC::RaiseRuntimeErrorEx(-1355939584, MECC::IDS::stepNameTimerStart, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 1603 1 0 "9a66addc_ccc4_4df1_963a35289a2ffb8b" "{B31F353F-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == l_timer_errorUpdating.WaitTimer(hslFalse, hslFalse) )
{
    MECC::RaiseRuntimeErrorEx(-1339162368, MECC::IDS::stepNameTimerWait, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 1604 1 0 "afcc9cfd_5b7a_479c_88465b428b2d612c" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 1605 1 0 "4ca4cfca_fc36_4325_8bd9b6985387e47b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (loopCounter1 == 2)
{
// }} ""
// {{ 1606 1 0 "24f1713d_c900_41c3_854283841cb5fefd" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_errorUpdating == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{ 1607 1 0 "75adf86c_95fc_4c8e_870e52dfb18814be" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("Cannot update file"));
// }} ""
// {{ 1608 1 0 "24f1713d_c900_41c3_854283841cb5fefd" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1609 1 0 "4ca4cfca_fc36_4325_8bd9b6985387e47b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1610 1 0 "1e97ebbe_9738_4f79_86099a44f68793e9" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 1611 1 0 "dc3f8f4f_1033_472f_b25be8dea2604655" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 1612 1 0 "7112db2e_876c_4645_bc7326497c732916" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::COMPLETE, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{ 1613 1 0 "dc3f8f4f_1033_472f_b25be8dea2604655" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 5 "_UpdateRecord" "End"
}
// }} ""
// {{{ 5 "FilterSequenceAndArrayForTipType" "Begin"
function FilterSequenceAndArrayForTipType( sequence i_seq_Tips, sequence i_seq_Source, sequence i_seq_Target, variable & i_arr_flt_Volumes[], sequence & o_seq_Aspirate, sequence & o_seq_Dispense, variable & o_arr_flt_Volumes[], device & ML_STAR ) void {
// }} ""
private variable l_str_PosId_SeqAspirate;
private variable l_str_LabId_SeqDispense;
private variable l_bln_AddDataToOutputParameters;
private variable l_int_NumberOfVolumes;
private variable l_str_PosId_SeqDispense;
private variable l_int_TipVolume_Minimum;
private variable loopCounter1;
private variable l_int_TipVolume_Maximum;
private variable l_str_LabId_SeqAspirate;
private variable l_flt_CurrentVolume;
private variable l_int_NumberOfPositionsInSequence_Total;
private variable l_int_TipType;
private variable l_str_LabwareID;
private variable l_str_TipType;
private variable l_strFunctionName;
// {{ 5 "FilterSequenceAndArrayForTipType" "InitLocals"
{ sequence __temp; o_seq_Aspirate = __temp; }
{ sequence __temp; o_seq_Dispense = __temp; }
o_arr_flt_Volumes.SetSize( 0);
// }} ""
// {{ 1 1 0 "b65dc6eb_d9ac_4841_b624d23b4962b17a" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 2 1 0 "9e0cfeb9_f867_43f2_81c4022b4b1a967b" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_strFunctionName = Translate("");
// }} ""
l_strFunctionName = GetFunctionName();
// {{{ 4 1 0 "5ef128d0_eab5_47cd_a88edef683e577c1" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::START, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{ 5 1 0 "b65dc6eb_d9ac_4841_b624d23b4962b17a" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 6 1 0 "81c00252_8d94_4ab9_8b97615ff37eb6c0" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 7 1 0 "3ebd3abf_2996_4bc8_a5a5b67c8a9a9133" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_DEBUG, Translate("******** Tracing INPUT parameters ********"), Translate(""));
// }} ""
// {{{ 8 1 0 "f2f65706_a00a_4cff_8b40e4273efff8ff" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceSequence(TRACE_LEVEL_DEBUG, i_seq_Source);
// }} ""
// {{{ 9 1 0 "3e45cd60_7c36_4876_84b0e6136966682e" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceSequence(TRACE_LEVEL_DEBUG, i_seq_Target);
// }} ""
// {{{ 10 1 0 "f82cdf6f_3a53_48cd_8eea59a9e214922d" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceArray(TRACE_LEVEL_DEBUG, Translate("i_arr_flt_Volumes: "), i_arr_flt_Volumes);
// }} ""
// {{ 11 1 0 "81c00252_8d94_4ab9_8b97615ff37eb6c0" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 12 1 0 "8d9b07c2_76b4_4876_855a2d119926a726" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_LabwareID = SeqGetLabwareId(i_seq_Tips);
// }} ""
// {{ 13 1 0 "67c43ba5_939a_4b83_94a12f920978780c" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_str_TipType = Translate("");
// }} ""
// {{{ 14 1 0 "94b9acfa_4acc_446d_a3be17d18a6557cb" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLLabwrAccess::ValueForKeyGetForPropertiesOfLabwareID(ML_STAR, l_str_TipType, Translate("MlStarTipRack"), l_str_LabwareID);
// }} ""
// {{{ 15 1 0 "f427e86c_6063_4bb8_835dc914ce346656" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_int_TipType = StrIVal(l_str_TipType);
// }} ""
// {{{ 16 1 0 "9da5db3e_0211_4db1_9945af073be0b4bd" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_DEBUG, Translate("l_int_TipType: "), l_int_TipType);
// }} ""
// {{ 17 1 0 "7e96edab_6f7e_49f4_9dbbe77a62106112" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 18 1 0 "08b3dd9a_ddb4_48c4_8f7218aa5a0fcaa9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_TipType == 23)
{
// }} ""
// {{ 19 1 0 "036d886b_d5c4_4b94_af9b8180bfd6aa25" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_int_TipVolume_Maximum = 50;
// }} ""
// {{ 20 1 0 "a6869be6_9efe_426d_8f88a60cab6d6ce8" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_int_TipVolume_Minimum = 1;
// }} ""
// {{ 21 1 0 "08b3dd9a_ddb4_48c4_8f7218aa5a0fcaa9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 22 1 0 "a24a9491_cad7_4628_beae42ae954b2a5b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_TipType == 1)
{
// }} ""
// {{ 23 1 0 "716bae37_33c8_4bc6_ba073f3b2405ab3e" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_int_TipVolume_Maximum = 300;
// }} ""
// {{ 24 1 0 "d81efb09_8ce2_46cd_8c7b44f1cc573a09" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_int_TipVolume_Minimum = 50;
// }} ""
// {{ 25 1 0 "a24a9491_cad7_4628_beae42ae954b2a5b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 26 1 0 "5a4f02a9_54f6_45cb_92ab91240c0caa7d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_TipType == 5)
{
// }} ""
// {{ 27 1 0 "61b133dc_3e7f_40dc_910b993891719527" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_int_TipVolume_Maximum = 1000;
// }} ""
// {{ 28 1 0 "cba074a7_59a6_4235_be2ac803fb7aaf6c" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_int_TipVolume_Minimum = 300;
// }} ""
// {{ 29 1 0 "5a4f02a9_54f6_45cb_92ab91240c0caa7d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 30 1 0 "7e96edab_6f7e_49f4_9dbbe77a62106112" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 31 1 0 "de8296e8_fd8d_44b0_bc0cf1ec6ae2d2fe" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 32 1 0 "9f16ef65_6163_4833_aed81c2d62fd66f9" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
o_arr_flt_Volumes.SetSize(0);
// }} ""
// {{{ 33 1 0 "f2683e42_5af9_4986_914fe9be17f08295" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_int_NumberOfPositionsInSequence_Total = SeqGetTotal(i_seq_Source);
// }} ""
// {{{ 34 1 0 "7483a602_de3d_402b_85ac369b4f761c16" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqRemoveAll(o_seq_Aspirate);
// }} ""
// {{{ 35 1 0 "ee2392fa_c634_498d_a86de72b32ad59e8" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqRemoveAll(o_seq_Dispense);
// }} ""
// {{ 36 1 0 "9fba7fc6_be07_40b5_9c70e674cdb8a6ba" "{B31F353A-5D80-11d4-A5EB-0050DA737D89}"
i_seq_Source.SetCurrentPosition(1);
// }} ""
// {{ 37 1 0 "7f465c49_4a7c_41d6_8a2cb9ae60bc577f" "{B31F353A-5D80-11d4-A5EB-0050DA737D89}"
i_seq_Target.SetCurrentPosition(1);
// }} ""
// {{ 38 1 0 "de8296e8_fd8d_44b0_bc0cf1ec6ae2d2fe" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 39 1 0 "3743149f_075d_45af_9e827f4987d828bc" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
l_int_NumberOfVolumes=i_arr_flt_Volumes.GetSize();
// }} ""
// {{ 40 1 0 "3a188292_b165_4597_b28feae16b471f80" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(loopCounter1 = 0; loopCounter1 < l_int_NumberOfVolumes;)
{
loopCounter1 = loopCounter1 + 1;
// }} ""
// {{ 41 1 0 "e6413732_0f5d_46f5_b5edf7b0aaef59b1" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_AddDataToOutputParameters = ASWGLOBAL::BOOL::FALSE;
// }} ""
// {{ 42 1 0 "9fbe5913_0159_4c28_aafcf0fc3e213e43" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
l_flt_CurrentVolume=i_arr_flt_Volumes.GetAt(loopCounter1-1);
// }} ""
// {{ 43 1 0 "d9e0c9d3_8cbd_4398_b42b5953a9f6d995" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_CurrentVolume <= l_int_TipVolume_Maximum)
{
// }} ""
// {{ 44 1 0 "358aebdc_e4ac_4bc1_a31b308799532a59" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_TipType != 23)
{
// }} ""
// {{ 45 1 0 "bbef5f49_47e8_4f43_a6829a405515daf5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_CurrentVolume > l_int_TipVolume_Minimum)
{
// }} ""
// {{ 46 1 0 "668e38e8_75b7_4406_9a94fff63f55dce3" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_AddDataToOutputParameters = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 47 1 0 "bbef5f49_47e8_4f43_a6829a405515daf5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 48 1 0 "358aebdc_e4ac_4bc1_a31b308799532a59" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 49 1 0 "7677d3fc_45a7_41b2_a1f2488ba76052ec" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_flt_CurrentVolume >= l_int_TipVolume_Minimum)
{
// }} ""
// {{ 50 1 0 "13f73597_a4b6_4b8b_8b0e325871ef6a49" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_bln_AddDataToOutputParameters = ASWGLOBAL::BOOL::TRUE;
// }} ""
// {{ 51 1 0 "7677d3fc_45a7_41b2_a1f2488ba76052ec" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 52 1 0 "358aebdc_e4ac_4bc1_a31b308799532a59" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 53 1 0 "d9e0c9d3_8cbd_4398_b42b5953a9f6d995" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 54 1 0 "7646ca50_15c6_47ec_8c7287214869f96d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_bln_AddDataToOutputParameters == ASWGLOBAL::BOOL::TRUE)
{
// }} ""
// {{ 55 1 0 "41b812fa_54dc_43c0_bf2a5a4d8fad39f1" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
o_arr_flt_Volumes.AddAsLast(i_arr_flt_Volumes.ElementAt( loopCounter1 -1));
// }} ""
// {{ 56 1 0 "eb778c9d_880d_425e_a4b1d0d0b78cc176" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfPositionsInSequence_Total > 0)
{
// }} ""
// {{{ 57 1 0 "9f584181_4a78_4529_97a7cf8d0ddfe0ac" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_LabId_SeqAspirate = SeqGetLabwareId(i_seq_Source);
// }} ""
// {{{ 58 1 0 "db21c93c_3e02_4071_9cfbf08e792e819d" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_PosId_SeqAspirate = SeqGetPositionId(i_seq_Source);
// }} ""
// {{{ 59 1 0 "41191d97_6de4_40c9_af5f97b76c213120" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqAdd(o_seq_Aspirate, l_str_LabId_SeqAspirate, l_str_PosId_SeqAspirate);
// }} ""
// {{ 60 1 0 "eb778c9d_880d_425e_a4b1d0d0b78cc176" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 61 1 0 "90da2db0_f230_4085_a2ffeb1bc16ad01b" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_LabId_SeqDispense = SeqGetLabwareId(i_seq_Target);
// }} ""
// {{{ 62 1 0 "5a858823_9138_4cd3_a1a276c7aec492a0" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_str_PosId_SeqDispense = SeqGetPositionId(i_seq_Target);
// }} ""
// {{{ 63 1 0 "1be232cc_ff57_412d_bb273f02daa00eb1" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqAdd(o_seq_Dispense, l_str_LabId_SeqDispense, l_str_PosId_SeqDispense);
// }} ""
// {{ 64 1 0 "7646ca50_15c6_47ec_8c7287214869f96d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 65 1 0 "849a66ba_9b21_4f4e_a9eafe0f5d049bad" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (l_int_NumberOfPositionsInSequence_Total > 0)
{
// }} ""
// {{{ 66 1 0 "b96048ef_bdac_42fa_878fac65ca8fc1eb" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqIncrement(i_seq_Source, 1);
// }} ""
// {{ 67 1 0 "849a66ba_9b21_4f4e_a9eafe0f5d049bad" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 68 1 0 "96cc6d58_5536_4140_87b21f05426feb83" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SeqIncrement(i_seq_Target, 1);
// }} ""
// {{ 69 1 0 "3a188292_b165_4597_b28feae16b471f80" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 70 1 0 "fbcf7175_9bcf_4692_bdedc6af43ceb37e" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 71 1 0 "9fe4b225_421c_4002_8d7e65f8dfb7dc22" "{B31F353A-5D80-11d4-A5EB-0050DA737D89}"
o_seq_Aspirate.SetCurrentPosition(1);
// }} ""
// {{ 72 1 0 "8d2af634_3d74_41e1_bd3f444c7198eb92" "{B31F353A-5D80-11d4-A5EB-0050DA737D89}"
o_seq_Dispense.SetCurrentPosition(1);
// }} ""
// {{{ 73 1 0 "aefded9d_e16d_4260_8d95a8b8c5ec3a36" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_RELEASE, Translate("******** Tracing OUTPUT parameters ********"), Translate(""));
// }} ""
// {{{ 74 1 0 "9ef932ca_83a5_416b_96c7c894fef3b440" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceSequence(TRACE_LEVEL_RELEASE, o_seq_Aspirate);
// }} ""
// {{{ 75 1 0 "c4a6a151_84dc_490f_9cf7bf107a5510d6" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceSequence(TRACE_LEVEL_RELEASE, o_seq_Dispense);
// }} ""
// {{{ 76 1 0 "d18c1421_98fb_49df_a8522d4bc9f867ad" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceArray(TRACE_LEVEL_RELEASE, Translate("o_arr_flt_Volumes: "), o_arr_flt_Volumes);
// }} ""
// {{ 77 1 0 "fbcf7175_9bcf_4692_bdedc6af43ceb37e" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 78 1 0 "b9a0fec8_4326_40cd_94476a3080de52ce" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 79 1 0 "b334dcd7_3afe_4762_a9247c25593b1626" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::COMPLETE, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{ 80 1 0 "b9a0fec8_4326_40cd_94476a3080de52ce" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 5 "FilterSequenceAndArrayForTipType" "End"
}
// }} ""
// {{{ 5 "Init" "Begin"
function Init( device & ML_STAR, variable i_strKitTitle, variable i_blnActivateIntegratedAbortHandler, variable & o_strControllerNameAndVersion ) variable {
// }} ""
private variable l_intReturnValue;
private variable l_strFunctionName;
// {{ 5 "Init" "InitLocals"
o_strControllerNameAndVersion = 0;
// }} ""
// {{{ 82 1 0 "4c74d4e8_1067_4f9d_a26d96a6005c325c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
t_intTraceLevel = TRACELEVEL::GetTraceLevel();
// }} ""
// {{ 83 1 0 "865baac7_dec2_46e3_a2c56e8734997aab" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 84 1 0 "4edd4bb8_8f7b_4cbb_97608eafd6b274be" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_strControllerVersion = Translate("3.0.0");
// }} ""
// {{ 85 1 0 "923ab3ed_5286_4b4e_94ca246e30bb0236" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_strFunctionName = Translate("");
// }} ""
// {{ 86 1 0 "d75795ce_d8ca_4e9e_85a1a90f147ea687" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_strLibraryName = Translate("");
// }} ""
l_strFunctionName = GetFunctionName();
t_strLibraryName = GetFileName();
// {{{ 88 1 0 "fd54624e_7add_439a_82025650a2572667" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::START, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{{ 89 1 0 "edc8a67b_27dc_4a4f_98bf60760e19338b" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
t_strLibraryNameWithoutExtension = HSLExtensions::File::GetFileNameWithoutExtension(t_strLibraryName);
// }} ""
// {{{ 90 1 0 "b65fe47f_c888_47a6_b5ad904fc730e4e3" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
o_strControllerNameAndVersion = StrConcat4(t_strLibraryNameWithoutExtension, Translate(" "), t_strControllerVersion, Translate(""));
// }} ""
// {{ 91 1 0 "865baac7_dec2_46e3_a2c56e8734997aab" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 92 1 0 "5c3a23fa_4c5a_4681_b697a2536b8a8109" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_blnActivateIntegratedAbortHandler = i_blnActivateIntegratedAbortHandler;
// }} ""
// {{ 93 1 0 "8ba4192f_00c1_46b2_a8c4cba4f59c29d6" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_64F0513B9AD24bdcB2D55970AC77B7B6 ;
err.Clear();
// }} ""
// {{ 94 1 0 "be953e49_9bdd_4a36_b72f7baf5ccc1bea" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 95 1 0 "8d4916fe_b9e1_4f17_af66dd5b7f27f771" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_intReturnValue = VectorCustomDialogs::Initialize();
// }} ""
// {{{ 96 1 0 "0daa9dfb_89f2_44a9_a6095b68194820ae" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_CheckBindReturnValueVectorCustomDialogs(l_intReturnValue);
// }} ""
// {{{ 97 1 0 "24826a09_9d5b_46ad_8c2dffdb3087d405" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_DEBUG, Translate("Return value of init vector custom dialogs : "), l_intReturnValue);
// }} ""
// {{ 98 1 0 "8ba4192f_00c1_46b2_a8c4cba4f59c29d6" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_64F0513B9AD24bdcB2D55970AC77B7B6 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{{ 99 1 0 "1c019a40_fd3e_461c_9547bdbc4e0fe571" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_DATA_IntegratedAbortHandler(l_strFunctionName, Translate("Vector Custom Dialogs could not be initialized. Method will abort"));
// }} ""
// {{{ 100 1 0 "d3460ee2_da22_4382_b3ab1d6b0d81dc06" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::FALSE);
// }} ""
// {{ 101 1 0 "8ba4192f_00c1_46b2_a8c4cba4f59c29d6" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 102 1 0 "83d8772c_7c8c_4e81_a3700665ed40ab8c" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_strKitTitle = i_strKitTitle;
// }} ""
// {{{ 103 1 0 "2d8a1286_746d_4fa6_adcac0140d1abc3f" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
t_str_Date = TimGetFormattedDate(Translate("%Y%m%d"));
// }} ""
// {{{ 104 1 0 "741f6cf4_55a7_4fc3_884d42aff5406794" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
t_str_Time = TimGetFormattedTime(Translate("%H%M%S"));
// }} ""
// {{ 105 1 0 "38daf826_77a5_4c45_bbd8fe86053a507d" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
t_strLogFilesDirectory = Translate("C:\\Program Files (x86)\\HAMILTON\\LogFiles");
// }} ""
// {{ 106 1 0 "e00d0b3c_224d_4463_b4418fae5e1e4ca3" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 107 1 0 "e6e255b2_9bb0_419f_891da15b57898f71" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::COMPLETE, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{{ 108 1 0 "ab9aba6e_a49b_4010_82a6092e40142779" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ASWGLOBAL::BOOL::TRUE);
// }} ""
// {{ 109 1 0 "e00d0b3c_224d_4463_b4418fae5e1e4ca3" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 5 "Init" "End"
}
// }} ""
// {{{ 5 "_DATA_IntegratedAbortHandler" "Begin"
private function _DATA_IntegratedAbortHandler( variable i_strFunctionName, variable i_strAbortMessage ) void {
// }} ""
private variable l_intReturnValue;
private variable l_intReturnValueDialog;
private variable l_strAbortMessage;
private variable t_strLibraryName;
private variable l_strFunctionName;
private variable l_arrAbortHandlerMessage[];
// {{ 5 "_DATA_IntegratedAbortHandler" "InitLocals"
// }} ""
// {{ 1354 1 0 "ee1d485f_c05a_4af4_978aabe3d156ceb4" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (t_blnActivateIntegratedAbortHandler == ASWGLOBAL::BOOL::FALSE)
{
// }} ""
// {{{ 1355 1 0 "e0cbf11e_5ac4_4747_8ab28e366ad2d585" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return;
// }} ""
// {{ 1356 1 0 "ee1d485f_c05a_4af4_978aabe3d156ceb4" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1357 1 0 "c7f21b61_cb20_47e2_a3a4bf44acb8de29" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1358 1 0 "3df8903b_e774_4952_a5ddb3bc00d14358" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
l_strFunctionName = Translate("");
// }} ""
l_strFunctionName = GetFunctionName();
// {{{ 1360 1 0 "08c75306_cc63_4234_b252cfa4f7eb44e2" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::START, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{ 1361 1 0 "c7f21b61_cb20_47e2_a3a4bf44acb8de29" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1362 1 0 "fe94ac08_504c_46ec_8e32fd0d7b2b6d2d" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_9F21AB0C9CE24546A242FAF74624127E ;
err.Clear();
// }} ""
// {{ 1363 1 0 "c8933157_6956_4c0e_8006a6a9e76d8006" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 1364 1 0 "b5050dec_f7d1_4a92_8a592dc82ad7709c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_intReturnValue = VectorCustomDialogs::Initialize();
// }} ""
// {{{ 1365 1 0 "dd43ad1a_d53c_4a7e_8c841ea96035f741" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_CheckBindReturnValueVectorCustomDialogs(l_intReturnValue);
// }} ""
// {{{ 1366 1 0 "e2006bd7_12e2_4c45_864220c5a9ffbd7d" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::Trace_02(TRACE_LEVEL_DEBUG, Translate("Return value of init vector custom dialogs : "), l_intReturnValue);
// }} ""
// {{ 1367 1 0 "fe94ac08_504c_46ec_8e32fd0d7b2b6d2d" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_9F21AB0C9CE24546A242FAF74624127E : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 1368 1 0 "fe94ac08_504c_46ec_8e32fd0d7b2b6d2d" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{{ 1369 1 0 "27473c62_274b_4533_a63bffa9e29b9ebf" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_strFunctionName = StrConcat2(Translate("Affected library : "), i_strFunctionName);
// }} ""
// {{{ 1370 1 0 "a4a54fbc_bd46_4447_8389ccc5468b148e" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_strAbortMessage = StrConcat2(Translate("Abort message : "), i_strAbortMessage);
// }} ""
// {{{ 1371 1 0 "d166c337_ed5a_4d7c_8d6ed28b356f442d" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_strFunctionName = StrConcat2(Translate("Affected library : "), i_strFunctionName);
// }} ""
// {{ 1372 1 0 "95ab9c00_23e0_4ffc_984f82b83b6b7cd2" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
l_arrAbortHandlerMessage.SetSize(0);
// }} ""
// {{ 1373 1 0 "cd446d18_b949_4c7c_a8d83526149842de" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arrAbortHandlerMessage.AddAsLast(l_strFunctionName);
// }} ""
// {{ 1374 1 0 "3cfa7863_d759_47d0_adf63c6e852d0ec4" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
l_arrAbortHandlerMessage.AddAsLast(l_strAbortMessage);
// }} ""
// {{{ 1375 1 0 "be96f04b_925d_4c6d_ad3947be294fb0f9" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
l_intReturnValueDialog = VectorCustomDialogs::ListDialog(Translate(""), VectorCustomDialogs::IconType::Information, VectorCustomDialogs::ButtonType::Ok, 0, 0, 0, Translate("Internal abort handler message :  "), Translate("Error occurred - abort routine started - Press OK to abort the run."), l_arrAbortHandlerMessage);
// }} ""
// {{{ 1376 1 0 "8eb504c9_458b_4327_838413f90bb191df" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
_CheckBindReturnValueVectorCustomDialogs(l_intReturnValue);
// }} ""
// {{ 1377 1 0 "00b9fa16_4367_491d_ac208e150296f494" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 1378 1 0 "231d98c3_2f91_4b87_867528ee2f556bc0" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::SetActionIndicator(TRACELEVEL::ACTION::COMPLETE_WITH_ERROR, Translate(" <- "));
// }} ""
// {{{ 1379 1 0 "b6c402f2_a396_40d9_8e48ea52ec888b52" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::COMPLETE_WITH_ERROR, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{ 1380 1 0 "00b9fa16_4367_491d_ac208e150296f494" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 1381 1 0 "9eb60ec1_6d04_4caa_a0ee0d5a8ed8bd54" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 1382 1 0 "1f8dae57_7fbd_425c_9676ea442d36fe29" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 1383 1 0 "663a0c79_0fd8_42bb_bb5e9dc8cb97450c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TRACELEVEL::TraceAction(TRACE_LEVEL_RELEASE, TRACELEVEL::ACTION::COMPLETE_WITH_ERROR, l_strFunctionName, t_strLibraryName, Translate(""));
// }} ""
// {{ 1384 1 0 "1f8dae57_7fbd_425c_9676ea442d36fe29" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 5 "_DATA_IntegratedAbortHandler" "End"
}
// }} ""
/* {{ 2 "SubmethodInsertLine" "" */ // }} ""
// {{{ 2 "LibraryNamespace" "End"
} // library namespace
// }} ""
// $$author=orr_b$$valid=0$$time=2024-10-04 07:18$$checksum=d343e640$$length=082$$